[{"path":"src/main/java/teammates/common/datatransfer/questions/FeedbackConstantSumQuestionDetails.java","fileType":"java","lines":[{"lineNumber":1,"author":{"gitId":"-"},"content":"package teammates.common.datatransfer.questions;"},{"lineNumber":2,"author":{"gitId":"-"},"content":""},{"lineNumber":3,"author":{"gitId":"-"},"content":"import java.util.ArrayList;"},{"lineNumber":4,"author":{"gitId":"-"},"content":"import java.util.HashSet;"},{"lineNumber":5,"author":{"gitId":"-"},"content":"import java.util.List;"},{"lineNumber":6,"author":{"gitId":"-"},"content":"import java.util.Set;"},{"lineNumber":7,"author":{"gitId":"-"},"content":""},{"lineNumber":8,"author":{"gitId":"-"},"content":"import teammates.common.datatransfer.attributes.FeedbackQuestionAttributes;"},{"lineNumber":9,"author":{"gitId":"-"},"content":"import teammates.common.util.FieldValidator;"},{"lineNumber":10,"author":{"gitId":"-"},"content":""},{"lineNumber":11,"author":{"gitId":"-"},"content":"/**"},{"lineNumber":12,"author":{"gitId":"-"},"content":" * Contains specific structure and processing logic for constant sum feedback questions."},{"lineNumber":13,"author":{"gitId":"-"},"content":" */"},{"lineNumber":14,"author":{"gitId":"-"},"content":"public class FeedbackConstantSumQuestionDetails extends FeedbackQuestionDetails {"},{"lineNumber":15,"author":{"gitId":"-"},"content":""},{"lineNumber":16,"author":{"gitId":"-"},"content":"    static final String QUESTION_TYPE_NAME_OPTION \u003d \"Distribute points (among options) question\";"},{"lineNumber":17,"author":{"gitId":"-"},"content":"    static final String QUESTION_TYPE_NAME_RECIPIENT \u003d \"Distribute points (among recipients) question\";"},{"lineNumber":18,"author":{"gitId":"-"},"content":"    static final int CONST_SUM_MIN_NUM_OF_OPTIONS \u003d 2;"},{"lineNumber":19,"author":{"gitId":"-"},"content":"    static final int CONST_SUM_MIN_NUM_OF_POINTS \u003d 1;"},{"lineNumber":20,"author":{"gitId":"-"},"content":"    static final String CONST_SUM_ERROR_NOT_ENOUGH_OPTIONS \u003d"},{"lineNumber":21,"author":{"gitId":"-"},"content":"            \"Too little options for \" + QUESTION_TYPE_NAME_OPTION + \". Minimum number of options is: \";"},{"lineNumber":22,"author":{"gitId":"-"},"content":"    static final String CONST_SUM_ERROR_DUPLICATE_OPTIONS \u003d \"Duplicate options are not allowed.\";"},{"lineNumber":23,"author":{"gitId":"-"},"content":"    static final String CONST_SUM_ERROR_NOT_ENOUGH_POINTS \u003d"},{"lineNumber":24,"author":{"gitId":"-"},"content":"            \"Too little points for \" + QUESTION_TYPE_NAME_RECIPIENT + \". Minimum number of points is: \";"},{"lineNumber":25,"author":{"gitId":"-"},"content":"    static final String CONST_SUM_ERROR_MISMATCH \u003d"},{"lineNumber":26,"author":{"gitId":"-"},"content":"            \"Please distribute all the points for distribution questions. \""},{"lineNumber":27,"author":{"gitId":"-"},"content":"                    + \"To skip a distribution question, leave the boxes blank.\";"},{"lineNumber":28,"author":{"gitId":"zhaojj2209"},"content":"    static final String CONST_SUM_ERROR_NEGATIVE \u003d \"Points cannot be negative.\";"},{"lineNumber":29,"author":{"gitId":"-"},"content":"    static final String CONST_SUM_ERROR_UNIQUE \u003d \"Every option must be given a different number of points.\";"},{"lineNumber":30,"author":{"gitId":"-"},"content":"    static final String CONST_SUM_ERROR_SOME_UNIQUE \u003d"},{"lineNumber":31,"author":{"gitId":"-"},"content":"            \"At least some options must be given a different number of points.\";"},{"lineNumber":32,"author":{"gitId":"-"},"content":"    static final String CONST_SUM_ANSWER_OPTIONS_NOT_MATCH \u003d \"The answers are inconsistent with the options\";"},{"lineNumber":33,"author":{"gitId":"-"},"content":"    static final String CONST_SUM_ANSWER_RECIPIENT_NOT_MATCH \u003d \"The answer is inconsistent with the recipient\";"},{"lineNumber":34,"author":{"gitId":"-"},"content":""},{"lineNumber":35,"author":{"gitId":"-"},"content":"    private List\u003cString\u003e constSumOptions;"},{"lineNumber":36,"author":{"gitId":"-"},"content":"    private boolean distributeToRecipients;"},{"lineNumber":37,"author":{"gitId":"-"},"content":"    private boolean pointsPerOption;"},{"lineNumber":38,"author":{"gitId":"-"},"content":"    private boolean forceUnevenDistribution;"},{"lineNumber":39,"author":{"gitId":"-"},"content":"    private String distributePointsFor;"},{"lineNumber":40,"author":{"gitId":"-"},"content":"    private int points;"},{"lineNumber":41,"author":{"gitId":"-"},"content":""},{"lineNumber":42,"author":{"gitId":"-"},"content":"    public FeedbackConstantSumQuestionDetails() {"},{"lineNumber":43,"author":{"gitId":"-"},"content":"        this(null);"},{"lineNumber":44,"author":{"gitId":"-"},"content":"    }"},{"lineNumber":45,"author":{"gitId":"-"},"content":""},{"lineNumber":46,"author":{"gitId":"-"},"content":"    public FeedbackConstantSumQuestionDetails(String questionText) {"},{"lineNumber":47,"author":{"gitId":"-"},"content":"        super(FeedbackQuestionType.CONSTSUM, questionText);"},{"lineNumber":48,"author":{"gitId":"-"},"content":"        this.constSumOptions \u003d new ArrayList\u003c\u003e();"},{"lineNumber":49,"author":{"gitId":"-"},"content":"        this.distributeToRecipients \u003d false;"},{"lineNumber":50,"author":{"gitId":"-"},"content":"        this.pointsPerOption \u003d false;"},{"lineNumber":51,"author":{"gitId":"-"},"content":"        this.points \u003d 100;"},{"lineNumber":52,"author":{"gitId":"-"},"content":"        this.forceUnevenDistribution \u003d false;"},{"lineNumber":53,"author":{"gitId":"-"},"content":"        this.distributePointsFor \u003d FeedbackConstantSumDistributePointsType.NONE.getDisplayedOption();"},{"lineNumber":54,"author":{"gitId":"-"},"content":"    }"},{"lineNumber":55,"author":{"gitId":"-"},"content":""},{"lineNumber":56,"author":{"gitId":"-"},"content":"    @Override"},{"lineNumber":57,"author":{"gitId":"-"},"content":"    public boolean shouldChangesRequireResponseDeletion("},{"lineNumber":58,"author":{"gitId":"-"},"content":"            FeedbackQuestionDetails newDetails) {"},{"lineNumber":59,"author":{"gitId":"-"},"content":"        FeedbackConstantSumQuestionDetails newConstSumDetails \u003d (FeedbackConstantSumQuestionDetails) newDetails;"},{"lineNumber":60,"author":{"gitId":"-"},"content":""},{"lineNumber":61,"author":{"gitId":"-"},"content":"        if (!this.constSumOptions.containsAll(newConstSumDetails.constSumOptions)"},{"lineNumber":62,"author":{"gitId":"-"},"content":"                || !newConstSumDetails.constSumOptions.containsAll(this.constSumOptions)) {"},{"lineNumber":63,"author":{"gitId":"-"},"content":"            return true;"},{"lineNumber":64,"author":{"gitId":"-"},"content":"        }"},{"lineNumber":65,"author":{"gitId":"-"},"content":""},{"lineNumber":66,"author":{"gitId":"-"},"content":"        if (this.distributeToRecipients !\u003d newConstSumDetails.distributeToRecipients) {"},{"lineNumber":67,"author":{"gitId":"-"},"content":"            return true;"},{"lineNumber":68,"author":{"gitId":"-"},"content":"        }"},{"lineNumber":69,"author":{"gitId":"-"},"content":""},{"lineNumber":70,"author":{"gitId":"-"},"content":"        if (this.points !\u003d newConstSumDetails.points) {"},{"lineNumber":71,"author":{"gitId":"-"},"content":"            return true;"},{"lineNumber":72,"author":{"gitId":"-"},"content":"        }"},{"lineNumber":73,"author":{"gitId":"-"},"content":""},{"lineNumber":74,"author":{"gitId":"-"},"content":"        if (this.pointsPerOption !\u003d newConstSumDetails.pointsPerOption) {"},{"lineNumber":75,"author":{"gitId":"-"},"content":"            return true;"},{"lineNumber":76,"author":{"gitId":"-"},"content":"        }"},{"lineNumber":77,"author":{"gitId":"-"},"content":""},{"lineNumber":78,"author":{"gitId":"-"},"content":"        if (this.forceUnevenDistribution !\u003d newConstSumDetails.forceUnevenDistribution) {"},{"lineNumber":79,"author":{"gitId":"-"},"content":"            return true;"},{"lineNumber":80,"author":{"gitId":"-"},"content":"        }"},{"lineNumber":81,"author":{"gitId":"-"},"content":""},{"lineNumber":82,"author":{"gitId":"-"},"content":"        return !this.distributePointsFor.equals(newConstSumDetails.distributePointsFor);"},{"lineNumber":83,"author":{"gitId":"-"},"content":"    }"},{"lineNumber":84,"author":{"gitId":"-"},"content":""},{"lineNumber":85,"author":{"gitId":"-"},"content":"    @Override"},{"lineNumber":86,"author":{"gitId":"-"},"content":"    public List\u003cString\u003e validateQuestionDetails() {"},{"lineNumber":87,"author":{"gitId":"-"},"content":"        List\u003cString\u003e errors \u003d new ArrayList\u003c\u003e();"},{"lineNumber":88,"author":{"gitId":"-"},"content":"        if (!distributeToRecipients \u0026\u0026 constSumOptions.size() \u003c CONST_SUM_MIN_NUM_OF_OPTIONS) {"},{"lineNumber":89,"author":{"gitId":"-"},"content":"            errors.add(CONST_SUM_ERROR_NOT_ENOUGH_OPTIONS"},{"lineNumber":90,"author":{"gitId":"-"},"content":"                       + CONST_SUM_MIN_NUM_OF_OPTIONS + \".\");"},{"lineNumber":91,"author":{"gitId":"-"},"content":"        }"},{"lineNumber":92,"author":{"gitId":"-"},"content":""},{"lineNumber":93,"author":{"gitId":"-"},"content":"        if (points \u003c CONST_SUM_MIN_NUM_OF_POINTS) {"},{"lineNumber":94,"author":{"gitId":"-"},"content":"            errors.add(CONST_SUM_ERROR_NOT_ENOUGH_POINTS"},{"lineNumber":95,"author":{"gitId":"-"},"content":"                       + CONST_SUM_MIN_NUM_OF_POINTS + \".\");"},{"lineNumber":96,"author":{"gitId":"-"},"content":"        }"},{"lineNumber":97,"author":{"gitId":"-"},"content":""},{"lineNumber":98,"author":{"gitId":"-"},"content":"        if (!FieldValidator.areElementsUnique(constSumOptions)) {"},{"lineNumber":99,"author":{"gitId":"-"},"content":"            errors.add(CONST_SUM_ERROR_DUPLICATE_OPTIONS);"},{"lineNumber":100,"author":{"gitId":"-"},"content":"        }"},{"lineNumber":101,"author":{"gitId":"-"},"content":""},{"lineNumber":102,"author":{"gitId":"-"},"content":"        return errors;"},{"lineNumber":103,"author":{"gitId":"-"},"content":"    }"},{"lineNumber":104,"author":{"gitId":"-"},"content":""},{"lineNumber":105,"author":{"gitId":"-"},"content":"    @Override"},{"lineNumber":106,"author":{"gitId":"-"},"content":"    public List\u003cString\u003e validateResponsesDetails(List\u003cFeedbackResponseDetails\u003e responses, int numRecipients) {"},{"lineNumber":107,"author":{"gitId":"-"},"content":"        List\u003cString\u003e errors;"},{"lineNumber":108,"author":{"gitId":"-"},"content":""},{"lineNumber":109,"author":{"gitId":"-"},"content":"        int numOptions \u003d distributeToRecipients ? numRecipients : constSumOptions.size();"},{"lineNumber":110,"author":{"gitId":"-"},"content":"        int totalPoints \u003d pointsPerOption ? points * numOptions : points;"},{"lineNumber":111,"author":{"gitId":"-"},"content":""},{"lineNumber":112,"author":{"gitId":"-"},"content":"        if (distributeToRecipients) {"},{"lineNumber":113,"author":{"gitId":"-"},"content":"            errors \u003d getErrorsForConstSumRecipients(responses, totalPoints);"},{"lineNumber":114,"author":{"gitId":"-"},"content":"        } else {"},{"lineNumber":115,"author":{"gitId":"-"},"content":"            errors \u003d getErrorsForConstSumOptions(responses, totalPoints);"},{"lineNumber":116,"author":{"gitId":"-"},"content":"        }"},{"lineNumber":117,"author":{"gitId":"-"},"content":""},{"lineNumber":118,"author":{"gitId":"-"},"content":"        return errors;"},{"lineNumber":119,"author":{"gitId":"-"},"content":"    }"},{"lineNumber":120,"author":{"gitId":"-"},"content":""},{"lineNumber":121,"author":{"gitId":"-"},"content":"    private List\u003cString\u003e getErrorsForConstSumOptions(List\u003cFeedbackResponseDetails\u003e responses, int totalPoints) {"},{"lineNumber":122,"author":{"gitId":"-"},"content":"        for (FeedbackResponseDetails response : responses) {"},{"lineNumber":123,"author":{"gitId":"-"},"content":"            List\u003cString\u003e errors \u003d new ArrayList\u003c\u003e();"},{"lineNumber":124,"author":{"gitId":"-"},"content":""},{"lineNumber":125,"author":{"gitId":"-"},"content":"            FeedbackConstantSumResponseDetails details \u003d (FeedbackConstantSumResponseDetails) response;"},{"lineNumber":126,"author":{"gitId":"-"},"content":""},{"lineNumber":127,"author":{"gitId":"-"},"content":"            if (details.getAnswers().size() !\u003d constSumOptions.size()) {"},{"lineNumber":128,"author":{"gitId":"-"},"content":"                errors.add(CONST_SUM_ANSWER_OPTIONS_NOT_MATCH);"},{"lineNumber":129,"author":{"gitId":"-"},"content":"                return errors;"},{"lineNumber":130,"author":{"gitId":"-"},"content":"            }"},{"lineNumber":131,"author":{"gitId":"-"},"content":""},{"lineNumber":132,"author":{"gitId":"-"},"content":"            List\u003cInteger\u003e givenPoints \u003d details.getAnswers();"},{"lineNumber":133,"author":{"gitId":"-"},"content":"            errors \u003d getErrors(givenPoints, totalPoints);"},{"lineNumber":134,"author":{"gitId":"-"},"content":""},{"lineNumber":135,"author":{"gitId":"-"},"content":"            // Return an error if any response is erroneous"},{"lineNumber":136,"author":{"gitId":"-"},"content":"            if (!errors.isEmpty()) {"},{"lineNumber":137,"author":{"gitId":"-"},"content":"                return errors;"},{"lineNumber":138,"author":{"gitId":"-"},"content":"            }"},{"lineNumber":139,"author":{"gitId":"-"},"content":"        }"},{"lineNumber":140,"author":{"gitId":"-"},"content":"        return new ArrayList\u003c\u003e();"},{"lineNumber":141,"author":{"gitId":"-"},"content":"    }"},{"lineNumber":142,"author":{"gitId":"-"},"content":""},{"lineNumber":143,"author":{"gitId":"-"},"content":"    private List\u003cString\u003e getErrorsForConstSumRecipients(List\u003cFeedbackResponseDetails\u003e responses, int totalPoints) {"},{"lineNumber":144,"author":{"gitId":"-"},"content":"        List\u003cInteger\u003e givenPoints \u003d new ArrayList\u003c\u003e();"},{"lineNumber":145,"author":{"gitId":"-"},"content":""},{"lineNumber":146,"author":{"gitId":"-"},"content":"        for (FeedbackResponseDetails response : responses) {"},{"lineNumber":147,"author":{"gitId":"-"},"content":"            FeedbackConstantSumResponseDetails details \u003d (FeedbackConstantSumResponseDetails) response;"},{"lineNumber":148,"author":{"gitId":"-"},"content":""},{"lineNumber":149,"author":{"gitId":"-"},"content":"            List\u003cString\u003e errors \u003d new ArrayList\u003c\u003e();"},{"lineNumber":150,"author":{"gitId":"-"},"content":""},{"lineNumber":151,"author":{"gitId":"-"},"content":"            if (details.getAnswers().size() !\u003d 1) {"},{"lineNumber":152,"author":{"gitId":"-"},"content":"                // Distribute to recipient must have array size one"},{"lineNumber":153,"author":{"gitId":"-"},"content":"                errors.add(CONST_SUM_ANSWER_RECIPIENT_NOT_MATCH);"},{"lineNumber":154,"author":{"gitId":"-"},"content":"            }"},{"lineNumber":155,"author":{"gitId":"-"},"content":""},{"lineNumber":156,"author":{"gitId":"-"},"content":"            // Return an error if any response is erroneous"},{"lineNumber":157,"author":{"gitId":"-"},"content":"            if (!errors.isEmpty()) {"},{"lineNumber":158,"author":{"gitId":"-"},"content":"                return errors;"},{"lineNumber":159,"author":{"gitId":"-"},"content":"            }"},{"lineNumber":160,"author":{"gitId":"-"},"content":""},{"lineNumber":161,"author":{"gitId":"-"},"content":"            int givenPoint \u003d details.getAnswers().get(0);"},{"lineNumber":162,"author":{"gitId":"-"},"content":"            givenPoints.add(givenPoint);"},{"lineNumber":163,"author":{"gitId":"-"},"content":"        }"},{"lineNumber":164,"author":{"gitId":"-"},"content":""},{"lineNumber":165,"author":{"gitId":"-"},"content":"        return getErrors(givenPoints, totalPoints);"},{"lineNumber":166,"author":{"gitId":"-"},"content":"    }"},{"lineNumber":167,"author":{"gitId":"-"},"content":""},{"lineNumber":168,"author":{"gitId":"-"},"content":"    private List\u003cString\u003e getErrors(List\u003cInteger\u003e givenPoints, int totalPoints) {"},{"lineNumber":169,"author":{"gitId":"-"},"content":"        List\u003cString\u003e errors \u003d new ArrayList\u003c\u003e();"},{"lineNumber":170,"author":{"gitId":"-"},"content":""},{"lineNumber":171,"author":{"gitId":"-"},"content":"        // Check that all points are \u003e\u003d 0"},{"lineNumber":172,"author":{"gitId":"-"},"content":"        int sum \u003d 0;"},{"lineNumber":173,"author":{"gitId":"-"},"content":"        for (int i : givenPoints) {"},{"lineNumber":174,"author":{"gitId":"-"},"content":"            if (i \u003c 0) {"},{"lineNumber":175,"author":{"gitId":"-"},"content":"                errors.add(CONST_SUM_ERROR_NEGATIVE);"},{"lineNumber":176,"author":{"gitId":"-"},"content":"                return errors;"},{"lineNumber":177,"author":{"gitId":"-"},"content":"            }"},{"lineNumber":178,"author":{"gitId":"-"},"content":""},{"lineNumber":179,"author":{"gitId":"-"},"content":"            sum +\u003d i;"},{"lineNumber":180,"author":{"gitId":"-"},"content":"        }"},{"lineNumber":181,"author":{"gitId":"-"},"content":""},{"lineNumber":182,"author":{"gitId":"-"},"content":"        // Check that points sum up properly"},{"lineNumber":183,"author":{"gitId":"-"},"content":"        if (sum !\u003d totalPoints) {"},{"lineNumber":184,"author":{"gitId":"-"},"content":"            errors.add(CONST_SUM_ERROR_MISMATCH);"},{"lineNumber":185,"author":{"gitId":"-"},"content":"            return errors;"},{"lineNumber":186,"author":{"gitId":"-"},"content":"        }"},{"lineNumber":187,"author":{"gitId":"-"},"content":""},{"lineNumber":188,"author":{"gitId":"-"},"content":"        // Check that points are given unevenly for all/at least some options as per the question settings"},{"lineNumber":189,"author":{"gitId":"-"},"content":"        Set\u003cInteger\u003e answerSet \u003d new HashSet\u003c\u003e();"},{"lineNumber":190,"author":{"gitId":"-"},"content":"        if (distributePointsFor.equals("},{"lineNumber":191,"author":{"gitId":"-"},"content":"                FeedbackConstantSumDistributePointsType.DISTRIBUTE_SOME_UNEVENLY.getDisplayedOption())) {"},{"lineNumber":192,"author":{"gitId":"-"},"content":"            boolean hasDifferentPoints \u003d false;"},{"lineNumber":193,"author":{"gitId":"-"},"content":"            for (int i : givenPoints) {"},{"lineNumber":194,"author":{"gitId":"-"},"content":"                if (!answerSet.isEmpty() \u0026\u0026 !answerSet.contains(i)) {"},{"lineNumber":195,"author":{"gitId":"-"},"content":"                    hasDifferentPoints \u003d true;"},{"lineNumber":196,"author":{"gitId":"-"},"content":"                    break;"},{"lineNumber":197,"author":{"gitId":"-"},"content":"                }"},{"lineNumber":198,"author":{"gitId":"-"},"content":"                answerSet.add(i);"},{"lineNumber":199,"author":{"gitId":"-"},"content":"            }"},{"lineNumber":200,"author":{"gitId":"-"},"content":""},{"lineNumber":201,"author":{"gitId":"-"},"content":"            if (!hasDifferentPoints) {"},{"lineNumber":202,"author":{"gitId":"-"},"content":"                errors.add(CONST_SUM_ERROR_SOME_UNIQUE);"},{"lineNumber":203,"author":{"gitId":"-"},"content":"                return errors;"},{"lineNumber":204,"author":{"gitId":"-"},"content":"            }"},{"lineNumber":205,"author":{"gitId":"-"},"content":"        } else if (forceUnevenDistribution || distributePointsFor.equals("},{"lineNumber":206,"author":{"gitId":"-"},"content":"                FeedbackConstantSumDistributePointsType.DISTRIBUTE_ALL_UNEVENLY.getDisplayedOption())) {"},{"lineNumber":207,"author":{"gitId":"-"},"content":"            for (int i : givenPoints) {"},{"lineNumber":208,"author":{"gitId":"-"},"content":"                if (answerSet.contains(i)) {"},{"lineNumber":209,"author":{"gitId":"-"},"content":"                    errors.add(CONST_SUM_ERROR_UNIQUE);"},{"lineNumber":210,"author":{"gitId":"-"},"content":"                    return errors;"},{"lineNumber":211,"author":{"gitId":"-"},"content":"                }"},{"lineNumber":212,"author":{"gitId":"-"},"content":"                answerSet.add(i);"},{"lineNumber":213,"author":{"gitId":"-"},"content":"            }"},{"lineNumber":214,"author":{"gitId":"-"},"content":"        }"},{"lineNumber":215,"author":{"gitId":"-"},"content":""},{"lineNumber":216,"author":{"gitId":"-"},"content":"        return errors;"},{"lineNumber":217,"author":{"gitId":"-"},"content":"    }"},{"lineNumber":218,"author":{"gitId":"-"},"content":""},{"lineNumber":219,"author":{"gitId":"-"},"content":"    @Override"},{"lineNumber":220,"author":{"gitId":"-"},"content":"    public boolean isFeedbackParticipantCommentsOnResponsesAllowed() {"},{"lineNumber":221,"author":{"gitId":"-"},"content":"        return false;"},{"lineNumber":222,"author":{"gitId":"-"},"content":"    }"},{"lineNumber":223,"author":{"gitId":"-"},"content":""},{"lineNumber":224,"author":{"gitId":"-"},"content":"    @Override"},{"lineNumber":225,"author":{"gitId":"-"},"content":"    public String validateGiverRecipientVisibility(FeedbackQuestionAttributes feedbackQuestionAttributes) {"},{"lineNumber":226,"author":{"gitId":"-"},"content":"        return \"\";"},{"lineNumber":227,"author":{"gitId":"-"},"content":"    }"},{"lineNumber":228,"author":{"gitId":"-"},"content":""},{"lineNumber":229,"author":{"gitId":"-"},"content":"    public int getNumOfConstSumOptions() {"},{"lineNumber":230,"author":{"gitId":"-"},"content":"        return constSumOptions.size();"},{"lineNumber":231,"author":{"gitId":"-"},"content":"    }"},{"lineNumber":232,"author":{"gitId":"-"},"content":""},{"lineNumber":233,"author":{"gitId":"-"},"content":"    public List\u003cString\u003e getConstSumOptions() {"},{"lineNumber":234,"author":{"gitId":"-"},"content":"        return constSumOptions;"},{"lineNumber":235,"author":{"gitId":"-"},"content":"    }"},{"lineNumber":236,"author":{"gitId":"-"},"content":""},{"lineNumber":237,"author":{"gitId":"-"},"content":"    public void setConstSumOptions(List\u003cString\u003e constSumOptions) {"},{"lineNumber":238,"author":{"gitId":"-"},"content":"        this.constSumOptions \u003d constSumOptions;"},{"lineNumber":239,"author":{"gitId":"-"},"content":"    }"},{"lineNumber":240,"author":{"gitId":"-"},"content":""},{"lineNumber":241,"author":{"gitId":"-"},"content":"    public boolean isDistributeToRecipients() {"},{"lineNumber":242,"author":{"gitId":"-"},"content":"        return distributeToRecipients;"},{"lineNumber":243,"author":{"gitId":"-"},"content":"    }"},{"lineNumber":244,"author":{"gitId":"-"},"content":""},{"lineNumber":245,"author":{"gitId":"-"},"content":"    public void setDistributeToRecipients(boolean distributeToRecipients) {"},{"lineNumber":246,"author":{"gitId":"-"},"content":"        this.distributeToRecipients \u003d distributeToRecipients;"},{"lineNumber":247,"author":{"gitId":"-"},"content":"    }"},{"lineNumber":248,"author":{"gitId":"-"},"content":""},{"lineNumber":249,"author":{"gitId":"-"},"content":"    public boolean isPointsPerOption() {"},{"lineNumber":250,"author":{"gitId":"-"},"content":"        return pointsPerOption;"},{"lineNumber":251,"author":{"gitId":"-"},"content":"    }"},{"lineNumber":252,"author":{"gitId":"-"},"content":""},{"lineNumber":253,"author":{"gitId":"-"},"content":"    public void setPointsPerOption(boolean pointsPerOption) {"},{"lineNumber":254,"author":{"gitId":"-"},"content":"        this.pointsPerOption \u003d pointsPerOption;"},{"lineNumber":255,"author":{"gitId":"-"},"content":"    }"},{"lineNumber":256,"author":{"gitId":"-"},"content":""},{"lineNumber":257,"author":{"gitId":"-"},"content":"    public boolean isForceUnevenDistribution() {"},{"lineNumber":258,"author":{"gitId":"-"},"content":"        return forceUnevenDistribution;"},{"lineNumber":259,"author":{"gitId":"-"},"content":"    }"},{"lineNumber":260,"author":{"gitId":"-"},"content":""},{"lineNumber":261,"author":{"gitId":"-"},"content":"    public void setForceUnevenDistribution(boolean forceUnevenDistribution) {"},{"lineNumber":262,"author":{"gitId":"-"},"content":"        this.forceUnevenDistribution \u003d forceUnevenDistribution;"},{"lineNumber":263,"author":{"gitId":"-"},"content":"    }"},{"lineNumber":264,"author":{"gitId":"-"},"content":""},{"lineNumber":265,"author":{"gitId":"-"},"content":"    public String getDistributePointsFor() {"},{"lineNumber":266,"author":{"gitId":"-"},"content":"        return distributePointsFor;"},{"lineNumber":267,"author":{"gitId":"-"},"content":"    }"},{"lineNumber":268,"author":{"gitId":"-"},"content":""},{"lineNumber":269,"author":{"gitId":"-"},"content":"    public void setDistributePointsFor(String distributePointsFor) {"},{"lineNumber":270,"author":{"gitId":"-"},"content":"        this.distributePointsFor \u003d distributePointsFor;"},{"lineNumber":271,"author":{"gitId":"-"},"content":"    }"},{"lineNumber":272,"author":{"gitId":"-"},"content":""},{"lineNumber":273,"author":{"gitId":"-"},"content":"    public int getPoints() {"},{"lineNumber":274,"author":{"gitId":"-"},"content":"        return points;"},{"lineNumber":275,"author":{"gitId":"-"},"content":"    }"},{"lineNumber":276,"author":{"gitId":"-"},"content":""},{"lineNumber":277,"author":{"gitId":"-"},"content":"    public void setPoints(int points) {"},{"lineNumber":278,"author":{"gitId":"-"},"content":"        this.points \u003d points;"},{"lineNumber":279,"author":{"gitId":"-"},"content":"    }"},{"lineNumber":280,"author":{"gitId":"-"},"content":"}"}],"authorContributionMap":{"zhaojj2209":1,"-":279}},{"path":"src/main/java/teammates/ui/servlets/AuthServlet.java","fileType":"java","lines":[{"lineNumber":1,"author":{"gitId":"-"},"content":"package teammates.ui.servlets;"},{"lineNumber":2,"author":{"gitId":"-"},"content":""},{"lineNumber":3,"author":{"gitId":"-"},"content":"import java.io.IOException;"},{"lineNumber":4,"author":{"gitId":"-"},"content":"import java.util.Arrays;"},{"lineNumber":5,"author":{"gitId":"-"},"content":"import java.util.List;"},{"lineNumber":6,"author":{"gitId":"-"},"content":""},{"lineNumber":7,"author":{"gitId":"-"},"content":"import javax.servlet.http.Cookie;"},{"lineNumber":8,"author":{"gitId":"-"},"content":"import javax.servlet.http.HttpServlet;"},{"lineNumber":9,"author":{"gitId":"-"},"content":"import javax.servlet.http.HttpServletRequest;"},{"lineNumber":10,"author":{"gitId":"-"},"content":""},{"lineNumber":11,"author":{"gitId":"-"},"content":"import com.google.api.client.auth.oauth2.AuthorizationCodeFlow;"},{"lineNumber":12,"author":{"gitId":"-"},"content":"import com.google.api.client.googleapis.auth.oauth2.GoogleAuthorizationCodeFlow;"},{"lineNumber":13,"author":{"gitId":"-"},"content":"import com.google.api.client.http.GenericUrl;"},{"lineNumber":14,"author":{"gitId":"-"},"content":"import com.google.api.client.http.HttpTransport;"},{"lineNumber":15,"author":{"gitId":"-"},"content":"import com.google.api.client.http.javanet.NetHttpTransport;"},{"lineNumber":16,"author":{"gitId":"-"},"content":"import com.google.api.client.json.JsonFactory;"},{"lineNumber":17,"author":{"gitId":"-"},"content":"import com.google.api.client.json.jackson2.JacksonFactory;"},{"lineNumber":18,"author":{"gitId":"-"},"content":"import com.google.api.client.util.store.MemoryDataStoreFactory;"},{"lineNumber":19,"author":{"gitId":"-"},"content":""},{"lineNumber":20,"author":{"gitId":"-"},"content":"import teammates.common.datatransfer.UserInfoCookie;"},{"lineNumber":21,"author":{"gitId":"-"},"content":"import teammates.common.util.Config;"},{"lineNumber":22,"author":{"gitId":"-"},"content":"import teammates.common.util.Const;"},{"lineNumber":23,"author":{"gitId":"-"},"content":"import teammates.common.util.JsonUtils;"},{"lineNumber":24,"author":{"gitId":"-"},"content":"import teammates.common.util.StringHelper;"},{"lineNumber":25,"author":{"gitId":"-"},"content":""},{"lineNumber":26,"author":{"gitId":"-"},"content":"/**"},{"lineNumber":27,"author":{"gitId":"-"},"content":" * Common servlet class that serves user authentication-related functions."},{"lineNumber":28,"author":{"gitId":"-"},"content":" */"},{"lineNumber":29,"author":{"gitId":"-"},"content":"abstract class AuthServlet extends HttpServlet {"},{"lineNumber":30,"author":{"gitId":"-"},"content":""},{"lineNumber":31,"author":{"gitId":"-"},"content":"    private static final MemoryDataStoreFactory DATA_STORE_FACTORY \u003d MemoryDataStoreFactory.getDefaultInstance();"},{"lineNumber":32,"author":{"gitId":"-"},"content":"    private static final HttpTransport HTTP_TRANSPORT \u003d new NetHttpTransport();"},{"lineNumber":33,"author":{"gitId":"-"},"content":"    private static final JsonFactory JSON_FACTORY \u003d JacksonFactory.getDefaultInstance();"},{"lineNumber":34,"author":{"gitId":"-"},"content":"    private static final List\u003cString\u003e SCOPES \u003d Arrays.asList(\"https://www.googleapis.com/auth/userinfo.email\");"},{"lineNumber":35,"author":{"gitId":"-"},"content":""},{"lineNumber":36,"author":{"gitId":"-"},"content":"    /**"},{"lineNumber":37,"author":{"gitId":"-"},"content":"     * Gets the authorization code flow to be used across all HTTP servlet requests."},{"lineNumber":38,"author":{"gitId":"-"},"content":"     */"},{"lineNumber":39,"author":{"gitId":"-"},"content":"    AuthorizationCodeFlow getAuthorizationFlow() throws IOException {"},{"lineNumber":40,"author":{"gitId":"-"},"content":"        return new GoogleAuthorizationCodeFlow.Builder("},{"lineNumber":41,"author":{"gitId":"-"},"content":"                HTTP_TRANSPORT, JSON_FACTORY, Config.OAUTH2_CLIENT_ID, Config.OAUTH2_CLIENT_SECRET, SCOPES)"},{"lineNumber":42,"author":{"gitId":"-"},"content":"                .setDataStoreFactory(DATA_STORE_FACTORY)"},{"lineNumber":43,"author":{"gitId":"-"},"content":"                .setAccessType(\"offline\")"},{"lineNumber":44,"author":{"gitId":"-"},"content":"                .build();"},{"lineNumber":45,"author":{"gitId":"-"},"content":"    }"},{"lineNumber":46,"author":{"gitId":"-"},"content":""},{"lineNumber":47,"author":{"gitId":"-"},"content":"    /**"},{"lineNumber":48,"author":{"gitId":"-"},"content":"     * Returns the redirect URI for the given HTTP servlet request."},{"lineNumber":49,"author":{"gitId":"-"},"content":"     */"},{"lineNumber":50,"author":{"gitId":"-"},"content":"    String getRedirectUri(HttpServletRequest req) {"},{"lineNumber":51,"author":{"gitId":"-"},"content":"        GenericUrl url \u003d new GenericUrl(req.getRequestURL().toString().replaceFirst(\"^http://\", \"https://\"));"},{"lineNumber":52,"author":{"gitId":"-"},"content":"        url.setRawPath(\"/oauth2callback\");"},{"lineNumber":53,"author":{"gitId":"ziqing26"},"content":"        url.set(\"ngsw-bypass\", \"true\");"},{"lineNumber":54,"author":{"gitId":"-"},"content":"        return url.build();"},{"lineNumber":55,"author":{"gitId":"-"},"content":"    }"},{"lineNumber":56,"author":{"gitId":"-"},"content":""},{"lineNumber":57,"author":{"gitId":"-"},"content":"    Cookie getLoginInvalidationCookie() {"},{"lineNumber":58,"author":{"gitId":"-"},"content":"        Cookie cookie \u003d new Cookie(Const.SecurityConfig.AUTH_COOKIE_NAME, \"\");"},{"lineNumber":59,"author":{"gitId":"-"},"content":"        cookie.setPath(\"/\");"},{"lineNumber":60,"author":{"gitId":"-"},"content":"        cookie.setSecure(!Config.isDevServer());"},{"lineNumber":61,"author":{"gitId":"-"},"content":"        cookie.setHttpOnly(true);"},{"lineNumber":62,"author":{"gitId":"-"},"content":"        cookie.setMaxAge(0);"},{"lineNumber":63,"author":{"gitId":"-"},"content":"        return cookie;"},{"lineNumber":64,"author":{"gitId":"-"},"content":"    }"},{"lineNumber":65,"author":{"gitId":"-"},"content":""},{"lineNumber":66,"author":{"gitId":"-"},"content":"    Cookie getLoginCookie(UserInfoCookie uic) {"},{"lineNumber":67,"author":{"gitId":"-"},"content":"        Cookie cookie \u003d new Cookie(Const.SecurityConfig.AUTH_COOKIE_NAME,"},{"lineNumber":68,"author":{"gitId":"-"},"content":"                StringHelper.encrypt(JsonUtils.toCompactJson(uic)));"},{"lineNumber":69,"author":{"gitId":"-"},"content":"        cookie.setPath(\"/\");"},{"lineNumber":70,"author":{"gitId":"-"},"content":"        cookie.setSecure(!Config.isDevServer());"},{"lineNumber":71,"author":{"gitId":"-"},"content":"        cookie.setHttpOnly(true);"},{"lineNumber":72,"author":{"gitId":"-"},"content":"        cookie.setMaxAge(7 * 24 * 60 * 60); // one week"},{"lineNumber":73,"author":{"gitId":"-"},"content":"        return cookie;"},{"lineNumber":74,"author":{"gitId":"-"},"content":"    }"},{"lineNumber":75,"author":{"gitId":"-"},"content":""},{"lineNumber":76,"author":{"gitId":"-"},"content":"    /**"},{"lineNumber":77,"author":{"gitId":"-"},"content":"     * Represents the state object to be persisted during the callback."},{"lineNumber":78,"author":{"gitId":"-"},"content":"     */"},{"lineNumber":79,"author":{"gitId":"-"},"content":"    static class AuthState {"},{"lineNumber":80,"author":{"gitId":"-"},"content":"        private final String nextUrl;"},{"lineNumber":81,"author":{"gitId":"-"},"content":"        private final String sessionId;"},{"lineNumber":82,"author":{"gitId":"-"},"content":""},{"lineNumber":83,"author":{"gitId":"-"},"content":"        AuthState(String nextUrl, String sessionId) {"},{"lineNumber":84,"author":{"gitId":"-"},"content":"            this.nextUrl \u003d nextUrl;"},{"lineNumber":85,"author":{"gitId":"-"},"content":"            this.sessionId \u003d sessionId;"},{"lineNumber":86,"author":{"gitId":"-"},"content":"        }"},{"lineNumber":87,"author":{"gitId":"-"},"content":""},{"lineNumber":88,"author":{"gitId":"-"},"content":"        String getNextUrl() {"},{"lineNumber":89,"author":{"gitId":"-"},"content":"            return nextUrl;"},{"lineNumber":90,"author":{"gitId":"-"},"content":"        }"},{"lineNumber":91,"author":{"gitId":"-"},"content":""},{"lineNumber":92,"author":{"gitId":"-"},"content":"        public String getSessionId() {"},{"lineNumber":93,"author":{"gitId":"-"},"content":"            return sessionId;"},{"lineNumber":94,"author":{"gitId":"-"},"content":"        }"},{"lineNumber":95,"author":{"gitId":"-"},"content":"    }"},{"lineNumber":96,"author":{"gitId":"-"},"content":""},{"lineNumber":97,"author":{"gitId":"-"},"content":"}"}],"authorContributionMap":{"ziqing26":1,"-":96}},{"path":"src/web/app/components/question-submission-form/question-submission-form.component.html","fileType":"html","lines":[{"lineNumber":1,"author":{"gitId":"-"},"content":"\u003cdiv id\u003d\"question-submission-form\" class\u003d\"card\"\u003e"},{"lineNumber":2,"author":{"gitId":"-"},"content":"  \u003cdiv class\u003d\"card-header bg-primary text-white question-header\"\u003e"},{"lineNumber":3,"author":{"gitId":"-"},"content":"    \u003cspan id\u003d\"question-details\"\u003e\u003cb\u003eQuestion {{ model.questionNumber }}: \u003c/b\u003e{{ model.questionBrief }}\u003c/span\u003e"},{"lineNumber":4,"author":{"gitId":"-"},"content":"  \u003c/div\u003e"},{"lineNumber":5,"author":{"gitId":"-"},"content":""},{"lineNumber":6,"author":{"gitId":"-"},"content":"  \u003cdiv class\u003d\"card-body\"\u003e"},{"lineNumber":7,"author":{"gitId":"-"},"content":"    \u003cdiv class\u003d\"card mb-3\" *ngIf\u003d\"model.questionDescription\"\u003e"},{"lineNumber":8,"author":{"gitId":"-"},"content":"      \u003cdiv class\u003d\"card-header\"\u003e"},{"lineNumber":9,"author":{"gitId":"-"},"content":"        \u003cb\u003eMore details\u003c/b\u003e"},{"lineNumber":10,"author":{"gitId":"-"},"content":"      \u003c/div\u003e"},{"lineNumber":11,"author":{"gitId":"-"},"content":"      \u003cdiv id\u003d\"question-description\" class\u003d\"card-body\" [innerHTML]\u003d\"model.questionDescription | safeHtml\"\u003e\u003c/div\u003e"},{"lineNumber":12,"author":{"gitId":"-"},"content":"    \u003c/div\u003e"},{"lineNumber":13,"author":{"gitId":"-"},"content":""},{"lineNumber":14,"author":{"gitId":"-"},"content":"    \u003cdiv class\u003d\"card-body visibility-card\"\u003e"},{"lineNumber":15,"author":{"gitId":"-"},"content":"      \u003cp class\u003d\"text-secondary\"\u003eOnly the following persons can see your responses: \u003c/p\u003e"},{"lineNumber":16,"author":{"gitId":"-"},"content":"      \u003cul id\u003d\"visibility-list\" class\u003d\"text-secondary\"\u003e"},{"lineNumber":17,"author":{"gitId":"-"},"content":"        \u003cli *ngIf\u003d\"model.recipientType \u003d\u003d\u003d FeedbackParticipantType.SELF\"\u003eYou can see your own feedback in the results page later on.\u003c/li\u003e"},{"lineNumber":18,"author":{"gitId":"-"},"content":"        \u003cng-container *ngFor\u003d\"let visibilityType of FeedbackVisibilityType | enumToArray\"\u003e"},{"lineNumber":19,"author":{"gitId":"-"},"content":"          \u003cli *ngIf\u003d\"visibilityStateMachine.isVisibilityTypeApplicable(visibilityType) \u0026\u0026 visibilityStateMachine.hasAnyVisibilityControl(visibilityType)\"\u003e"},{"lineNumber":20,"author":{"gitId":"-"},"content":"            {{ visibilityType | visibilityEntityName:model.recipientType:model.numberOfEntitiesToGiveFeedbackToSetting:model.customNumberOfEntitiesToGiveFeedbackTo }} {{ visibilityStateMachine.getVisibilityControlUnderVisibilityType(visibilityType) | visibilityCapability }}"},{"lineNumber":21,"author":{"gitId":"-"},"content":"          \u003c/li\u003e"},{"lineNumber":22,"author":{"gitId":"-"},"content":"        \u003c/ng-container\u003e"},{"lineNumber":23,"author":{"gitId":"-"},"content":"        \u003cli *ngIf\u003d\"!visibilityStateMachine.hasAnyVisibilityControlForAll()\"\u003eNo-one can see your responses\u003c/li\u003e"},{"lineNumber":24,"author":{"gitId":"-"},"content":"      \u003c/ul\u003e"},{"lineNumber":25,"author":{"gitId":"-"},"content":"    \u003c/div\u003e"},{"lineNumber":26,"author":{"gitId":"-"},"content":""},{"lineNumber":27,"author":{"gitId":"-"},"content":"    \u003ctm-contribution-question-instruction *ngIf\u003d\"model.questionType \u003d\u003d\u003d FeedbackQuestionType.CONTRIB\"\u003e\u003c/tm-contribution-question-instruction\u003e"},{"lineNumber":28,"author":{"gitId":"-"},"content":"    \u003ctm-text-question-instruction *ngIf\u003d\"model.questionType \u003d\u003d\u003d FeedbackQuestionType.TEXT\"\u003e\u003c/tm-text-question-instruction\u003e"},{"lineNumber":29,"author":{"gitId":"-"},"content":"    \u003ctm-num-scale-question-instruction *ngIf\u003d\"model.questionType \u003d\u003d\u003d FeedbackQuestionType.NUMSCALE\"\u003e\u003c/tm-num-scale-question-instruction\u003e"},{"lineNumber":30,"author":{"gitId":"-"},"content":"    \u003ctm-contribution-question-constraint *ngIf\u003d\"model.questionType \u003d\u003d\u003d FeedbackQuestionType.CONTRIB\"\u003e\u003c/tm-contribution-question-constraint\u003e"},{"lineNumber":31,"author":{"gitId":"-"},"content":"    \u003ctm-text-question-constraint *ngIf\u003d\"model.questionType \u003d\u003d\u003d FeedbackQuestionType.TEXT\"\u003e\u003c/tm-text-question-constraint\u003e"},{"lineNumber":32,"author":{"gitId":"-"},"content":"    \u003ctm-num-scale-question-constraint *ngIf\u003d\"model.questionType \u003d\u003d\u003d FeedbackQuestionType.NUMSCALE\"\u003e\u003c/tm-num-scale-question-constraint\u003e"},{"lineNumber":33,"author":{"gitId":"-"},"content":"    \u003ctm-rank-options-question-instruction *ngIf\u003d\"model.questionType \u003d\u003d\u003d FeedbackQuestionType.RANK_OPTIONS\" [questionDetails]\u003d\"model.questionDetails\"\u003e\u003c/tm-rank-options-question-instruction\u003e"},{"lineNumber":34,"author":{"gitId":"-"},"content":"    \u003ctm-msq-question-constraint *ngIf\u003d\"model.questionType \u003d\u003d\u003d FeedbackQuestionType.MSQ\" [questionDetails]\u003d\"model.questionDetails\"\u003e\u003c/tm-msq-question-constraint\u003e"},{"lineNumber":35,"author":{"gitId":"-"},"content":"    \u003ctm-rank-recipients-question-instruction *ngIf\u003d\"model.questionType \u003d\u003d\u003d FeedbackQuestionType.RANK_RECIPIENTS\" [questionDetails]\u003d\"model.questionDetails\"\u003e\u003c/tm-rank-recipients-question-instruction\u003e"},{"lineNumber":36,"author":{"gitId":"-"},"content":"    \u003ctm-constsum-options-question-instruction *ngIf\u003d\"model.questionType \u003d\u003d\u003d FeedbackQuestionType.CONSTSUM_OPTIONS\" [questionDetails]\u003d\"model.questionDetails\"\u003e\u003c/tm-constsum-options-question-instruction\u003e"},{"lineNumber":37,"author":{"gitId":"-"},"content":"    \u003ctm-constsum-recipients-question-instruction *ngIf\u003d\"model.questionType \u003d\u003d\u003d FeedbackQuestionType.CONSTSUM_RECIPIENTS\""},{"lineNumber":38,"author":{"gitId":"-"},"content":"                                                 [questionDetails]\u003d\"model.questionDetails\" [numOfRecipients]\u003d\"model.recipientSubmissionForms.length\"\u003e\u003c/tm-constsum-recipients-question-instruction\u003e"},{"lineNumber":39,"author":{"gitId":"-"},"content":""},{"lineNumber":40,"author":{"gitId":"-"},"content":"    \u003cp *ngIf\u003d\"model.recipientType !\u003d\u003d FeedbackParticipantType.NONE \u0026\u0026 model.recipientType !\u003d\u003d FeedbackParticipantType.SELF\" class\u003d\"margin-top-30px margin-bottom-0px\"\u003e"},{"lineNumber":41,"author":{"gitId":"-"},"content":"      \u003cspan class\u003d\"ngb-tooltip-class font-bold\" ngbTooltip\u003d\"The party being evaluated or given feedback to\"\u003eEvaluee/Recipient\u003c/span\u003e"},{"lineNumber":42,"author":{"gitId":"-"},"content":"    \u003c/p\u003e"},{"lineNumber":43,"author":{"gitId":"-"},"content":""},{"lineNumber":44,"author":{"gitId":"-"},"content":"    \u003cdiv class\u003d\"alert alert-primary\" role\u003d\"alert\" *ngIf\u003d\"model.giverType \u003d\u003d\u003d FeedbackParticipantType.TEAMS\"\u003e"},{"lineNumber":45,"author":{"gitId":"-"},"content":"      Please note that you are submitting this response on behalf of your team."},{"lineNumber":46,"author":{"gitId":"-"},"content":"    \u003c/div\u003e"},{"lineNumber":47,"author":{"gitId":"-"},"content":""},{"lineNumber":48,"author":{"gitId":"-"},"content":"    \u003cdiv class\u003d\"row\"\u003e"},{"lineNumber":49,"author":{"gitId":"-"},"content":"      \u003cdiv class\u003d\"evaluee-col col-12\"\u003e"},{"lineNumber":50,"author":{"gitId":"-"},"content":"        \u003cdiv class\u003d\"row\" *ngFor\u003d\"let recipientSubmissionFormModel of model.recipientSubmissionForms; let i \u003d index; trackBy: trackRecipientSubmissionFormByFn\"\u003e"},{"lineNumber":51,"author":{"gitId":"fsgmhoward"},"content":"          \u003cdiv class\u003d\"col-md-5 col-xs-12 margin-top-20px\" *ngIf\u003d\"model.recipientType !\u003d\u003d FeedbackParticipantType.SELF \u0026\u0026 model.recipientType !\u003d\u003d FeedbackParticipantType.NONE\"\u003e"},{"lineNumber":52,"author":{"gitId":"-"},"content":"            \u003cdiv id\u003d\"recipient-name-{{ i }}\" *ngIf\u003d\"formMode \u003d\u003d\u003d QuestionSubmissionFormMode.FIXED_RECIPIENT\"\u003e"},{"lineNumber":53,"author":{"gitId":"-"},"content":"              \u003cb\u003e{{ getRecipientName(recipientSubmissionFormModel.recipientIdentifier) }} \u003c/b\u003e \u003cspan\u003e({{ model.recipientType | recipientTypeName:model.giverType }})\u003c/span\u003e"},{"lineNumber":54,"author":{"gitId":"-"},"content":"            \u003c/div\u003e"},{"lineNumber":55,"author":{"gitId":"-"},"content":"            \u003cdiv class\u003d\"row evaluee-select align-items-center\" *ngIf\u003d\"formMode \u003d\u003d\u003d QuestionSubmissionFormMode.FLEXIBLE_RECIPIENT\"\u003e"},{"lineNumber":56,"author":{"gitId":"-"},"content":"              \u003cselect id\u003d\"recipient-dropdown\" class\u003d\"form-control font-weight-bold col\" [ngModel]\u003d\"recipientSubmissionFormModel.recipientIdentifier\""},{"lineNumber":57,"author":{"gitId":"-"},"content":"                      (ngModelChange)\u003d\"triggerRecipientSubmissionFormChange(i, \u0027recipientIdentifier\u0027, $event)\""},{"lineNumber":58,"author":{"gitId":"-"},"content":"                      [disabled]\u003d\"isDisabled\"\u003e"},{"lineNumber":59,"author":{"gitId":"-"},"content":"                \u003coption value\u003d\"\"\u003e\u003c/option\u003e"},{"lineNumber":60,"author":{"gitId":"-"},"content":"                \u003cng-container *ngFor\u003d\"let recipient of model.recipientList\"\u003e"},{"lineNumber":61,"author":{"gitId":"-"},"content":"                  \u003coption *ngIf\u003d\"!isRecipientSelected(recipient) || recipientSubmissionFormModel.recipientIdentifier \u003d\u003d\u003d recipient.recipientIdentifier\" [ngValue]\u003d\"recipient.recipientIdentifier\"\u003e{{ recipient.recipientName }}\u003c/option\u003e"},{"lineNumber":62,"author":{"gitId":"-"},"content":"                \u003c/ng-container\u003e"},{"lineNumber":63,"author":{"gitId":"-"},"content":"              \u003c/select\u003e"},{"lineNumber":64,"author":{"gitId":"fsgmhoward"},"content":"              \u003cdiv class\u003d\"col-auto text-left\"\u003e"},{"lineNumber":65,"author":{"gitId":"-"},"content":"                ({{ model.recipientType | recipientTypeName: model.giverType }})"},{"lineNumber":66,"author":{"gitId":"-"},"content":"              \u003c/div\u003e"},{"lineNumber":67,"author":{"gitId":"-"},"content":"            \u003c/div\u003e"},{"lineNumber":68,"author":{"gitId":"-"},"content":"          \u003c/div\u003e"},{"lineNumber":69,"author":{"gitId":"fsgmhoward"},"content":"          \u003cdiv class\u003d\"col margin-top-20px\"\u003e"},{"lineNumber":70,"author":{"gitId":"-"},"content":"            \u003ctm-contribution-question-edit-answer-form *ngIf\u003d\"model.questionType \u003d\u003d\u003d FeedbackQuestionType.CONTRIB\" [questionDetails]\u003d\"model.questionDetails\""},{"lineNumber":71,"author":{"gitId":"-"},"content":"                                                      [responseDetails]\u003d\"recipientSubmissionFormModel.responseDetails\""},{"lineNumber":72,"author":{"gitId":"-"},"content":"                                                      [shouldShowHelpLink]\u003d\"i \u003d\u003d\u003d 0\""},{"lineNumber":73,"author":{"gitId":"-"},"content":"                                                      (responseDetailsChange)\u003d\"triggerRecipientSubmissionFormChange(i, \u0027responseDetails\u0027, $event)\""},{"lineNumber":74,"author":{"gitId":"-"},"content":"                                                      [isDisabled]\u003d\"isDisabled\""},{"lineNumber":75,"author":{"gitId":"-"},"content":"            \u003e\u003c/tm-contribution-question-edit-answer-form\u003e"},{"lineNumber":76,"author":{"gitId":"-"},"content":"            \u003ctm-text-question-edit-answer-form *ngIf\u003d\"model.questionType \u003d\u003d\u003d FeedbackQuestionType.TEXT\" [questionDetails]\u003d\"model.questionDetails\""},{"lineNumber":77,"author":{"gitId":"-"},"content":"                                              [responseDetails]\u003d\"recipientSubmissionFormModel.responseDetails\""},{"lineNumber":78,"author":{"gitId":"-"},"content":"                                              (responseDetailsChange)\u003d\"triggerRecipientSubmissionFormChange(i, \u0027responseDetails\u0027, $event)\""},{"lineNumber":79,"author":{"gitId":"-"},"content":"                                              [isDisabled]\u003d\"isDisabled\""},{"lineNumber":80,"author":{"gitId":"-"},"content":"            \u003e\u003c/tm-text-question-edit-answer-form\u003e"},{"lineNumber":81,"author":{"gitId":"-"},"content":"            \u003ctm-rank-options-question-edit-answer-form *ngIf\u003d\"model.questionType \u003d\u003d\u003d FeedbackQuestionType.RANK_OPTIONS\" [questionDetails]\u003d\"model.questionDetails\""},{"lineNumber":82,"author":{"gitId":"-"},"content":"                                                       [responseDetails]\u003d\"recipientSubmissionFormModel.responseDetails\""},{"lineNumber":83,"author":{"gitId":"-"},"content":"                                                       (responseDetailsChange)\u003d\"triggerRecipientSubmissionFormChange(i, \u0027responseDetails\u0027, $event)\""},{"lineNumber":84,"author":{"gitId":"-"},"content":"                                                       [isDisabled]\u003d\"isDisabled\"\u003e\u003c/tm-rank-options-question-edit-answer-form\u003e"},{"lineNumber":85,"author":{"gitId":"-"},"content":"            \u003ctm-rank-recipients-question-edit-answer-form *ngIf\u003d\"model.questionType \u003d\u003d\u003d FeedbackQuestionType.RANK_RECIPIENTS\" [questionDetails]\u003d\"model.questionDetails\""},{"lineNumber":86,"author":{"gitId":"-"},"content":"                                                          [responseDetails]\u003d\"recipientSubmissionFormModel.responseDetails\""},{"lineNumber":87,"author":{"gitId":"-"},"content":"                                                          (responseDetailsChange)\u003d\"triggerRecipientSubmissionFormChange(i, \u0027responseDetails\u0027, $event)\""},{"lineNumber":88,"author":{"gitId":"-"},"content":"                                                          [isDisabled]\u003d\"isDisabled\" [numOfRecipients]\u003d\"model.recipientSubmissionForms.length\"\u003e\u003c/tm-rank-recipients-question-edit-answer-form\u003e"},{"lineNumber":89,"author":{"gitId":"-"},"content":"            \u003ctm-num-scale-question-edit-answer-form *ngIf\u003d\"model.questionType \u003d\u003d\u003d FeedbackQuestionType.NUMSCALE\" [questionDetails]\u003d\"model.questionDetails\""},{"lineNumber":90,"author":{"gitId":"-"},"content":"                                                    [responseDetails]\u003d\"recipientSubmissionFormModel.responseDetails\""},{"lineNumber":91,"author":{"gitId":"-"},"content":"                                                    (responseDetailsChange)\u003d\"triggerRecipientSubmissionFormChange(i, \u0027responseDetails\u0027, $event)\""},{"lineNumber":92,"author":{"gitId":"-"},"content":"                                                    [isDisabled]\u003d\"isDisabled\""},{"lineNumber":93,"author":{"gitId":"-"},"content":"            \u003e\u003c/tm-num-scale-question-edit-answer-form\u003e"},{"lineNumber":94,"author":{"gitId":"-"},"content":"            \u003ctm-mcq-question-edit-answer-form *ngIf\u003d\"model.questionType \u003d\u003d\u003d FeedbackQuestionType.MCQ\" [questionDetails]\u003d\"model.questionDetails\""},{"lineNumber":95,"author":{"gitId":"-"},"content":"                                                    [responseDetails]\u003d\"recipientSubmissionFormModel.responseDetails\""},{"lineNumber":96,"author":{"gitId":"-"},"content":"                                                    (responseDetailsChange)\u003d\"triggerRecipientSubmissionFormChange(i, \u0027responseDetails\u0027, $event)\""},{"lineNumber":97,"author":{"gitId":"-"},"content":"                                                    [isDisabled]\u003d\"isDisabled\""},{"lineNumber":98,"author":{"gitId":"-"},"content":"                                                    [id]\u003d\"model.feedbackQuestionId + recipientSubmissionFormModel.recipientIdentifier\""},{"lineNumber":99,"author":{"gitId":"-"},"content":"            \u003e\u003c/tm-mcq-question-edit-answer-form\u003e"},{"lineNumber":100,"author":{"gitId":"-"},"content":"            \u003ctm-msq-question-edit-answer-form *ngIf\u003d\"model.questionType \u003d\u003d\u003d FeedbackQuestionType.MSQ\" [questionDetails]\u003d\"model.questionDetails\""},{"lineNumber":101,"author":{"gitId":"-"},"content":"                                              [responseDetails]\u003d\"recipientSubmissionFormModel.responseDetails\""},{"lineNumber":102,"author":{"gitId":"-"},"content":"                                              (responseDetailsChange)\u003d\"triggerRecipientSubmissionFormChange(i, \u0027responseDetails\u0027, $event)\""},{"lineNumber":103,"author":{"gitId":"-"},"content":"                                              [isDisabled]\u003d\"isDisabled\""},{"lineNumber":104,"author":{"gitId":"-"},"content":"            \u003e\u003c/tm-msq-question-edit-answer-form\u003e"},{"lineNumber":105,"author":{"gitId":"-"},"content":"            \u003ctm-rubric-question-edit-answer-form *ngIf\u003d\"model.questionType \u003d\u003d\u003d FeedbackQuestionType.RUBRIC\" [questionDetails]\u003d\"model.questionDetails\""},{"lineNumber":106,"author":{"gitId":"-"},"content":"                                                 [responseDetails]\u003d\"recipientSubmissionFormModel.responseDetails\""},{"lineNumber":107,"author":{"gitId":"-"},"content":"                                                 (responseDetailsChange)\u003d\"triggerRecipientSubmissionFormChange(i, \u0027responseDetails\u0027, $event)\""},{"lineNumber":108,"author":{"gitId":"-"},"content":"                                                 [isDisabled]\u003d\"isDisabled\""},{"lineNumber":109,"author":{"gitId":"-"},"content":"                                                 [id]\u003d\"model.feedbackQuestionId + recipientSubmissionFormModel.recipientIdentifier\"\u003e\u003c/tm-rubric-question-edit-answer-form\u003e"},{"lineNumber":110,"author":{"gitId":"-"},"content":"            \u003ctm-constsum-options-question-edit-answer-form *ngIf\u003d\"model.questionType \u003d\u003d\u003d FeedbackQuestionType.CONSTSUM_OPTIONS\" [questionDetails]\u003d\"model.questionDetails\""},{"lineNumber":111,"author":{"gitId":"-"},"content":"                                                           [responseDetails]\u003d\"recipientSubmissionFormModel.responseDetails\""},{"lineNumber":112,"author":{"gitId":"-"},"content":"                                                           (responseDetailsChange)\u003d\"triggerRecipientSubmissionFormChange(i, \u0027responseDetails\u0027, $event)\""},{"lineNumber":113,"author":{"gitId":"-"},"content":"                                                           [isDisabled]\u003d\"isDisabled\"\u003e"},{"lineNumber":114,"author":{"gitId":"-"},"content":"            \u003c/tm-constsum-options-question-edit-answer-form\u003e"},{"lineNumber":115,"author":{"gitId":"-"},"content":"            \u003ctm-constsum-recipients-question-edit-answer-form *ngIf\u003d\"model.questionType \u003d\u003d\u003d FeedbackQuestionType.CONSTSUM_RECIPIENTS\" [questionDetails]\u003d\"model.questionDetails\""},{"lineNumber":116,"author":{"gitId":"-"},"content":"                                                           [responseDetails]\u003d\"recipientSubmissionFormModel.responseDetails\""},{"lineNumber":117,"author":{"gitId":"-"},"content":"                                                           (responseDetailsChange)\u003d\"triggerRecipientSubmissionFormChange(i, \u0027responseDetails\u0027, $event)\""},{"lineNumber":118,"author":{"gitId":"-"},"content":"                                                           [isDisabled]\u003d\"isDisabled\"\u003e\u003c/tm-constsum-recipients-question-edit-answer-form\u003e"},{"lineNumber":119,"author":{"gitId":"-"},"content":"          \u003c/div\u003e"},{"lineNumber":120,"author":{"gitId":"-"},"content":""},{"lineNumber":121,"author":{"gitId":"-"},"content":"          \u003cdiv id\u003d\"comment-section\" *ngIf\u003d\"allowedToHaveParticipantComment\" class\u003d\"col-12 margin-bottom-20px margin-top-10px indent\"\u003e"},{"lineNumber":122,"author":{"gitId":"-"},"content":"            \u003cdiv *ngIf\u003d\"recipientSubmissionFormModel.commentByGiver \u0026\u0026 recipientSubmissionFormModel.commentByGiver.originalComment else newComment\"\u003e"},{"lineNumber":123,"author":{"gitId":"-"},"content":"              \u003ctm-comment-row [mode]\u003d\"CommentRowMode.EDIT\" [isVisibilityOptionEnabled]\u003d\"false\""},{"lineNumber":124,"author":{"gitId":"-"},"content":"                              [model]\u003d\"recipientSubmissionFormModel.commentByGiver\""},{"lineNumber":125,"author":{"gitId":"-"},"content":"                              (modelChange)\u003d\"triggerRecipientSubmissionFormChange(i, \u0027commentByGiver\u0027, $event)\""},{"lineNumber":126,"author":{"gitId":"-"},"content":"                              [isFeedbackParticipantComment]\u003d\"true\""},{"lineNumber":127,"author":{"gitId":"-"},"content":"                              [questionShowResponsesTo]\u003d\"model.showResponsesTo\""},{"lineNumber":128,"author":{"gitId":"-"},"content":"                              [shouldHideSavingButton]\u003d\"true\""},{"lineNumber":129,"author":{"gitId":"-"},"content":"                              (deleteCommentEvent)\u003d\"triggerDeleteCommentEvent(i)\""},{"lineNumber":130,"author":{"gitId":"-"},"content":"                              (closeEditingEvent)\u003d\"discardEditedParticipantComment(i)\""},{"lineNumber":131,"author":{"gitId":"-"},"content":"                              [isDisabled]\u003d\"isDisabled || isFeedbackResponseDetailsEmpty(recipientSubmissionFormModel.responseDetails)\"\u003e\u003c/tm-comment-row\u003e"},{"lineNumber":132,"author":{"gitId":"-"},"content":"              \u003cdiv class\u003d\"alert alert-warning margin-top-10px\" role\u003d\"alert\" *ngIf\u003d\"isFeedbackResponseDetailsEmpty(recipientSubmissionFormModel.responseDetails)\"\u003e"},{"lineNumber":133,"author":{"gitId":"-"},"content":"                You must provide a valid response in order to give a comment or your comment will not be saved!"},{"lineNumber":134,"author":{"gitId":"-"},"content":"              \u003c/div\u003e"},{"lineNumber":135,"author":{"gitId":"-"},"content":"            \u003c/div\u003e"},{"lineNumber":136,"author":{"gitId":"-"},"content":"            \u003cng-template #newComment\u003e"},{"lineNumber":137,"author":{"gitId":"-"},"content":"              \u003cdiv style\u003d\"display: inline-block;\" [ngbTooltip]\u003d\"isFeedbackResponseDetailsEmpty(recipientSubmissionFormModel.responseDetails) ? \u0027Give a valid response in order to comment\u0027 : \u0027\u0027\"\u003e"},{"lineNumber":138,"author":{"gitId":"-"},"content":"                \u003cbutton id\u003d\"btn-add-comment\" *ngIf\u003d\"!recipientSubmissionFormModel.commentByGiver\" class\u003d\"btn btn-light btn-sm\""},{"lineNumber":139,"author":{"gitId":"-"},"content":"                        (click)\u003d\"addNewParticipantCommentToResponse(i)\""},{"lineNumber":140,"author":{"gitId":"-"},"content":"                        [disabled]\u003d\"isDisabled || isFeedbackResponseDetailsEmpty(recipientSubmissionFormModel.responseDetails)\"\u003e"},{"lineNumber":141,"author":{"gitId":"-"},"content":"                  \u003ci class\u003d\"fas fa-comment\"\u003e\u003c/i\u003e [Optional] Comment on your response"},{"lineNumber":142,"author":{"gitId":"-"},"content":"                \u003c/button\u003e"},{"lineNumber":143,"author":{"gitId":"-"},"content":"              \u003c/div\u003e"},{"lineNumber":144,"author":{"gitId":"-"},"content":"              \u003cdiv *ngIf\u003d\"recipientSubmissionFormModel.commentByGiver\"\u003e"},{"lineNumber":145,"author":{"gitId":"-"},"content":"                \u003ctm-comment-row [mode]\u003d\"CommentRowMode.ADD\" [isVisibilityOptionEnabled]\u003d\"false\""},{"lineNumber":146,"author":{"gitId":"-"},"content":"                                [isFeedbackParticipantComment]\u003d\"true\""},{"lineNumber":147,"author":{"gitId":"-"},"content":"                                [questionShowResponsesTo]\u003d\"model.showResponsesTo\""},{"lineNumber":148,"author":{"gitId":"-"},"content":"                                [shouldHideSavingButton]\u003d\"true\""},{"lineNumber":149,"author":{"gitId":"-"},"content":"                                [model]\u003d\"recipientSubmissionFormModel.commentByGiver\""},{"lineNumber":150,"author":{"gitId":"-"},"content":"                                (modelChange)\u003d\"triggerRecipientSubmissionFormChange(i, \u0027commentByGiver\u0027, $event)\""},{"lineNumber":151,"author":{"gitId":"-"},"content":"                                (closeEditingEvent)\u003d\"cancelAddingNewParticipantComment(i)\""},{"lineNumber":152,"author":{"gitId":"-"},"content":"                                [isDisabled]\u003d\"isDisabled || isFeedbackResponseDetailsEmpty(recipientSubmissionFormModel.responseDetails)\"\u003e\u003c/tm-comment-row\u003e"},{"lineNumber":153,"author":{"gitId":"-"},"content":"                \u003cdiv class\u003d\"alert alert-warning margin-top-10px\" role\u003d\"alert\" *ngIf\u003d\"isFeedbackResponseDetailsEmpty(recipientSubmissionFormModel.responseDetails)\"\u003e"},{"lineNumber":154,"author":{"gitId":"-"},"content":"                  You must provide a valid response in order to give a comment or your comment will not be saved!"},{"lineNumber":155,"author":{"gitId":"-"},"content":"                \u003c/div\u003e"},{"lineNumber":156,"author":{"gitId":"-"},"content":"              \u003c/div\u003e"},{"lineNumber":157,"author":{"gitId":"-"},"content":"            \u003c/ng-template\u003e"},{"lineNumber":158,"author":{"gitId":"-"},"content":"          \u003c/div\u003e"},{"lineNumber":159,"author":{"gitId":"-"},"content":"        \u003c/div\u003e"},{"lineNumber":160,"author":{"gitId":"-"},"content":"      \u003c/div\u003e"},{"lineNumber":161,"author":{"gitId":"-"},"content":"    \u003c/div\u003e"},{"lineNumber":162,"author":{"gitId":"-"},"content":""},{"lineNumber":163,"author":{"gitId":"-"},"content":"    \u003cdiv class\u003d\"col-12 constraint-margins\"\u003e"},{"lineNumber":164,"author":{"gitId":"-"},"content":"      \u003ctm-rank-recipients-question-constraint *ngIf\u003d\"model.questionType \u003d\u003d\u003d FeedbackQuestionType.RANK_RECIPIENTS\""},{"lineNumber":165,"author":{"gitId":"-"},"content":"                                              [recipientSubmissionForms]\u003d\"model.recipientSubmissionForms\""},{"lineNumber":166,"author":{"gitId":"-"},"content":"                                              [questionDetails]\u003d\"model.questionDetails\""},{"lineNumber":167,"author":{"gitId":"-"},"content":"                                              (isValidEvent)\u003d\"updateValidity($event)\""},{"lineNumber":168,"author":{"gitId":"-"},"content":"      \u003e\u003c/tm-rank-recipients-question-constraint\u003e"},{"lineNumber":169,"author":{"gitId":"-"},"content":"      \u003ctm-constsum-recipients-question-constraint *ngIf\u003d\"model.questionType \u003d\u003d\u003d FeedbackQuestionType.CONSTSUM_RECIPIENTS\""},{"lineNumber":170,"author":{"gitId":"-"},"content":"                                                  [recipientSubmissionForms]\u003d\"model.recipientSubmissionForms\""},{"lineNumber":171,"author":{"gitId":"-"},"content":"                                                  [questionDetails]\u003d\"model.questionDetails\""},{"lineNumber":172,"author":{"gitId":"-"},"content":"                                                  (isValidEvent)\u003d\"updateValidity($event)\""},{"lineNumber":173,"author":{"gitId":"-"},"content":"      \u003e\u003c/tm-constsum-recipients-question-constraint\u003e"},{"lineNumber":174,"author":{"gitId":"-"},"content":"    \u003c/div\u003e"},{"lineNumber":175,"author":{"gitId":"-"},"content":""},{"lineNumber":176,"author":{"gitId":"-"},"content":"    \u003cdiv class\u003d\"alert alert-warning\" role\u003d\"alert\" *ngIf\u003d\"model.recipientList.length \u003d\u003d\u003d 0\"\u003e"},{"lineNumber":177,"author":{"gitId":"-"},"content":"      \u003cspan *ngIf\u003d\"model.recipientType \u003d\u003d\u003d FeedbackParticipantType.OWN_TEAM_MEMBERS\"\u003eThis question is for team members and you don\u0027t have any team members. Therefore, you will not be able to answer this question.\u003c/span\u003e"},{"lineNumber":178,"author":{"gitId":"-"},"content":"      \u003cspan *ngIf\u003d\"model.recipientType \u003d\u003d\u003d FeedbackParticipantType.TEAMS\"\u003eThis question is for other teams in this course and this course doesn\u0027t have any other team. Therefore, you will not be able to answer this question.\u003c/span\u003e"},{"lineNumber":179,"author":{"gitId":"-"},"content":"      \u003cspan *ngIf\u003d\"model.recipientType \u003d\u003d\u003d FeedbackParticipantType.STUDENTS\"\u003eThis question is for other students in this course and this course doesn\u0027t have any other student. Therefore, you will not be able to answer this question.\u003c/span\u003e"},{"lineNumber":180,"author":{"gitId":"-"},"content":"    \u003c/div\u003e"},{"lineNumber":181,"author":{"gitId":"-"},"content":"  \u003c/div\u003e"},{"lineNumber":182,"author":{"gitId":"-"},"content":"\u003c/div\u003e"}],"authorContributionMap":{"fsgmhoward":3,"-":179}},{"path":"src/web/app/components/question-submission-form/question-submission-form.component.spec.ts","fileType":"ts","lines":[{"lineNumber":1,"author":{"gitId":"-"},"content":"import { async, ComponentFixture, TestBed } from \u0027@angular/core/testing\u0027;"},{"lineNumber":2,"author":{"gitId":"-"},"content":""},{"lineNumber":3,"author":{"gitId":"-"},"content":"import { HttpClientTestingModule } from \u0027@angular/common/http/testing\u0027;"},{"lineNumber":4,"author":{"gitId":"-"},"content":"import { FormsModule } from \u0027@angular/forms\u0027;"},{"lineNumber":5,"author":{"gitId":"-"},"content":"import { NgbModule } from \u0027@ng-bootstrap/ng-bootstrap\u0027;"},{"lineNumber":6,"author":{"gitId":"Nicolascwy"},"content":"import {"},{"lineNumber":7,"author":{"gitId":"Nicolascwy"},"content":"  FeedbackNumericalScaleQuestionDetails,"},{"lineNumber":8,"author":{"gitId":"Nicolascwy"},"content":"  FeedbackNumericalScaleResponseDetails,"},{"lineNumber":9,"author":{"gitId":"Nicolascwy"},"content":"  FeedbackParticipantType,"},{"lineNumber":10,"author":{"gitId":"Nicolascwy"},"content":"  FeedbackQuestionType,"},{"lineNumber":11,"author":{"gitId":"Nicolascwy"},"content":"  FeedbackVisibilityType,"},{"lineNumber":12,"author":{"gitId":"Nicolascwy"},"content":"  NumberOfEntitiesToGiveFeedbackToSetting,"},{"lineNumber":13,"author":{"gitId":"Nicolascwy"},"content":"} from \u0027../../../types/api-output\u0027;"},{"lineNumber":14,"author":{"gitId":"-"},"content":"import { CommentBoxModule } from \u0027../comment-box/comment-box.module\u0027;"},{"lineNumber":15,"author":{"gitId":"-"},"content":"import { QuestionConstraintModule } from \u0027../question-types/question-constraint/question-constraint.module\u0027;"},{"lineNumber":16,"author":{"gitId":"-"},"content":"import {"},{"lineNumber":17,"author":{"gitId":"-"},"content":"  QuestionEditAnswerFormModule,"},{"lineNumber":18,"author":{"gitId":"-"},"content":"} from \u0027../question-types/question-edit-answer-form/question-edit-answer-form.module\u0027;"},{"lineNumber":19,"author":{"gitId":"-"},"content":"import { QuestionInstructionModule } from \u0027../question-types/question-instruction/question-instruction.module\u0027;"},{"lineNumber":20,"author":{"gitId":"-"},"content":"import { RichTextEditorModule } from \u0027../rich-text-editor/rich-text-editor.module\u0027;"},{"lineNumber":21,"author":{"gitId":"-"},"content":"import { TeammatesCommonModule } from \u0027../teammates-common/teammates-common.module\u0027;"},{"lineNumber":22,"author":{"gitId":"-"},"content":"import { VisibilityMessagesModule } from \u0027../visibility-messages/visibility-messages.module\u0027;"},{"lineNumber":23,"author":{"gitId":"Nicolascwy"},"content":"import { FeedbackResponseRecipientSubmissionFormModel, QuestionSubmissionFormModel } from \u0027./question-submission-form-model\u0027;"},{"lineNumber":24,"author":{"gitId":"-"},"content":"import { QuestionSubmissionFormComponent } from \u0027./question-submission-form.component\u0027;"},{"lineNumber":25,"author":{"gitId":"-"},"content":"import { RecipientTypeNamePipe } from \u0027./recipient-type-name.pipe\u0027;"},{"lineNumber":26,"author":{"gitId":"-"},"content":""},{"lineNumber":27,"author":{"gitId":"Nicolascwy"},"content":"const formResponse1: FeedbackResponseRecipientSubmissionFormModel \u003d {"},{"lineNumber":28,"author":{"gitId":"Nicolascwy"},"content":"  responseId: \u0027response-id-1\u0027,"},{"lineNumber":29,"author":{"gitId":"Nicolascwy"},"content":"  recipientIdentifier: \u0027hans-charlie-id\u0027,"},{"lineNumber":30,"author":{"gitId":"Nicolascwy"},"content":"  responseDetails: {"},{"lineNumber":31,"author":{"gitId":"Nicolascwy"},"content":"    answer: 5,"},{"lineNumber":32,"author":{"gitId":"Nicolascwy"},"content":"  } as FeedbackNumericalScaleResponseDetails,"},{"lineNumber":33,"author":{"gitId":"Nicolascwy"},"content":"  isValid: true,"},{"lineNumber":34,"author":{"gitId":"Nicolascwy"},"content":"};"},{"lineNumber":35,"author":{"gitId":"Nicolascwy"},"content":""},{"lineNumber":36,"author":{"gitId":"Nicolascwy"},"content":"const formResponse2: FeedbackResponseRecipientSubmissionFormModel \u003d {"},{"lineNumber":37,"author":{"gitId":"Nicolascwy"},"content":"  responseId: \u0027response-id-2\u0027,"},{"lineNumber":38,"author":{"gitId":"Nicolascwy"},"content":"  recipientIdentifier: \u0027harris-barry-id\u0027,"},{"lineNumber":39,"author":{"gitId":"Nicolascwy"},"content":"  responseDetails: {"},{"lineNumber":40,"author":{"gitId":"Nicolascwy"},"content":"    answer: 4,"},{"lineNumber":41,"author":{"gitId":"Nicolascwy"},"content":"  } as FeedbackNumericalScaleResponseDetails,"},{"lineNumber":42,"author":{"gitId":"Nicolascwy"},"content":"  isValid: true,"},{"lineNumber":43,"author":{"gitId":"Nicolascwy"},"content":"};"},{"lineNumber":44,"author":{"gitId":"Nicolascwy"},"content":""},{"lineNumber":45,"author":{"gitId":"Nicolascwy"},"content":"const formResponse3: FeedbackResponseRecipientSubmissionFormModel \u003d {"},{"lineNumber":46,"author":{"gitId":"Nicolascwy"},"content":"  responseId: \u0027response-id-3\u0027,"},{"lineNumber":47,"author":{"gitId":"Nicolascwy"},"content":"  recipientIdentifier: \u0027rogers-alan-id\u0027,"},{"lineNumber":48,"author":{"gitId":"Nicolascwy"},"content":"  responseDetails: {"},{"lineNumber":49,"author":{"gitId":"Nicolascwy"},"content":"    answer: 3,"},{"lineNumber":50,"author":{"gitId":"Nicolascwy"},"content":"  } as FeedbackNumericalScaleResponseDetails,"},{"lineNumber":51,"author":{"gitId":"Nicolascwy"},"content":"  isValid: true,"},{"lineNumber":52,"author":{"gitId":"Nicolascwy"},"content":"};"},{"lineNumber":53,"author":{"gitId":"Nicolascwy"},"content":""},{"lineNumber":54,"author":{"gitId":"Nicolascwy"},"content":"const formResponse4: FeedbackResponseRecipientSubmissionFormModel \u003d {"},{"lineNumber":55,"author":{"gitId":"Nicolascwy"},"content":"  responseId: \u0027response-id-4\u0027,"},{"lineNumber":56,"author":{"gitId":"Nicolascwy"},"content":"  recipientIdentifier: \u0027buck-arthur-id\u0027,"},{"lineNumber":57,"author":{"gitId":"Nicolascwy"},"content":"  responseDetails: {"},{"lineNumber":58,"author":{"gitId":"Nicolascwy"},"content":"    answer: 2,"},{"lineNumber":59,"author":{"gitId":"Nicolascwy"},"content":"  } as FeedbackNumericalScaleResponseDetails,"},{"lineNumber":60,"author":{"gitId":"Nicolascwy"},"content":"  isValid: true,"},{"lineNumber":61,"author":{"gitId":"Nicolascwy"},"content":"};"},{"lineNumber":62,"author":{"gitId":"Nicolascwy"},"content":""},{"lineNumber":63,"author":{"gitId":"Nicolascwy"},"content":"const testNumscaleQuestionSubmissionForm: QuestionSubmissionFormModel \u003d {"},{"lineNumber":64,"author":{"gitId":"Nicolascwy"},"content":"  feedbackQuestionId: \u0027feedback-question-id-numscale\u0027,"},{"lineNumber":65,"author":{"gitId":"Nicolascwy"},"content":"  questionNumber: 1,"},{"lineNumber":66,"author":{"gitId":"Nicolascwy"},"content":"  questionBrief: \u0027numerical scale question\u0027,"},{"lineNumber":67,"author":{"gitId":"Nicolascwy"},"content":"  questionDescription: \u0027question description\u0027,"},{"lineNumber":68,"author":{"gitId":"Nicolascwy"},"content":"  questionType: FeedbackQuestionType.NUMSCALE,"},{"lineNumber":69,"author":{"gitId":"Nicolascwy"},"content":"  questionDetails: {"},{"lineNumber":70,"author":{"gitId":"Nicolascwy"},"content":"    minScale: 1,"},{"lineNumber":71,"author":{"gitId":"Nicolascwy"},"content":"    maxScale: 10,"},{"lineNumber":72,"author":{"gitId":"Nicolascwy"},"content":"    step: 1,"},{"lineNumber":73,"author":{"gitId":"Nicolascwy"},"content":"  } as FeedbackNumericalScaleQuestionDetails,"},{"lineNumber":74,"author":{"gitId":"Nicolascwy"},"content":"  giverType: FeedbackParticipantType.STUDENTS,"},{"lineNumber":75,"author":{"gitId":"Nicolascwy"},"content":"  recipientType: FeedbackParticipantType.STUDENTS,"},{"lineNumber":76,"author":{"gitId":"Nicolascwy"},"content":""},{"lineNumber":77,"author":{"gitId":"Nicolascwy"},"content":"  recipientList: [{ recipientName: \u0027Alan Rogers\u0027, recipientIdentifier: \u0027rogers-alan-id\u0027 },"},{"lineNumber":78,"author":{"gitId":"Nicolascwy"},"content":"    { recipientName: \u0027Arthur Buck\u0027, recipientIdentifier: \u0027buck-arthur-id\u0027 },"},{"lineNumber":79,"author":{"gitId":"Nicolascwy"},"content":"    { recipientName: \u0027Barry Harris\u0027, recipientIdentifier: \u0027harris-barry-id\u0027 },"},{"lineNumber":80,"author":{"gitId":"Nicolascwy"},"content":"    { recipientName: \u0027Charlie Hans\u0027, recipientIdentifier: \u0027hans-charlie-id\u0027 }],"},{"lineNumber":81,"author":{"gitId":"Nicolascwy"},"content":""},{"lineNumber":82,"author":{"gitId":"Nicolascwy"},"content":"  recipientSubmissionForms: [formResponse1, formResponse2, formResponse3, formResponse4],"},{"lineNumber":83,"author":{"gitId":"Nicolascwy"},"content":"  numberOfEntitiesToGiveFeedbackToSetting: NumberOfEntitiesToGiveFeedbackToSetting.CUSTOM,"},{"lineNumber":84,"author":{"gitId":"Nicolascwy"},"content":"  customNumberOfEntitiesToGiveFeedbackTo: 4,"},{"lineNumber":85,"author":{"gitId":"Nicolascwy"},"content":"  showResponsesTo: [FeedbackVisibilityType.RECIPIENT, FeedbackVisibilityType.INSTRUCTORS],"},{"lineNumber":86,"author":{"gitId":"Nicolascwy"},"content":"  showGiverNameTo: [FeedbackVisibilityType.RECIPIENT, FeedbackVisibilityType.INSTRUCTORS],"},{"lineNumber":87,"author":{"gitId":"Nicolascwy"},"content":"  showRecipientNameTo: [FeedbackVisibilityType.RECIPIENT, FeedbackVisibilityType.INSTRUCTORS],"},{"lineNumber":88,"author":{"gitId":"Nicolascwy"},"content":"};"},{"lineNumber":89,"author":{"gitId":"Nicolascwy"},"content":""},{"lineNumber":90,"author":{"gitId":"-"},"content":"describe(\u0027QuestionSubmissionFormComponent\u0027, () \u003d\u003e {"},{"lineNumber":91,"author":{"gitId":"-"},"content":"  let component: QuestionSubmissionFormComponent;"},{"lineNumber":92,"author":{"gitId":"-"},"content":"  let fixture: ComponentFixture\u003cQuestionSubmissionFormComponent\u003e;"},{"lineNumber":93,"author":{"gitId":"-"},"content":""},{"lineNumber":94,"author":{"gitId":"-"},"content":"  beforeEach(async(() \u003d\u003e {"},{"lineNumber":95,"author":{"gitId":"-"},"content":"    TestBed.configureTestingModule({"},{"lineNumber":96,"author":{"gitId":"-"},"content":"      declarations: ["},{"lineNumber":97,"author":{"gitId":"-"},"content":"        QuestionSubmissionFormComponent,"},{"lineNumber":98,"author":{"gitId":"-"},"content":"        RecipientTypeNamePipe,"},{"lineNumber":99,"author":{"gitId":"-"},"content":"      ],"},{"lineNumber":100,"author":{"gitId":"-"},"content":"      imports: ["},{"lineNumber":101,"author":{"gitId":"-"},"content":"        HttpClientTestingModule,"},{"lineNumber":102,"author":{"gitId":"-"},"content":"        TeammatesCommonModule,"},{"lineNumber":103,"author":{"gitId":"-"},"content":"        VisibilityMessagesModule,"},{"lineNumber":104,"author":{"gitId":"-"},"content":"        QuestionInstructionModule,"},{"lineNumber":105,"author":{"gitId":"-"},"content":"        QuestionConstraintModule,"},{"lineNumber":106,"author":{"gitId":"-"},"content":"        QuestionEditAnswerFormModule,"},{"lineNumber":107,"author":{"gitId":"-"},"content":"        RichTextEditorModule,"},{"lineNumber":108,"author":{"gitId":"-"},"content":"        FormsModule,"},{"lineNumber":109,"author":{"gitId":"-"},"content":"        CommentBoxModule,"},{"lineNumber":110,"author":{"gitId":"-"},"content":"        NgbModule,"},{"lineNumber":111,"author":{"gitId":"-"},"content":"      ],"},{"lineNumber":112,"author":{"gitId":"-"},"content":"    })"},{"lineNumber":113,"author":{"gitId":"-"},"content":"    .compileComponents();"},{"lineNumber":114,"author":{"gitId":"-"},"content":"  }));"},{"lineNumber":115,"author":{"gitId":"-"},"content":""},{"lineNumber":116,"author":{"gitId":"-"},"content":"  beforeEach(() \u003d\u003e {"},{"lineNumber":117,"author":{"gitId":"-"},"content":"    fixture \u003d TestBed.createComponent(QuestionSubmissionFormComponent);"},{"lineNumber":118,"author":{"gitId":"-"},"content":"    component \u003d fixture.componentInstance;"},{"lineNumber":119,"author":{"gitId":"-"},"content":"    fixture.detectChanges();"},{"lineNumber":120,"author":{"gitId":"-"},"content":"  });"},{"lineNumber":121,"author":{"gitId":"-"},"content":""},{"lineNumber":122,"author":{"gitId":"-"},"content":"  it(\u0027should create\u0027, () \u003d\u003e {"},{"lineNumber":123,"author":{"gitId":"-"},"content":"    expect(component).toBeTruthy();"},{"lineNumber":124,"author":{"gitId":"-"},"content":"  });"},{"lineNumber":125,"author":{"gitId":"Nicolascwy"},"content":""},{"lineNumber":126,"author":{"gitId":"Nicolascwy"},"content":"  it(\u0027should set model\u0027, () \u003d\u003e {"},{"lineNumber":127,"author":{"gitId":"Nicolascwy"},"content":"    const model: QuestionSubmissionFormModel \u003d testNumscaleQuestionSubmissionForm;"},{"lineNumber":128,"author":{"gitId":"Nicolascwy"},"content":"    component.formModel \u003d model;"},{"lineNumber":129,"author":{"gitId":"Nicolascwy"},"content":""},{"lineNumber":130,"author":{"gitId":"Nicolascwy"},"content":"    expect(component.model).toBe(model);"},{"lineNumber":131,"author":{"gitId":"Nicolascwy"},"content":"  });"},{"lineNumber":132,"author":{"gitId":"Nicolascwy"},"content":""},{"lineNumber":133,"author":{"gitId":"Nicolascwy"},"content":"  it(\u0027should arrange recipients according to alphabetical order of name after ngOnInit (Sorted recipient list)\u0027, () \u003d\u003e {"},{"lineNumber":134,"author":{"gitId":"Nicolascwy"},"content":"    const model: QuestionSubmissionFormModel \u003d JSON.parse(JSON.stringify(testNumscaleQuestionSubmissionForm));"},{"lineNumber":135,"author":{"gitId":"Nicolascwy"},"content":""},{"lineNumber":136,"author":{"gitId":"Nicolascwy"},"content":"    component.formModel \u003d model;"},{"lineNumber":137,"author":{"gitId":"Nicolascwy"},"content":"    component.ngOnInit();"},{"lineNumber":138,"author":{"gitId":"Nicolascwy"},"content":""},{"lineNumber":139,"author":{"gitId":"Nicolascwy"},"content":"    expect(model.recipientSubmissionForms).toEqual([formResponse3, formResponse4, formResponse2, formResponse1]);"},{"lineNumber":140,"author":{"gitId":"Nicolascwy"},"content":"  });"},{"lineNumber":141,"author":{"gitId":"Nicolascwy"},"content":""},{"lineNumber":142,"author":{"gitId":"Nicolascwy"},"content":"  it(\u0027should arrange recipients according to alphabetical order of name after ngOnInit (Unsorted recipient list)\u0027,"},{"lineNumber":143,"author":{"gitId":"Nicolascwy"},"content":"    () \u003d\u003e {"},{"lineNumber":144,"author":{"gitId":"Nicolascwy"},"content":"      const model: QuestionSubmissionFormModel \u003d JSON.parse(JSON.stringify(testNumscaleQuestionSubmissionForm));"},{"lineNumber":145,"author":{"gitId":"Nicolascwy"},"content":""},{"lineNumber":146,"author":{"gitId":"Nicolascwy"},"content":"      // Change recipient list to unsorted"},{"lineNumber":147,"author":{"gitId":"Nicolascwy"},"content":"      model.recipientList \u003d [{ recipientName: \u0027Charlie Hans\u0027, recipientIdentifier: \u0027hans-charlie-id\u0027 },"},{"lineNumber":148,"author":{"gitId":"Nicolascwy"},"content":"      { recipientName: \u0027Alan Rogers\u0027, recipientIdentifier: \u0027rogers-alan-id\u0027 },"},{"lineNumber":149,"author":{"gitId":"Nicolascwy"},"content":"      { recipientName: \u0027Barry Harris\u0027, recipientIdentifier: \u0027harris-barry-id\u0027 },"},{"lineNumber":150,"author":{"gitId":"Nicolascwy"},"content":"      { recipientName: \u0027Arthur Buck\u0027, recipientIdentifier: \u0027buck-arthur-id\u0027 },"},{"lineNumber":151,"author":{"gitId":"Nicolascwy"},"content":"      ];"},{"lineNumber":152,"author":{"gitId":"Nicolascwy"},"content":""},{"lineNumber":153,"author":{"gitId":"Nicolascwy"},"content":"      component.formModel \u003d model;"},{"lineNumber":154,"author":{"gitId":"Nicolascwy"},"content":"      component.ngOnInit();"},{"lineNumber":155,"author":{"gitId":"Nicolascwy"},"content":""},{"lineNumber":156,"author":{"gitId":"Nicolascwy"},"content":"      expect(model.recipientSubmissionForms).toEqual([formResponse3, formResponse4, formResponse2, formResponse1]);"},{"lineNumber":157,"author":{"gitId":"Nicolascwy"},"content":"    });"},{"lineNumber":158,"author":{"gitId":"-"},"content":"});"}],"authorContributionMap":{"-":53,"Nicolascwy":105}},{"path":"src/web/app/components/question-submission-form/question-submission-form.component.ts","fileType":"ts","lines":[{"lineNumber":1,"author":{"gitId":"-"},"content":"import { Component, EventEmitter, Input, OnInit, Output } from \u0027@angular/core\u0027;"},{"lineNumber":2,"author":{"gitId":"-"},"content":"import { FeedbackQuestionsService } from \u0027../../../services/feedback-questions.service\u0027;"},{"lineNumber":3,"author":{"gitId":"-"},"content":"import { FeedbackResponsesService } from \u0027../../../services/feedback-responses.service\u0027;"},{"lineNumber":4,"author":{"gitId":"-"},"content":"import { VisibilityStateMachine } from \u0027../../../services/visibility-state-machine\u0027;"},{"lineNumber":5,"author":{"gitId":"-"},"content":"import {"},{"lineNumber":6,"author":{"gitId":"-"},"content":"  FeedbackParticipantType,"},{"lineNumber":7,"author":{"gitId":"-"},"content":"  FeedbackQuestionType, FeedbackResponseDetails, FeedbackTextQuestionDetails,"},{"lineNumber":8,"author":{"gitId":"-"},"content":"  FeedbackVisibilityType,"},{"lineNumber":9,"author":{"gitId":"-"},"content":"  NumberOfEntitiesToGiveFeedbackToSetting,"},{"lineNumber":10,"author":{"gitId":"-"},"content":"} from \u0027../../../types/api-output\u0027;"},{"lineNumber":11,"author":{"gitId":"-"},"content":"import { VisibilityControl } from \u0027../../../types/visibility-control\u0027;"},{"lineNumber":12,"author":{"gitId":"-"},"content":"import { CommentRowMode, CommentRowModel } from \u0027../comment-box/comment-row/comment-row.component\u0027;"},{"lineNumber":13,"author":{"gitId":"-"},"content":"import {"},{"lineNumber":14,"author":{"gitId":"-"},"content":"  FeedbackResponseRecipient,"},{"lineNumber":15,"author":{"gitId":"-"},"content":"  FeedbackResponseRecipientSubmissionFormModel,"},{"lineNumber":16,"author":{"gitId":"-"},"content":"  QuestionSubmissionFormMode,"},{"lineNumber":17,"author":{"gitId":"-"},"content":"  QuestionSubmissionFormModel,"},{"lineNumber":18,"author":{"gitId":"-"},"content":"} from \u0027./question-submission-form-model\u0027;"},{"lineNumber":19,"author":{"gitId":"-"},"content":""},{"lineNumber":20,"author":{"gitId":"-"},"content":"/**"},{"lineNumber":21,"author":{"gitId":"-"},"content":" * The question submission form for a question."},{"lineNumber":22,"author":{"gitId":"-"},"content":" */"},{"lineNumber":23,"author":{"gitId":"-"},"content":"@Component({"},{"lineNumber":24,"author":{"gitId":"-"},"content":"  selector: \u0027tm-question-submission-form\u0027,"},{"lineNumber":25,"author":{"gitId":"-"},"content":"  templateUrl: \u0027./question-submission-form.component.html\u0027,"},{"lineNumber":26,"author":{"gitId":"-"},"content":"  styleUrls: [\u0027./question-submission-form.component.scss\u0027],"},{"lineNumber":27,"author":{"gitId":"-"},"content":"})"},{"lineNumber":28,"author":{"gitId":"-"},"content":"export class QuestionSubmissionFormComponent implements OnInit {"},{"lineNumber":29,"author":{"gitId":"-"},"content":""},{"lineNumber":30,"author":{"gitId":"-"},"content":"  // enum"},{"lineNumber":31,"author":{"gitId":"-"},"content":"  QuestionSubmissionFormMode: typeof QuestionSubmissionFormMode \u003d QuestionSubmissionFormMode;"},{"lineNumber":32,"author":{"gitId":"-"},"content":"  FeedbackQuestionType: typeof FeedbackQuestionType \u003d FeedbackQuestionType;"},{"lineNumber":33,"author":{"gitId":"-"},"content":"  FeedbackParticipantType: typeof FeedbackParticipantType \u003d FeedbackParticipantType;"},{"lineNumber":34,"author":{"gitId":"-"},"content":"  FeedbackVisibilityType: typeof FeedbackVisibilityType \u003d FeedbackVisibilityType;"},{"lineNumber":35,"author":{"gitId":"-"},"content":"  CommentRowMode: typeof CommentRowMode \u003d CommentRowMode;"},{"lineNumber":36,"author":{"gitId":"-"},"content":""},{"lineNumber":37,"author":{"gitId":"-"},"content":"  @Input()"},{"lineNumber":38,"author":{"gitId":"-"},"content":"  formMode: QuestionSubmissionFormMode \u003d QuestionSubmissionFormMode.FIXED_RECIPIENT;"},{"lineNumber":39,"author":{"gitId":"-"},"content":""},{"lineNumber":40,"author":{"gitId":"-"},"content":"  @Input()"},{"lineNumber":41,"author":{"gitId":"-"},"content":"  isDisabled: boolean \u003d false;"},{"lineNumber":42,"author":{"gitId":"-"},"content":""},{"lineNumber":43,"author":{"gitId":"-"},"content":"  @Input()"},{"lineNumber":44,"author":{"gitId":"-"},"content":"  set formModel(model: QuestionSubmissionFormModel) {"},{"lineNumber":45,"author":{"gitId":"-"},"content":"    this.model \u003d model;"},{"lineNumber":46,"author":{"gitId":"-"},"content":"    this.visibilityStateMachine \u003d"},{"lineNumber":47,"author":{"gitId":"-"},"content":"        this.feedbackQuestionsService.getNewVisibilityStateMachine(model.giverType, model.recipientType);"},{"lineNumber":48,"author":{"gitId":"-"},"content":"    const visibilitySetting: {[TKey in VisibilityControl]: FeedbackVisibilityType[]} \u003d {"},{"lineNumber":49,"author":{"gitId":"-"},"content":"      SHOW_RESPONSE: model.showResponsesTo,"},{"lineNumber":50,"author":{"gitId":"-"},"content":"      SHOW_GIVER_NAME: model.showGiverNameTo,"},{"lineNumber":51,"author":{"gitId":"-"},"content":"      SHOW_RECIPIENT_NAME: model.showRecipientNameTo,"},{"lineNumber":52,"author":{"gitId":"-"},"content":"    };"},{"lineNumber":53,"author":{"gitId":"-"},"content":"    this.visibilityStateMachine.applyVisibilitySettings(visibilitySetting);"},{"lineNumber":54,"author":{"gitId":"-"},"content":"    this.allowedToHaveParticipantComment \u003d"},{"lineNumber":55,"author":{"gitId":"-"},"content":"        this.feedbackQuestionsService.isAllowedToHaveParticipantComment(this.model.questionType);"},{"lineNumber":56,"author":{"gitId":"-"},"content":"  }"},{"lineNumber":57,"author":{"gitId":"-"},"content":""},{"lineNumber":58,"author":{"gitId":"-"},"content":"  @Output()"},{"lineNumber":59,"author":{"gitId":"-"},"content":"  formModelChange: EventEmitter\u003cQuestionSubmissionFormModel\u003e \u003d new EventEmitter();"},{"lineNumber":60,"author":{"gitId":"-"},"content":""},{"lineNumber":61,"author":{"gitId":"-"},"content":"  model: QuestionSubmissionFormModel \u003d {"},{"lineNumber":62,"author":{"gitId":"-"},"content":"    feedbackQuestionId: \u0027\u0027,"},{"lineNumber":63,"author":{"gitId":"-"},"content":""},{"lineNumber":64,"author":{"gitId":"-"},"content":"    questionNumber: 0,"},{"lineNumber":65,"author":{"gitId":"-"},"content":"    questionBrief: \u0027\u0027,"},{"lineNumber":66,"author":{"gitId":"-"},"content":"    questionDescription: \u0027\u0027,"},{"lineNumber":67,"author":{"gitId":"-"},"content":""},{"lineNumber":68,"author":{"gitId":"-"},"content":"    giverType: FeedbackParticipantType.STUDENTS,"},{"lineNumber":69,"author":{"gitId":"-"},"content":"    recipientType: FeedbackParticipantType.STUDENTS,"},{"lineNumber":70,"author":{"gitId":"-"},"content":"    recipientList: [],"},{"lineNumber":71,"author":{"gitId":"-"},"content":"    recipientSubmissionForms: [],"},{"lineNumber":72,"author":{"gitId":"-"},"content":""},{"lineNumber":73,"author":{"gitId":"-"},"content":"    questionType: FeedbackQuestionType.TEXT,"},{"lineNumber":74,"author":{"gitId":"-"},"content":"    questionDetails: {"},{"lineNumber":75,"author":{"gitId":"-"},"content":"      questionText: \u0027\u0027,"},{"lineNumber":76,"author":{"gitId":"-"},"content":"      questionType: FeedbackQuestionType.TEXT,"},{"lineNumber":77,"author":{"gitId":"-"},"content":"    } as FeedbackTextQuestionDetails,"},{"lineNumber":78,"author":{"gitId":"-"},"content":""},{"lineNumber":79,"author":{"gitId":"-"},"content":"    numberOfEntitiesToGiveFeedbackToSetting: NumberOfEntitiesToGiveFeedbackToSetting.UNLIMITED,"},{"lineNumber":80,"author":{"gitId":"-"},"content":"    customNumberOfEntitiesToGiveFeedbackTo: 0,"},{"lineNumber":81,"author":{"gitId":"-"},"content":""},{"lineNumber":82,"author":{"gitId":"-"},"content":"    showGiverNameTo: [],"},{"lineNumber":83,"author":{"gitId":"-"},"content":"    showRecipientNameTo: [],"},{"lineNumber":84,"author":{"gitId":"-"},"content":"    showResponsesTo: [],"},{"lineNumber":85,"author":{"gitId":"-"},"content":"  };"},{"lineNumber":86,"author":{"gitId":"-"},"content":""},{"lineNumber":87,"author":{"gitId":"-"},"content":"  @Output()"},{"lineNumber":88,"author":{"gitId":"-"},"content":"  deleteCommentEvent: EventEmitter\u003cnumber\u003e \u003d new EventEmitter();"},{"lineNumber":89,"author":{"gitId":"-"},"content":""},{"lineNumber":90,"author":{"gitId":"-"},"content":"  visibilityStateMachine: VisibilityStateMachine;"},{"lineNumber":91,"author":{"gitId":"-"},"content":"  allowedToHaveParticipantComment: boolean \u003d false;"},{"lineNumber":92,"author":{"gitId":"-"},"content":""},{"lineNumber":93,"author":{"gitId":"-"},"content":"  constructor(private feedbackQuestionsService: FeedbackQuestionsService,"},{"lineNumber":94,"author":{"gitId":"-"},"content":"              private feedbackResponseService: FeedbackResponsesService) {"},{"lineNumber":95,"author":{"gitId":"-"},"content":"    this.visibilityStateMachine \u003d"},{"lineNumber":96,"author":{"gitId":"-"},"content":"        this.feedbackQuestionsService.getNewVisibilityStateMachine("},{"lineNumber":97,"author":{"gitId":"-"},"content":"            this.model.giverType, this.model.recipientType);"},{"lineNumber":98,"author":{"gitId":"-"},"content":"  }"},{"lineNumber":99,"author":{"gitId":"-"},"content":""},{"lineNumber":100,"author":{"gitId":"-"},"content":"  ngOnInit(): void {"},{"lineNumber":101,"author":{"gitId":"Nicolascwy"},"content":"    this.sortRecipientsByName();"},{"lineNumber":102,"author":{"gitId":"Nicolascwy"},"content":"  }"},{"lineNumber":103,"author":{"gitId":"Nicolascwy"},"content":""},{"lineNumber":104,"author":{"gitId":"Nicolascwy"},"content":"  /**"},{"lineNumber":105,"author":{"gitId":"Nicolascwy"},"content":"   * Sorts recipients of feedback by their name."},{"lineNumber":106,"author":{"gitId":"Nicolascwy"},"content":"   */"},{"lineNumber":107,"author":{"gitId":"Nicolascwy"},"content":"  private sortRecipientsByName(): void {"},{"lineNumber":108,"author":{"gitId":"Nicolascwy"},"content":"    this.model.recipientList.sort((firstRecipient: FeedbackResponseRecipient,"},{"lineNumber":109,"author":{"gitId":"Nicolascwy"},"content":"      secondRecipient: FeedbackResponseRecipient) \u003d\u003e"},{"lineNumber":110,"author":{"gitId":"Nicolascwy"},"content":"      firstRecipient.recipientName.localeCompare(secondRecipient.recipientName));"},{"lineNumber":111,"author":{"gitId":"Nicolascwy"},"content":""},{"lineNumber":112,"author":{"gitId":"Nicolascwy"},"content":"    const indexes: Map\u003cString, number\u003e \u003d new Map();"},{"lineNumber":113,"author":{"gitId":"Nicolascwy"},"content":"    this.model.recipientList.forEach((recipient: FeedbackResponseRecipient, index: number) \u003d\u003e {"},{"lineNumber":114,"author":{"gitId":"Nicolascwy"},"content":"      indexes.set(recipient.recipientIdentifier, index);"},{"lineNumber":115,"author":{"gitId":"Nicolascwy"},"content":"    });"},{"lineNumber":116,"author":{"gitId":"Nicolascwy"},"content":""},{"lineNumber":117,"author":{"gitId":"Nicolascwy"},"content":"    this.model.recipientSubmissionForms.sort((firstRecipient: FeedbackResponseRecipientSubmissionFormModel,"},{"lineNumber":118,"author":{"gitId":"Nicolascwy"},"content":"      secondRecipient: FeedbackResponseRecipientSubmissionFormModel) \u003d\u003e {"},{"lineNumber":119,"author":{"gitId":"Nicolascwy"},"content":"      const firstRecipientIndex: number \u003d indexes.get(firstRecipient.recipientIdentifier) || 0;"},{"lineNumber":120,"author":{"gitId":"Nicolascwy"},"content":"      const secondRecipientIndex: number \u003d indexes.get(secondRecipient.recipientIdentifier) || 0;"},{"lineNumber":121,"author":{"gitId":"Nicolascwy"},"content":""},{"lineNumber":122,"author":{"gitId":"Nicolascwy"},"content":"      return firstRecipientIndex - secondRecipientIndex;"},{"lineNumber":123,"author":{"gitId":"Nicolascwy"},"content":"    });"},{"lineNumber":124,"author":{"gitId":"-"},"content":"  }"},{"lineNumber":125,"author":{"gitId":"-"},"content":""},{"lineNumber":126,"author":{"gitId":"-"},"content":"  /**"},{"lineNumber":127,"author":{"gitId":"-"},"content":"   * Tracks submission form for each recipient by the index in the array."},{"lineNumber":128,"author":{"gitId":"-"},"content":"   *"},{"lineNumber":129,"author":{"gitId":"-"},"content":"   * @see https://angular.io/api/common/NgForOf#properties"},{"lineNumber":130,"author":{"gitId":"-"},"content":"   */"},{"lineNumber":131,"author":{"gitId":"-"},"content":"  trackRecipientSubmissionFormByFn(index: number): any {"},{"lineNumber":132,"author":{"gitId":"-"},"content":"    return index;"},{"lineNumber":133,"author":{"gitId":"-"},"content":"  }"},{"lineNumber":134,"author":{"gitId":"-"},"content":""},{"lineNumber":135,"author":{"gitId":"-"},"content":"  /**"},{"lineNumber":136,"author":{"gitId":"-"},"content":"   * Gets recipient name in {@code FIXED_RECIPIENT} mode."},{"lineNumber":137,"author":{"gitId":"-"},"content":"   */"},{"lineNumber":138,"author":{"gitId":"-"},"content":"  getRecipientName(recipientIdentifier: string): string {"},{"lineNumber":139,"author":{"gitId":"-"},"content":"    const recipient: FeedbackResponseRecipient | undefined \u003d"},{"lineNumber":140,"author":{"gitId":"-"},"content":"        this.model.recipientList.find("},{"lineNumber":141,"author":{"gitId":"-"},"content":"            (r: FeedbackResponseRecipient) \u003d\u003e r.recipientIdentifier \u003d\u003d\u003d recipientIdentifier);"},{"lineNumber":142,"author":{"gitId":"-"},"content":"    return recipient ? recipient.recipientName : \u0027Unknown\u0027;"},{"lineNumber":143,"author":{"gitId":"-"},"content":"  }"},{"lineNumber":144,"author":{"gitId":"-"},"content":""},{"lineNumber":145,"author":{"gitId":"-"},"content":"  /**"},{"lineNumber":146,"author":{"gitId":"-"},"content":"   * Checks whether the recipient is already selected in {@code FLEXIBLE_RECIPIENT} mode."},{"lineNumber":147,"author":{"gitId":"-"},"content":"   */"},{"lineNumber":148,"author":{"gitId":"-"},"content":"  isRecipientSelected(recipient: FeedbackResponseRecipient): boolean {"},{"lineNumber":149,"author":{"gitId":"-"},"content":"    return this.model.recipientSubmissionForms.some("},{"lineNumber":150,"author":{"gitId":"-"},"content":"        (recipientSubmissionFormModel: FeedbackResponseRecipientSubmissionFormModel) \u003d\u003e"},{"lineNumber":151,"author":{"gitId":"-"},"content":"            recipientSubmissionFormModel.recipientIdentifier \u003d\u003d\u003d recipient.recipientIdentifier);"},{"lineNumber":152,"author":{"gitId":"-"},"content":"  }"},{"lineNumber":153,"author":{"gitId":"-"},"content":""},{"lineNumber":154,"author":{"gitId":"-"},"content":"  /**"},{"lineNumber":155,"author":{"gitId":"-"},"content":"   * Triggers the change of the recipient submission form."},{"lineNumber":156,"author":{"gitId":"-"},"content":"   */"},{"lineNumber":157,"author":{"gitId":"-"},"content":"  triggerRecipientSubmissionFormChange(index: number, field: string, data: any): void {"},{"lineNumber":158,"author":{"gitId":"-"},"content":"    const recipientSubmissionForms: FeedbackResponseRecipientSubmissionFormModel[] \u003d"},{"lineNumber":159,"author":{"gitId":"-"},"content":"        this.model.recipientSubmissionForms.slice();"},{"lineNumber":160,"author":{"gitId":"-"},"content":"    recipientSubmissionForms[index] \u003d {"},{"lineNumber":161,"author":{"gitId":"-"},"content":"      ...recipientSubmissionForms[index],"},{"lineNumber":162,"author":{"gitId":"-"},"content":"      [field]: data,"},{"lineNumber":163,"author":{"gitId":"-"},"content":"    };"},{"lineNumber":164,"author":{"gitId":"-"},"content":""},{"lineNumber":165,"author":{"gitId":"-"},"content":"    this.formModelChange.emit({"},{"lineNumber":166,"author":{"gitId":"-"},"content":"      ...this.model,"},{"lineNumber":167,"author":{"gitId":"-"},"content":"      recipientSubmissionForms,"},{"lineNumber":168,"author":{"gitId":"-"},"content":"    });"},{"lineNumber":169,"author":{"gitId":"-"},"content":"  }"},{"lineNumber":170,"author":{"gitId":"-"},"content":""},{"lineNumber":171,"author":{"gitId":"-"},"content":"  /**"},{"lineNumber":172,"author":{"gitId":"-"},"content":"   * Triggers deletion of a participant comment associated with the response."},{"lineNumber":173,"author":{"gitId":"-"},"content":"   */"},{"lineNumber":174,"author":{"gitId":"-"},"content":"  triggerDeleteCommentEvent(index: number): void {"},{"lineNumber":175,"author":{"gitId":"-"},"content":"    this.deleteCommentEvent.emit(index);"},{"lineNumber":176,"author":{"gitId":"-"},"content":"  }"},{"lineNumber":177,"author":{"gitId":"-"},"content":""},{"lineNumber":178,"author":{"gitId":"-"},"content":"  /**"},{"lineNumber":179,"author":{"gitId":"-"},"content":"   * Add new participant comment to response with index."},{"lineNumber":180,"author":{"gitId":"-"},"content":"   */"},{"lineNumber":181,"author":{"gitId":"-"},"content":"  addNewParticipantCommentToResponse(index: number): void {"},{"lineNumber":182,"author":{"gitId":"-"},"content":"    this.triggerRecipientSubmissionFormChange(index, \u0027commentByGiver\u0027, {"},{"lineNumber":183,"author":{"gitId":"-"},"content":"      commentEditFormModel: {"},{"lineNumber":184,"author":{"gitId":"-"},"content":"        commentText: \u0027\u0027,"},{"lineNumber":185,"author":{"gitId":"-"},"content":"      },"},{"lineNumber":186,"author":{"gitId":"-"},"content":""},{"lineNumber":187,"author":{"gitId":"-"},"content":"      isEditing: true,"},{"lineNumber":188,"author":{"gitId":"-"},"content":"    });"},{"lineNumber":189,"author":{"gitId":"-"},"content":"  }"},{"lineNumber":190,"author":{"gitId":"-"},"content":""},{"lineNumber":191,"author":{"gitId":"-"},"content":"  /**"},{"lineNumber":192,"author":{"gitId":"-"},"content":"   * Cancel adding new participant comment."},{"lineNumber":193,"author":{"gitId":"-"},"content":"   */"},{"lineNumber":194,"author":{"gitId":"-"},"content":"  cancelAddingNewParticipantComment(index: number): void {"},{"lineNumber":195,"author":{"gitId":"-"},"content":"    this.triggerRecipientSubmissionFormChange(index, \u0027commentByGiver\u0027, null);"},{"lineNumber":196,"author":{"gitId":"-"},"content":"  }"},{"lineNumber":197,"author":{"gitId":"-"},"content":""},{"lineNumber":198,"author":{"gitId":"-"},"content":"  /**"},{"lineNumber":199,"author":{"gitId":"-"},"content":"   * Discards the current editing and restore the original comment."},{"lineNumber":200,"author":{"gitId":"-"},"content":"   */"},{"lineNumber":201,"author":{"gitId":"-"},"content":"  discardEditedParticipantComment(index: number): void {"},{"lineNumber":202,"author":{"gitId":"-"},"content":"    const commentModel: CommentRowModel | undefined \u003d this.model.recipientSubmissionForms[index].commentByGiver;"},{"lineNumber":203,"author":{"gitId":"-"},"content":"    if (!commentModel || !commentModel.originalComment) {"},{"lineNumber":204,"author":{"gitId":"-"},"content":"      return;"},{"lineNumber":205,"author":{"gitId":"-"},"content":"    }"},{"lineNumber":206,"author":{"gitId":"-"},"content":"    this.triggerRecipientSubmissionFormChange(index, \u0027commentByGiver\u0027,"},{"lineNumber":207,"author":{"gitId":"-"},"content":"        Object.assign({}, commentModel, {"},{"lineNumber":208,"author":{"gitId":"-"},"content":"          commentEditFormModel: {"},{"lineNumber":209,"author":{"gitId":"-"},"content":"            commentText: commentModel.originalComment.commentText,"},{"lineNumber":210,"author":{"gitId":"-"},"content":"          },"},{"lineNumber":211,"author":{"gitId":"-"},"content":"          isEditing: false,"},{"lineNumber":212,"author":{"gitId":"-"},"content":"        }));"},{"lineNumber":213,"author":{"gitId":"-"},"content":"  }"},{"lineNumber":214,"author":{"gitId":"-"},"content":""},{"lineNumber":215,"author":{"gitId":"-"},"content":"  /**"},{"lineNumber":216,"author":{"gitId":"-"},"content":"   * Checks whether the response is empty or not."},{"lineNumber":217,"author":{"gitId":"-"},"content":"   */"},{"lineNumber":218,"author":{"gitId":"-"},"content":"  isFeedbackResponseDetailsEmpty(responseDetails: FeedbackResponseDetails): boolean {"},{"lineNumber":219,"author":{"gitId":"-"},"content":"    return this.feedbackResponseService.isFeedbackResponseDetailsEmpty("},{"lineNumber":220,"author":{"gitId":"-"},"content":"        this.model.questionType, responseDetails);"},{"lineNumber":221,"author":{"gitId":"-"},"content":"  }"},{"lineNumber":222,"author":{"gitId":"-"},"content":""},{"lineNumber":223,"author":{"gitId":"-"},"content":"  /**"},{"lineNumber":224,"author":{"gitId":"-"},"content":"   * Updates validity of all responses in a question."},{"lineNumber":225,"author":{"gitId":"-"},"content":"   */"},{"lineNumber":226,"author":{"gitId":"-"},"content":"  updateValidity(isValid: boolean): void {"},{"lineNumber":227,"author":{"gitId":"-"},"content":"    if (this.model.recipientSubmissionForms.length \u003d\u003d\u003d 0) { return; }"},{"lineNumber":228,"author":{"gitId":"-"},"content":"    const recipientSubmissionForms: FeedbackResponseRecipientSubmissionFormModel[] \u003d"},{"lineNumber":229,"author":{"gitId":"-"},"content":"        this.model.recipientSubmissionForms.slice().map("},{"lineNumber":230,"author":{"gitId":"-"},"content":"            (model: FeedbackResponseRecipientSubmissionFormModel) \u003d\u003e Object.assign({}, model, { isValid }));"},{"lineNumber":231,"author":{"gitId":"-"},"content":"    this.formModelChange.emit({"},{"lineNumber":232,"author":{"gitId":"-"},"content":"      ...this.model,"},{"lineNumber":233,"author":{"gitId":"-"},"content":"      recipientSubmissionForms,"},{"lineNumber":234,"author":{"gitId":"-"},"content":"    });"},{"lineNumber":235,"author":{"gitId":"-"},"content":"  }"},{"lineNumber":236,"author":{"gitId":"-"},"content":"}"}],"authorContributionMap":{"-":213,"Nicolascwy":23}},{"path":"src/web/app/components/question-types/question-constraint/constsum-recipients-question-constraint.component.html","fileType":"html","lines":[{"lineNumber":1,"author":{"gitId":"-"},"content":"\u003cdiv class\u003d\"row\" *ngIf\u003d\"!isAllFormsNotAnswered\"\u003e"},{"lineNumber":2,"author":{"gitId":"-"},"content":"  \u003cdiv class\u003d\"col-12\"\u003e"},{"lineNumber":3,"author":{"gitId":"-"},"content":"    \u003cp *ngIf\u003d\"isInsufficientPointsDistributed\" class\u003d\"text-danger\"\u003e\u003cspan class\u003d\"fa fa-times\"\u003e\u003c/span\u003e"},{"lineNumber":4,"author":{"gitId":"-"},"content":"      Actual total is {{ totalAnsweredPoints }}! Distribute the remaining {{ totalRequiredPoints - totalAnsweredPoints }} points.\u003c/p\u003e"},{"lineNumber":5,"author":{"gitId":"-"},"content":""},{"lineNumber":6,"author":{"gitId":"-"},"content":"    \u003cp *ngIf\u003d\"isPointsOverAllocated\" class\u003d\"text-danger\"\u003e\u003cspan class\u003d\"fa fa-times\"\u003e\u003c/span\u003e"},{"lineNumber":7,"author":{"gitId":"-"},"content":"      Actual total is {{ totalAnsweredPoints }}! Remove the extra  {{ totalAnsweredPoints - totalRequiredPoints }} points allocated.\u003c/p\u003e"},{"lineNumber":8,"author":{"gitId":"-"},"content":""},{"lineNumber":9,"author":{"gitId":"-"},"content":"    \u003cp *ngIf\u003d\"isAllPointsDistributed\" class\u003d\"text-success\"\u003e\u003cspan class\u003d\"fa fa-check\"\u003e\u003c/span\u003e"},{"lineNumber":10,"author":{"gitId":"-"},"content":"      All points distributed!\u003c/p\u003e"},{"lineNumber":11,"author":{"gitId":"-"},"content":""},{"lineNumber":12,"author":{"gitId":"zhaojj2209"},"content":"    \u003cp *ngIf\u003d\"isAnyPointsNegative\" class\u003d\"text-danger\"\u003e\u003cspan class\u003d\"fa fa-times\"\u003e\u003c/span\u003e"},{"lineNumber":13,"author":{"gitId":"zhaojj2209"},"content":"      Points cannot be negative!\u003c/p\u003e"},{"lineNumber":14,"author":{"gitId":"zhaojj2209"},"content":""},{"lineNumber":15,"author":{"gitId":"-"},"content":"    \u003cp *ngIf\u003d\"isWronglyAllUneven\" class\u003d\"text-danger\"\u003e\u003cspan class\u003d\"fa fa-times\"\u003e\u003c/span\u003e"},{"lineNumber":16,"author":{"gitId":"-"},"content":"      Multiple recipients are given same points!\u003c/p\u003e"},{"lineNumber":17,"author":{"gitId":"-"},"content":""},{"lineNumber":18,"author":{"gitId":"-"},"content":"    \u003cp *ngIf\u003d\"isCorrectlyAllUneven\" class\u003d\"text-success\"\u003e\u003cspan class\u003d\"fa fa-check\"\u003e\u003c/span\u003e"},{"lineNumber":19,"author":{"gitId":"-"},"content":"      All allocated points are different!\u003c/p\u003e"},{"lineNumber":20,"author":{"gitId":"-"},"content":""},{"lineNumber":21,"author":{"gitId":"-"},"content":"    \u003cp *ngIf\u003d\"isWronglySomeUneven\" class\u003d\"text-danger\"\u003e\u003cspan class\u003d\"fa fa-times\"\u003e\u003c/span\u003e"},{"lineNumber":22,"author":{"gitId":"-"},"content":"      All recipients are given {{ allAnswers[0] }} points. Please allocate different points to at least one recipient.\u003c/p\u003e"},{"lineNumber":23,"author":{"gitId":"-"},"content":""},{"lineNumber":24,"author":{"gitId":"-"},"content":"    \u003cp *ngIf\u003d\"isCorrectlySomeUneven\" class\u003d\"text-success\"\u003e\u003cspan class\u003d\"fa fa-check\"\u003e\u003c/span\u003e"},{"lineNumber":25,"author":{"gitId":"-"},"content":"      At least one recipient has been allocated different number of points.\u003c/p\u003e"},{"lineNumber":26,"author":{"gitId":"-"},"content":"  \u003c/div\u003e"},{"lineNumber":27,"author":{"gitId":"-"},"content":"\u003c/div\u003e"}],"authorContributionMap":{"zhaojj2209":3,"-":24}},{"path":"src/web/app/components/question-types/question-constraint/constsum-recipients-question-constraint.component.ts","fileType":"ts","lines":[{"lineNumber":1,"author":{"gitId":"-"},"content":"import { Component } from \u0027@angular/core\u0027;"},{"lineNumber":2,"author":{"gitId":"-"},"content":"import {"},{"lineNumber":3,"author":{"gitId":"-"},"content":"  FeedbackConstantSumDistributePointsType,"},{"lineNumber":4,"author":{"gitId":"-"},"content":"  FeedbackConstantSumQuestionDetails,"},{"lineNumber":5,"author":{"gitId":"-"},"content":"  FeedbackConstantSumResponseDetails,"},{"lineNumber":6,"author":{"gitId":"-"},"content":"} from \u0027../../../../types/api-output\u0027;"},{"lineNumber":7,"author":{"gitId":"-"},"content":"import {"},{"lineNumber":8,"author":{"gitId":"-"},"content":"  DEFAULT_CONSTSUM_RECIPIENTS_QUESTION_DETAILS,"},{"lineNumber":9,"author":{"gitId":"-"},"content":"} from \u0027../../../../types/default-question-structs\u0027;"},{"lineNumber":10,"author":{"gitId":"-"},"content":"import {"},{"lineNumber":11,"author":{"gitId":"-"},"content":"  FeedbackResponseRecipientSubmissionFormModel,"},{"lineNumber":12,"author":{"gitId":"-"},"content":"} from \u0027../../question-submission-form/question-submission-form-model\u0027;"},{"lineNumber":13,"author":{"gitId":"-"},"content":"import { QuestionConstraintComponent } from \u0027./question-constraint.component\u0027;"},{"lineNumber":14,"author":{"gitId":"-"},"content":""},{"lineNumber":15,"author":{"gitId":"-"},"content":"/**"},{"lineNumber":16,"author":{"gitId":"-"},"content":" * Constraint of constsum recipients question."},{"lineNumber":17,"author":{"gitId":"-"},"content":" */"},{"lineNumber":18,"author":{"gitId":"-"},"content":"@Component({"},{"lineNumber":19,"author":{"gitId":"-"},"content":"  selector: \u0027tm-constsum-recipients-question-constraint\u0027,"},{"lineNumber":20,"author":{"gitId":"-"},"content":"  templateUrl: \u0027./constsum-recipients-question-constraint.component.html\u0027,"},{"lineNumber":21,"author":{"gitId":"-"},"content":"  styleUrls: [\u0027./constsum-recipients-question-constraint.component.scss\u0027],"},{"lineNumber":22,"author":{"gitId":"-"},"content":"})"},{"lineNumber":23,"author":{"gitId":"-"},"content":"export class ConstsumRecipientsQuestionConstraintComponent"},{"lineNumber":24,"author":{"gitId":"-"},"content":"    extends QuestionConstraintComponent\u003cFeedbackConstantSumQuestionDetails\u003e {"},{"lineNumber":25,"author":{"gitId":"-"},"content":""},{"lineNumber":26,"author":{"gitId":"-"},"content":"  // enum"},{"lineNumber":27,"author":{"gitId":"-"},"content":"  FeedbackConstantSumDistributePointsType: typeof FeedbackConstantSumDistributePointsType \u003d"},{"lineNumber":28,"author":{"gitId":"-"},"content":"      FeedbackConstantSumDistributePointsType;"},{"lineNumber":29,"author":{"gitId":"-"},"content":""},{"lineNumber":30,"author":{"gitId":"-"},"content":"  constructor() {"},{"lineNumber":31,"author":{"gitId":"-"},"content":"    super(DEFAULT_CONSTSUM_RECIPIENTS_QUESTION_DETAILS());"},{"lineNumber":32,"author":{"gitId":"-"},"content":"  }"},{"lineNumber":33,"author":{"gitId":"-"},"content":""},{"lineNumber":34,"author":{"gitId":"-"},"content":"  /**"},{"lineNumber":35,"author":{"gitId":"-"},"content":"   * Checks if all forms are not answered."},{"lineNumber":36,"author":{"gitId":"-"},"content":"   */"},{"lineNumber":37,"author":{"gitId":"-"},"content":"  get isAllFormsNotAnswered(): boolean {"},{"lineNumber":38,"author":{"gitId":"-"},"content":"    return this.recipientSubmissionForms.every((form: FeedbackResponseRecipientSubmissionFormModel) \u003d\u003e {"},{"lineNumber":39,"author":{"gitId":"-"},"content":"      const details: FeedbackConstantSumResponseDetails \u003d form.responseDetails as FeedbackConstantSumResponseDetails;"},{"lineNumber":40,"author":{"gitId":"-"},"content":"      return details.answers.length \u003d\u003d\u003d 0;"},{"lineNumber":41,"author":{"gitId":"-"},"content":"    });"},{"lineNumber":42,"author":{"gitId":"-"},"content":"  }"},{"lineNumber":43,"author":{"gitId":"-"},"content":""},{"lineNumber":44,"author":{"gitId":"-"},"content":"  /**"},{"lineNumber":45,"author":{"gitId":"-"},"content":"   * Gets total required points."},{"lineNumber":46,"author":{"gitId":"-"},"content":"   */"},{"lineNumber":47,"author":{"gitId":"-"},"content":"  get totalRequiredPoints(): number {"},{"lineNumber":48,"author":{"gitId":"-"},"content":"    if (this.questionDetails.pointsPerOption) {"},{"lineNumber":49,"author":{"gitId":"-"},"content":"      return this.questionDetails.points * this.recipientSubmissionForms.length;"},{"lineNumber":50,"author":{"gitId":"-"},"content":"    }"},{"lineNumber":51,"author":{"gitId":"-"},"content":"    return this.questionDetails.points;"},{"lineNumber":52,"author":{"gitId":"-"},"content":"  }"},{"lineNumber":53,"author":{"gitId":"-"},"content":""},{"lineNumber":54,"author":{"gitId":"-"},"content":"  /**"},{"lineNumber":55,"author":{"gitId":"-"},"content":"   * Get answers for the recipients."},{"lineNumber":56,"author":{"gitId":"-"},"content":"   */"},{"lineNumber":57,"author":{"gitId":"-"},"content":"  get allAnswers(): number[] {"},{"lineNumber":58,"author":{"gitId":"-"},"content":"    return this.recipientSubmissionForms.map("},{"lineNumber":59,"author":{"gitId":"-"},"content":"        (form: FeedbackResponseRecipientSubmissionFormModel) \u003d\u003e {"},{"lineNumber":60,"author":{"gitId":"-"},"content":"          const details: FeedbackConstantSumResponseDetails \u003d"},{"lineNumber":61,"author":{"gitId":"-"},"content":"              form.responseDetails as FeedbackConstantSumResponseDetails;"},{"lineNumber":62,"author":{"gitId":"-"},"content":"          if (details.answers.length \u003d\u003d\u003d 0) {"},{"lineNumber":63,"author":{"gitId":"-"},"content":"            return 0;"},{"lineNumber":64,"author":{"gitId":"-"},"content":"          }"},{"lineNumber":65,"author":{"gitId":"-"},"content":"          return details.answers[0];"},{"lineNumber":66,"author":{"gitId":"-"},"content":"        });"},{"lineNumber":67,"author":{"gitId":"-"},"content":"  }"},{"lineNumber":68,"author":{"gitId":"-"},"content":""},{"lineNumber":69,"author":{"gitId":"-"},"content":"  /**"},{"lineNumber":70,"author":{"gitId":"-"},"content":"   * Gets total answer points."},{"lineNumber":71,"author":{"gitId":"-"},"content":"   */"},{"lineNumber":72,"author":{"gitId":"-"},"content":"  get totalAnsweredPoints(): number {"},{"lineNumber":73,"author":{"gitId":"-"},"content":"    return this.allAnswers.reduce((total: number, curr: number) \u003d\u003e total + curr, 0);"},{"lineNumber":74,"author":{"gitId":"-"},"content":"  }"},{"lineNumber":75,"author":{"gitId":"-"},"content":""},{"lineNumber":76,"author":{"gitId":"-"},"content":"  /**"},{"lineNumber":77,"author":{"gitId":"-"},"content":"   * Checks if all points are distributed unevenly."},{"lineNumber":78,"author":{"gitId":"-"},"content":"   */"},{"lineNumber":79,"author":{"gitId":"-"},"content":"  get isAllPointsUneven(): boolean {"},{"lineNumber":80,"author":{"gitId":"-"},"content":"    const set: Set\u003cnumber\u003e \u003d new Set();"},{"lineNumber":81,"author":{"gitId":"-"},"content":"    this.allAnswers.forEach((ans: number) \u003d\u003e set.add(ans));"},{"lineNumber":82,"author":{"gitId":"-"},"content":""},{"lineNumber":83,"author":{"gitId":"-"},"content":"    return set.size \u003d\u003d\u003d this.allAnswers.length;"},{"lineNumber":84,"author":{"gitId":"-"},"content":"  }"},{"lineNumber":85,"author":{"gitId":"-"},"content":""},{"lineNumber":86,"author":{"gitId":"-"},"content":"  /**"},{"lineNumber":87,"author":{"gitId":"-"},"content":"   * Checks if some points are distributed unevenly."},{"lineNumber":88,"author":{"gitId":"-"},"content":"   */"},{"lineNumber":89,"author":{"gitId":"-"},"content":"  get isSomePointsUneven(): boolean {"},{"lineNumber":90,"author":{"gitId":"-"},"content":"    if (this.allAnswers.length \u003d\u003d\u003d 1) {"},{"lineNumber":91,"author":{"gitId":"-"},"content":"      return true;"},{"lineNumber":92,"author":{"gitId":"-"},"content":"    }"},{"lineNumber":93,"author":{"gitId":"-"},"content":""},{"lineNumber":94,"author":{"gitId":"-"},"content":"    const set: Set\u003cnumber\u003e \u003d new Set();"},{"lineNumber":95,"author":{"gitId":"-"},"content":"    this.allAnswers.forEach((ans: number) \u003d\u003e set.add(ans));"},{"lineNumber":96,"author":{"gitId":"-"},"content":""},{"lineNumber":97,"author":{"gitId":"-"},"content":"    return set.size !\u003d\u003d 1;"},{"lineNumber":98,"author":{"gitId":"-"},"content":"  }"},{"lineNumber":99,"author":{"gitId":"-"},"content":""},{"lineNumber":100,"author":{"gitId":"-"},"content":"  /**"},{"lineNumber":101,"author":{"gitId":"-"},"content":"   * Checks if all points have been distributed."},{"lineNumber":102,"author":{"gitId":"-"},"content":"   */"},{"lineNumber":103,"author":{"gitId":"-"},"content":"  get isAllPointsDistributed(): boolean {"},{"lineNumber":104,"author":{"gitId":"-"},"content":"    return this.totalAnsweredPoints \u003d\u003d\u003d this.totalRequiredPoints;"},{"lineNumber":105,"author":{"gitId":"-"},"content":"  }"},{"lineNumber":106,"author":{"gitId":"-"},"content":""},{"lineNumber":107,"author":{"gitId":"-"},"content":"  /**"},{"lineNumber":108,"author":{"gitId":"-"},"content":"   * Checks if the points have been insufficiently distributed."},{"lineNumber":109,"author":{"gitId":"-"},"content":"   */"},{"lineNumber":110,"author":{"gitId":"-"},"content":"  get isInsufficientPointsDistributed(): boolean {"},{"lineNumber":111,"author":{"gitId":"-"},"content":"    return this.totalAnsweredPoints \u003c this.totalRequiredPoints;"},{"lineNumber":112,"author":{"gitId":"-"},"content":"  }"},{"lineNumber":113,"author":{"gitId":"-"},"content":""},{"lineNumber":114,"author":{"gitId":"-"},"content":"  /**"},{"lineNumber":115,"author":{"gitId":"-"},"content":"   * Checks if the points have been over allocated."},{"lineNumber":116,"author":{"gitId":"-"},"content":"   */"},{"lineNumber":117,"author":{"gitId":"-"},"content":"  get isPointsOverAllocated(): boolean {"},{"lineNumber":118,"author":{"gitId":"-"},"content":"    return this.totalAnsweredPoints \u003e this.totalRequiredPoints;"},{"lineNumber":119,"author":{"gitId":"-"},"content":"  }"},{"lineNumber":120,"author":{"gitId":"-"},"content":""},{"lineNumber":121,"author":{"gitId":"zhaojj2209"},"content":"  /**"},{"lineNumber":122,"author":{"gitId":"zhaojj2209"},"content":"   * Checks if any of the points are negative."},{"lineNumber":123,"author":{"gitId":"zhaojj2209"},"content":"   */"},{"lineNumber":124,"author":{"gitId":"zhaojj2209"},"content":"  get isAnyPointsNegative(): boolean {"},{"lineNumber":125,"author":{"gitId":"zhaojj2209"},"content":"    return this.allAnswers.reduce((isNegative: boolean, curr: number) \u003d\u003e isNegative || (curr \u003c 0), false);"},{"lineNumber":126,"author":{"gitId":"zhaojj2209"},"content":"  }"},{"lineNumber":127,"author":{"gitId":"zhaojj2209"},"content":""},{"lineNumber":128,"author":{"gitId":"-"},"content":"  /**"},{"lineNumber":129,"author":{"gitId":"-"},"content":"   * Returns true if the question requires uneven distribution but the points are not unevenly distributed."},{"lineNumber":130,"author":{"gitId":"-"},"content":"   */"},{"lineNumber":131,"author":{"gitId":"-"},"content":"  get isWronglyAllUneven(): boolean {"},{"lineNumber":132,"author":{"gitId":"-"},"content":"    return this.questionDetails.distributePointsFor \u003d\u003d\u003d FeedbackConstantSumDistributePointsType.DISTRIBUTE_ALL_UNEVENLY"},{"lineNumber":133,"author":{"gitId":"-"},"content":"        \u0026\u0026 !this.isAllPointsUneven;"},{"lineNumber":134,"author":{"gitId":"-"},"content":"  }"},{"lineNumber":135,"author":{"gitId":"-"},"content":""},{"lineNumber":136,"author":{"gitId":"-"},"content":"  /**"},{"lineNumber":137,"author":{"gitId":"-"},"content":"   * Returns true if the question requires uneven distribution and the points are unevenly distributed."},{"lineNumber":138,"author":{"gitId":"-"},"content":"   */"},{"lineNumber":139,"author":{"gitId":"-"},"content":"  get isCorrectlyAllUneven(): boolean {"},{"lineNumber":140,"author":{"gitId":"-"},"content":"    return this.questionDetails.distributePointsFor \u003d\u003d\u003d FeedbackConstantSumDistributePointsType.DISTRIBUTE_ALL_UNEVENLY"},{"lineNumber":141,"author":{"gitId":"-"},"content":"        \u0026\u0026 this.isAllPointsUneven;"},{"lineNumber":142,"author":{"gitId":"-"},"content":"  }"},{"lineNumber":143,"author":{"gitId":"-"},"content":""},{"lineNumber":144,"author":{"gitId":"-"},"content":"  /**"},{"lineNumber":145,"author":{"gitId":"-"},"content":"   * Returns true if the question requires some uneven distribution but points are not unevenly distributed for some."},{"lineNumber":146,"author":{"gitId":"-"},"content":"   */"},{"lineNumber":147,"author":{"gitId":"-"},"content":"  get isWronglySomeUneven(): boolean {"},{"lineNumber":148,"author":{"gitId":"-"},"content":"    return this.questionDetails.distributePointsFor \u003d\u003d\u003d FeedbackConstantSumDistributePointsType.DISTRIBUTE_SOME_UNEVENLY"},{"lineNumber":149,"author":{"gitId":"-"},"content":"        \u0026\u0026 !this.isSomePointsUneven;"},{"lineNumber":150,"author":{"gitId":"-"},"content":"  }"},{"lineNumber":151,"author":{"gitId":"-"},"content":""},{"lineNumber":152,"author":{"gitId":"-"},"content":"  /**"},{"lineNumber":153,"author":{"gitId":"-"},"content":"   * Returns true if the question requires some uneven distribution and points are unevenly distributed for some."},{"lineNumber":154,"author":{"gitId":"-"},"content":"   */"},{"lineNumber":155,"author":{"gitId":"-"},"content":"  get isCorrectlySomeUneven(): boolean {"},{"lineNumber":156,"author":{"gitId":"-"},"content":"    return this.questionDetails.distributePointsFor \u003d\u003d\u003d FeedbackConstantSumDistributePointsType.DISTRIBUTE_SOME_UNEVENLY"},{"lineNumber":157,"author":{"gitId":"-"},"content":"        \u0026\u0026 this.isSomePointsUneven;"},{"lineNumber":158,"author":{"gitId":"-"},"content":"  }"},{"lineNumber":159,"author":{"gitId":"-"},"content":""},{"lineNumber":160,"author":{"gitId":"-"},"content":"  get isValid(): boolean {"},{"lineNumber":161,"author":{"gitId":"zhaojj2209"},"content":"    return this.isAllPointsDistributed \u0026\u0026 !this.isAnyPointsNegative \u0026\u0026"},{"lineNumber":162,"author":{"gitId":"zhaojj2209"},"content":"        (this.isCorrectlyAllUneven || this.isCorrectlySomeUneven"},{"lineNumber":163,"author":{"gitId":"-"},"content":"        || this.questionDetails.distributePointsFor \u003d\u003d\u003d FeedbackConstantSumDistributePointsType.NONE);"},{"lineNumber":164,"author":{"gitId":"-"},"content":"  }"},{"lineNumber":165,"author":{"gitId":"-"},"content":"}"}],"authorContributionMap":{"zhaojj2209":9,"-":156}},{"path":"src/web/app/components/question-types/question-constraint/rank-recipients-question-constraint.component.html","fileType":"html","lines":[{"lineNumber":1,"author":{"gitId":"-"},"content":"\u003cdiv\u003e"},{"lineNumber":2,"author":{"gitId":"fsgmhoward"},"content":"  \u003cp *ngIf\u003d\"!questionDetails.areDuplicatesAllowed \u0026\u0026 isSameRanksAssigned\" class\u003d\"text-danger\"\u003e\u003cspan class\u003d\"fa fa-times\"\u003e\u003c/span\u003e"},{"lineNumber":3,"author":{"gitId":"fsgmhoward"},"content":"    The same rank should not be given multiple times.\u003c/p\u003e"},{"lineNumber":4,"author":{"gitId":"fsgmhoward"},"content":"  \u003cp *ngIf\u003d\"isNoRecipientRanked\" class\u003d\"text-info\"\u003e\u003cspan class\u003d\"fa fa-info-circle\"\u003e\u003c/span\u003e"},{"lineNumber":5,"author":{"gitId":"fsgmhoward"},"content":"    Please rank the above recipients.\u003c/p\u003e"},{"lineNumber":6,"author":{"gitId":"fsgmhoward"},"content":"  \u003cp *ngIf\u003d\"isMinRecipientsEnabled \u0026\u0026 isRecipientsRankedLessThanMin\" class\u003d\"text-danger\"\u003e\u003cspan class\u003d\"fa fa-times\"\u003e\u003c/span\u003e"},{"lineNumber":7,"author":{"gitId":"fsgmhoward"},"content":"    Rank at least {{ questionDetails.minOptionsToBeRanked }} recipients.\u003c/p\u003e"},{"lineNumber":8,"author":{"gitId":"fsgmhoward"},"content":"  \u003cp *ngIf\u003d\"isMaxRecipientsEnabled \u0026\u0026 isRecipientsRankedMoreThanMax\" class\u003d\"text-danger\"\u003e\u003cspan class\u003d\"fa fa-times\"\u003e\u003c/span\u003e"},{"lineNumber":9,"author":{"gitId":"fsgmhoward"},"content":"    Rank no more than {{questionDetails.maxOptionsToBeRanked}} recipients.\u003c/p\u003e"},{"lineNumber":10,"author":{"gitId":"-"},"content":"\u003c/div\u003e"}],"authorContributionMap":{"fsgmhoward":8,"-":2}},{"path":"src/web/app/components/question-types/question-edit-answer-form/constsum-options-question-edit-answer-form.component.html","fileType":"html","lines":[{"lineNumber":1,"author":{"gitId":"-"},"content":"\u003cdiv class\u003d\"form-group row text-left\" *ngFor\u003d\"let option of questionDetails.constSumOptions; let i \u003d index;\"\u003e"},{"lineNumber":2,"author":{"gitId":"fsgmhoward"},"content":"  \u003cdiv class\u003d\"col-md-5 col-xs-12 text-md-right col-form-label\"\u003e"},{"lineNumber":3,"author":{"gitId":"-"},"content":"    \u003cstrong\u003e{{ option }}\u003c/strong\u003e"},{"lineNumber":4,"author":{"gitId":"-"},"content":"  \u003c/div\u003e"},{"lineNumber":5,"author":{"gitId":"fsgmhoward"},"content":"  \u003cdiv class\u003d\"col-md-7 col-xs-12 text-md-left\"\u003e"},{"lineNumber":6,"author":{"gitId":"-"},"content":"    \u003cinput type\u003d\"number\" class\u003d\"form-control\""},{"lineNumber":7,"author":{"gitId":"-"},"content":"           [ngModel]\u003d\"i \u003c responseDetails.answers.length ? responseDetails.answers[i] : \u0027\u0027\""},{"lineNumber":8,"author":{"gitId":"-"},"content":"           (ngModelChange)\u003d\"triggerResponse(i, $event)\""},{"lineNumber":9,"author":{"gitId":"-"},"content":"           [disabled]\u003d\"isDisabled\""},{"lineNumber":10,"author":{"gitId":"-"},"content":"           min\u003d\"0\" step\u003d\"1\"\u003e"},{"lineNumber":11,"author":{"gitId":"-"},"content":"  \u003c/div\u003e"},{"lineNumber":12,"author":{"gitId":"-"},"content":"\u003c/div\u003e"},{"lineNumber":13,"author":{"gitId":"-"},"content":"\u003cdiv class\u003d\"form-group row\" *ngIf\u003d\"responseDetails.answers.length !\u003d\u003d 0\"\u003e"},{"lineNumber":14,"author":{"gitId":"-"},"content":"  \u003cdiv class\u003d\"col-12 col-sm-5 offset-sm-2\"\u003e"},{"lineNumber":15,"author":{"gitId":"-"},"content":"    \u003cbutton type\u003d\"button\" class\u003d\"btn btn-light btn-sm\" (click)\u003d\"triggerResponseDetailsChange(\u0027answers\u0027, [])\" [disabled]\u003d\"isDisabled\"\u003eClear Points\u003c/button\u003e"},{"lineNumber":16,"author":{"gitId":"-"},"content":"  \u003c/div\u003e"},{"lineNumber":17,"author":{"gitId":"-"},"content":"\u003c/div\u003e"},{"lineNumber":18,"author":{"gitId":"-"},"content":"\u003cdiv class\u003d\"row\" *ngIf\u003d\"responseDetails.answers.length !\u003d\u003d 0\"\u003e"},{"lineNumber":19,"author":{"gitId":"-"},"content":"  \u003cdiv class\u003d\"col-12\"\u003e"},{"lineNumber":20,"author":{"gitId":"-"},"content":"    \u003cp *ngIf\u003d\"totalAnsweredPoints \u003c totalRequiredPoints\" class\u003d\"text-danger\"\u003e\u003cspan class\u003d\"fa fa-times\"\u003e\u003c/span\u003e"},{"lineNumber":21,"author":{"gitId":"-"},"content":"      Actual total is {{ totalAnsweredPoints }}! Distribute the remaining {{ totalRequiredPoints - totalAnsweredPoints }} points.\u003c/p\u003e"},{"lineNumber":22,"author":{"gitId":"-"},"content":""},{"lineNumber":23,"author":{"gitId":"-"},"content":"    \u003cp *ngIf\u003d\"totalAnsweredPoints \u003e totalRequiredPoints\" class\u003d\"text-danger\"\u003e\u003cspan class\u003d\"fa fa-times\"\u003e\u003c/span\u003e"},{"lineNumber":24,"author":{"gitId":"-"},"content":"      Actual total is {{ totalAnsweredPoints }}! Remove the extra  {{ totalAnsweredPoints - totalRequiredPoints }} points allocated.\u003c/p\u003e"},{"lineNumber":25,"author":{"gitId":"-"},"content":""},{"lineNumber":26,"author":{"gitId":"-"},"content":"    \u003cp *ngIf\u003d\"totalAnsweredPoints \u003d\u003d\u003d totalRequiredPoints\" class\u003d\"text-success\"\u003e\u003cspan class\u003d\"fa fa-check\"\u003e\u003c/span\u003e"},{"lineNumber":27,"author":{"gitId":"-"},"content":"      All points distributed!\u003c/p\u003e"},{"lineNumber":28,"author":{"gitId":"-"},"content":""},{"lineNumber":29,"author":{"gitId":"zhaojj2209"},"content":"    \u003cp *ngIf\u003d\"isAnyPointsNegative\" class\u003d\"text-danger\"\u003e\u003cspan class\u003d\"fa fa-times\"\u003e\u003c/span\u003e"},{"lineNumber":30,"author":{"gitId":"zhaojj2209"},"content":"      Points cannot be negative!\u003c/p\u003e"},{"lineNumber":31,"author":{"gitId":"zhaojj2209"},"content":""},{"lineNumber":32,"author":{"gitId":"-"},"content":"    \u003cp *ngIf\u003d\"questionDetails.distributePointsFor \u003d\u003d\u003d FeedbackConstantSumDistributePointsType.DISTRIBUTE_ALL_UNEVENLY \u0026\u0026 !isAllPointsUneven\" class\u003d\"text-danger\"\u003e\u003cspan class\u003d\"fa fa-times\"\u003e\u003c/span\u003e"},{"lineNumber":33,"author":{"gitId":"-"},"content":"      Multiple options are given same points!\u003c/p\u003e"},{"lineNumber":34,"author":{"gitId":"-"},"content":""},{"lineNumber":35,"author":{"gitId":"-"},"content":"    \u003cp *ngIf\u003d\"questionDetails.distributePointsFor \u003d\u003d\u003d FeedbackConstantSumDistributePointsType.DISTRIBUTE_ALL_UNEVENLY \u0026\u0026 isAllPointsUneven\" class\u003d\"text-success\"\u003e\u003cspan class\u003d\"fa fa-check\"\u003e\u003c/span\u003e"},{"lineNumber":36,"author":{"gitId":"-"},"content":"      All allocated points are different!\u003c/p\u003e"},{"lineNumber":37,"author":{"gitId":"-"},"content":""},{"lineNumber":38,"author":{"gitId":"-"},"content":"    \u003cp *ngIf\u003d\"questionDetails.distributePointsFor \u003d\u003d\u003d FeedbackConstantSumDistributePointsType.DISTRIBUTE_SOME_UNEVENLY \u0026\u0026 !isSomePointsUneven\" class\u003d\"text-danger\"\u003e\u003cspan class\u003d\"fa fa-times\"\u003e\u003c/span\u003e"},{"lineNumber":39,"author":{"gitId":"-"},"content":"      All options are given {{ responseDetails.answers[0] }} points. Please allocate different points to at least one option.\u003c/p\u003e"},{"lineNumber":40,"author":{"gitId":"-"},"content":""},{"lineNumber":41,"author":{"gitId":"-"},"content":"    \u003cp *ngIf\u003d\"questionDetails.distributePointsFor \u003d\u003d\u003d FeedbackConstantSumDistributePointsType.DISTRIBUTE_SOME_UNEVENLY \u0026\u0026 isSomePointsUneven\" class\u003d\"text-success\"\u003e\u003cspan class\u003d\"fa fa-check\"\u003e\u003c/span\u003e"},{"lineNumber":42,"author":{"gitId":"-"},"content":"      At least one option has been allocated different number of points.\u003c/p\u003e"},{"lineNumber":43,"author":{"gitId":"-"},"content":"  \u003c/div\u003e"},{"lineNumber":44,"author":{"gitId":"-"},"content":"\u003c/div\u003e"}],"authorContributionMap":{"zhaojj2209":3,"fsgmhoward":2,"-":39}},{"path":"src/web/app/components/question-types/question-edit-answer-form/constsum-options-question-edit-answer-form.component.ts","fileType":"ts","lines":[{"lineNumber":1,"author":{"gitId":"-"},"content":"import { Component } from \u0027@angular/core\u0027;"},{"lineNumber":2,"author":{"gitId":"-"},"content":"import {"},{"lineNumber":3,"author":{"gitId":"-"},"content":"  FeedbackConstantSumDistributePointsType,"},{"lineNumber":4,"author":{"gitId":"-"},"content":"  FeedbackConstantSumQuestionDetails,"},{"lineNumber":5,"author":{"gitId":"-"},"content":"  FeedbackConstantSumResponseDetails,"},{"lineNumber":6,"author":{"gitId":"-"},"content":"} from \u0027../../../../types/api-output\u0027;"},{"lineNumber":7,"author":{"gitId":"-"},"content":"import {"},{"lineNumber":8,"author":{"gitId":"-"},"content":"  DEFAULT_CONSTSUM_OPTIONS_QUESTION_DETAILS,"},{"lineNumber":9,"author":{"gitId":"-"},"content":"  DEFAULT_CONSTSUM_RESPONSE_DETAILS,"},{"lineNumber":10,"author":{"gitId":"-"},"content":"} from \u0027../../../../types/default-question-structs\u0027;"},{"lineNumber":11,"author":{"gitId":"-"},"content":"import { QuestionEditAnswerFormComponent } from \u0027./question-edit-answer-form\u0027;"},{"lineNumber":12,"author":{"gitId":"-"},"content":""},{"lineNumber":13,"author":{"gitId":"-"},"content":"/**"},{"lineNumber":14,"author":{"gitId":"-"},"content":" * The constsum question options submission form for a recipient."},{"lineNumber":15,"author":{"gitId":"-"},"content":" */"},{"lineNumber":16,"author":{"gitId":"-"},"content":"@Component({"},{"lineNumber":17,"author":{"gitId":"-"},"content":"  selector: \u0027tm-constsum-options-question-edit-answer-form\u0027,"},{"lineNumber":18,"author":{"gitId":"-"},"content":"  templateUrl: \u0027./constsum-options-question-edit-answer-form.component.html\u0027,"},{"lineNumber":19,"author":{"gitId":"-"},"content":"  styleUrls: [\u0027./constsum-options-question-edit-answer-form.component.scss\u0027],"},{"lineNumber":20,"author":{"gitId":"-"},"content":"})"},{"lineNumber":21,"author":{"gitId":"-"},"content":"export class ConstsumOptionsQuestionEditAnswerFormComponent"},{"lineNumber":22,"author":{"gitId":"-"},"content":"    extends QuestionEditAnswerFormComponent\u003cFeedbackConstantSumQuestionDetails, FeedbackConstantSumResponseDetails\u003e {"},{"lineNumber":23,"author":{"gitId":"-"},"content":""},{"lineNumber":24,"author":{"gitId":"-"},"content":"  // enum"},{"lineNumber":25,"author":{"gitId":"-"},"content":"  FeedbackConstantSumDistributePointsType: typeof FeedbackConstantSumDistributePointsType \u003d"},{"lineNumber":26,"author":{"gitId":"-"},"content":"      FeedbackConstantSumDistributePointsType;"},{"lineNumber":27,"author":{"gitId":"-"},"content":""},{"lineNumber":28,"author":{"gitId":"-"},"content":"  constructor() {"},{"lineNumber":29,"author":{"gitId":"-"},"content":"    super(DEFAULT_CONSTSUM_OPTIONS_QUESTION_DETAILS(), DEFAULT_CONSTSUM_RESPONSE_DETAILS());"},{"lineNumber":30,"author":{"gitId":"-"},"content":"  }"},{"lineNumber":31,"author":{"gitId":"-"},"content":""},{"lineNumber":32,"author":{"gitId":"-"},"content":"  /**"},{"lineNumber":33,"author":{"gitId":"-"},"content":"   * Assigns a point to the option specified by index."},{"lineNumber":34,"author":{"gitId":"-"},"content":"   */"},{"lineNumber":35,"author":{"gitId":"-"},"content":"  triggerResponse(index: number, event: number): void {"},{"lineNumber":36,"author":{"gitId":"-"},"content":"    let newAnswers: number[] \u003d this.responseDetails.answers.slice();"},{"lineNumber":37,"author":{"gitId":"-"},"content":""},{"lineNumber":38,"author":{"gitId":"-"},"content":"    if (newAnswers.length !\u003d\u003d this.questionDetails.constSumOptions.length) {"},{"lineNumber":39,"author":{"gitId":"-"},"content":"      // initialize answers array on the fly"},{"lineNumber":40,"author":{"gitId":"-"},"content":"      newAnswers \u003d Array(this.questionDetails.constSumOptions.length).fill(0);"},{"lineNumber":41,"author":{"gitId":"-"},"content":"    }"},{"lineNumber":42,"author":{"gitId":"-"},"content":""},{"lineNumber":43,"author":{"gitId":"-"},"content":"    newAnswers[index] \u003d event ? Math.ceil(event) : 0;"},{"lineNumber":44,"author":{"gitId":"-"},"content":"    this.triggerResponseDetailsChange(\u0027answers\u0027, newAnswers);"},{"lineNumber":45,"author":{"gitId":"-"},"content":"  }"},{"lineNumber":46,"author":{"gitId":"-"},"content":""},{"lineNumber":47,"author":{"gitId":"-"},"content":"  /**"},{"lineNumber":48,"author":{"gitId":"-"},"content":"   * Gets total required points."},{"lineNumber":49,"author":{"gitId":"-"},"content":"   */"},{"lineNumber":50,"author":{"gitId":"-"},"content":"  get totalRequiredPoints(): number {"},{"lineNumber":51,"author":{"gitId":"-"},"content":"    if (this.questionDetails.pointsPerOption) {"},{"lineNumber":52,"author":{"gitId":"-"},"content":"      return this.questionDetails.points * this.questionDetails.constSumOptions.length;"},{"lineNumber":53,"author":{"gitId":"-"},"content":"    }"},{"lineNumber":54,"author":{"gitId":"-"},"content":"    return this.questionDetails.points;"},{"lineNumber":55,"author":{"gitId":"-"},"content":"  }"},{"lineNumber":56,"author":{"gitId":"-"},"content":""},{"lineNumber":57,"author":{"gitId":"-"},"content":"  /**"},{"lineNumber":58,"author":{"gitId":"-"},"content":"   * Gets total answer points."},{"lineNumber":59,"author":{"gitId":"-"},"content":"   */"},{"lineNumber":60,"author":{"gitId":"-"},"content":"  get totalAnsweredPoints(): number {"},{"lineNumber":61,"author":{"gitId":"-"},"content":"    return this.responseDetails.answers.reduce((total: number, curr: number) \u003d\u003e total + curr, 0);"},{"lineNumber":62,"author":{"gitId":"-"},"content":"  }"},{"lineNumber":63,"author":{"gitId":"-"},"content":""},{"lineNumber":64,"author":{"gitId":"-"},"content":"  /**"},{"lineNumber":65,"author":{"gitId":"-"},"content":"   * Checks if all points are distributed unevenly."},{"lineNumber":66,"author":{"gitId":"-"},"content":"   */"},{"lineNumber":67,"author":{"gitId":"-"},"content":"  get isAllPointsUneven(): boolean {"},{"lineNumber":68,"author":{"gitId":"-"},"content":"    const set: Set\u003cnumber\u003e \u003d new Set();"},{"lineNumber":69,"author":{"gitId":"-"},"content":"    this.responseDetails.answers.forEach((ans: number) \u003d\u003e set.add(ans));"},{"lineNumber":70,"author":{"gitId":"-"},"content":""},{"lineNumber":71,"author":{"gitId":"-"},"content":"    return set.size \u003d\u003d\u003d this.responseDetails.answers.length;"},{"lineNumber":72,"author":{"gitId":"-"},"content":"  }"},{"lineNumber":73,"author":{"gitId":"-"},"content":""},{"lineNumber":74,"author":{"gitId":"-"},"content":"  /**"},{"lineNumber":75,"author":{"gitId":"-"},"content":"   * Checks if some points are distributed unevenly."},{"lineNumber":76,"author":{"gitId":"-"},"content":"   */"},{"lineNumber":77,"author":{"gitId":"-"},"content":"  get isSomePointsUneven(): boolean {"},{"lineNumber":78,"author":{"gitId":"-"},"content":"    if (this.responseDetails.answers.length \u003d\u003d\u003d 1) {"},{"lineNumber":79,"author":{"gitId":"-"},"content":"      return true;"},{"lineNumber":80,"author":{"gitId":"-"},"content":"    }"},{"lineNumber":81,"author":{"gitId":"-"},"content":""},{"lineNumber":82,"author":{"gitId":"-"},"content":"    const set: Set\u003cnumber\u003e \u003d new Set();"},{"lineNumber":83,"author":{"gitId":"-"},"content":"    this.responseDetails.answers.forEach((ans: number) \u003d\u003e set.add(ans));"},{"lineNumber":84,"author":{"gitId":"-"},"content":""},{"lineNumber":85,"author":{"gitId":"-"},"content":"    return set.size !\u003d\u003d 1;"},{"lineNumber":86,"author":{"gitId":"-"},"content":"  }"},{"lineNumber":87,"author":{"gitId":"-"},"content":""},{"lineNumber":88,"author":{"gitId":"zhaojj2209"},"content":"  /**"},{"lineNumber":89,"author":{"gitId":"zhaojj2209"},"content":"   * Checks if any of the points are negative."},{"lineNumber":90,"author":{"gitId":"zhaojj2209"},"content":"   */"},{"lineNumber":91,"author":{"gitId":"zhaojj2209"},"content":"  get isAnyPointsNegative(): boolean {"},{"lineNumber":92,"author":{"gitId":"zhaojj2209"},"content":"    return this.responseDetails.answers.reduce((isNegative: boolean, curr: number) \u003d\u003e isNegative || (curr \u003c 0), false);"},{"lineNumber":93,"author":{"gitId":"zhaojj2209"},"content":"  }"},{"lineNumber":94,"author":{"gitId":"zhaojj2209"},"content":""},{"lineNumber":95,"author":{"gitId":"-"},"content":"}"}],"authorContributionMap":{"zhaojj2209":7,"-":88}},{"path":"src/web/app/components/question-types/question-edit-answer-form/constsum-recipients-question-edit-answer-form.component.html","fileType":"html","lines":[{"lineNumber":1,"author":{"gitId":"fsgmhoward"},"content":"\u003cdiv\u003e"},{"lineNumber":2,"author":{"gitId":"fsgmhoward"},"content":"  \u003cdiv class\u003d\"form-group\"\u003e"},{"lineNumber":3,"author":{"gitId":"-"},"content":"      \u003cinput type\u003d\"number\" class\u003d\"form-control\""},{"lineNumber":4,"author":{"gitId":"-"},"content":"             [ngModel]\u003d\"responseDetails.answers.length \u003d\u003d 1 ? responseDetails.answers[0] : \u0027\u0027\""},{"lineNumber":5,"author":{"gitId":"-"},"content":"             (ngModelChange)\u003d\"triggerResponse($event)\""},{"lineNumber":6,"author":{"gitId":"-"},"content":"             [disabled]\u003d\"isDisabled\""},{"lineNumber":7,"author":{"gitId":"-"},"content":"             min\u003d\"0\" step\u003d\"1\"\u003e"},{"lineNumber":8,"author":{"gitId":"-"},"content":"  \u003c/div\u003e"},{"lineNumber":9,"author":{"gitId":"-"},"content":"\u003c/div\u003e"}],"authorContributionMap":{"fsgmhoward":2,"-":7}},{"path":"src/web/app/components/question-types/question-edit-answer-form/rank-options-question-edit-answer-form.component.html","fileType":"html","lines":[{"lineNumber":1,"author":{"gitId":"-"},"content":"\u003cdiv class\u003d\"form-group row text-left\" *ngFor\u003d\"let num of questionDetails.options; let i \u003d index;\"\u003e"},{"lineNumber":2,"author":{"gitId":"fsgmhoward"},"content":"  \u003cdiv class\u003d\"col-md-5 col-xs-12 text-md-right col-form-label\"\u003e"},{"lineNumber":3,"author":{"gitId":"-"},"content":"    \u003cstrong\u003e{{ questionDetails.options[i] }}\u003c/strong\u003e"},{"lineNumber":4,"author":{"gitId":"-"},"content":"  \u003c/div\u003e"},{"lineNumber":5,"author":{"gitId":"fsgmhoward"},"content":"  \u003cdiv class\u003d\"col-md-7 col-xs-12 text-md-left\"\u003e"},{"lineNumber":6,"author":{"gitId":"-"},"content":"    \u003cselect class\u003d\"form-control\" [ngModel]\u003d\"responseDetails.answers[i]\""},{"lineNumber":7,"author":{"gitId":"-"},"content":"            (ngModelChange)\u003d\"triggerResponse(i, $event)\" [disabled]\u003d\"isDisabled\"\u003e"},{"lineNumber":8,"author":{"gitId":"-"},"content":"      \u003coption [ngValue]\u003d\"RANK_OPTIONS_ANSWER_NOT_SUBMITTED\"\u003e\u003c/option\u003e"},{"lineNumber":9,"author":{"gitId":"-"},"content":"      \u003coption *ngFor\u003d\"let rank of ranksToBeAssigned\" [ngValue]\u003d\"rank\"\u003e{{ rank }}\u003c/option\u003e"},{"lineNumber":10,"author":{"gitId":"-"},"content":"    \u003c/select\u003e"},{"lineNumber":11,"author":{"gitId":"-"},"content":"  \u003c/div\u003e"},{"lineNumber":12,"author":{"gitId":"-"},"content":"\u003c/div\u003e"},{"lineNumber":13,"author":{"gitId":"-"},"content":""},{"lineNumber":14,"author":{"gitId":"fsgmhoward"},"content":"\u003cdiv\u003e"},{"lineNumber":15,"author":{"gitId":"fsgmhoward"},"content":"  \u003cp *ngIf\u003d\"!questionDetails.areDuplicatesAllowed \u0026\u0026 isSameRanksAssigned\" class\u003d\"text-danger\"\u003e\u003cspan class\u003d\"fa fa-times\"\u003e\u003c/span\u003e"},{"lineNumber":16,"author":{"gitId":"fsgmhoward"},"content":"    The same rank should not be given multiple times.\u003c/p\u003e"},{"lineNumber":17,"author":{"gitId":"fsgmhoward"},"content":"  \u003cp *ngIf\u003d\"isNoOptionRanked\" class\u003d\"text-info\"\u003e\u003cspan class\u003d\"fa fa-info-circle\"\u003e\u003c/span\u003e"},{"lineNumber":18,"author":{"gitId":"fsgmhoward"},"content":"    Please rank the above options.\u003c/p\u003e"},{"lineNumber":19,"author":{"gitId":"fsgmhoward"},"content":"  \u003cp *ngIf\u003d\"isMinOptionsEnabled \u0026\u0026 isOptionsRankedLessThanMin\" class\u003d\"text-danger\"\u003e\u003cspan class\u003d\"fa fa-times\"\u003e\u003c/span\u003e"},{"lineNumber":20,"author":{"gitId":"fsgmhoward"},"content":"    You need to rank at least {{ questionDetails.minOptionsToBeRanked }} options.\u003c/p\u003e"},{"lineNumber":21,"author":{"gitId":"fsgmhoward"},"content":"  \u003cp *ngIf\u003d\"isMaxOptionsEnabled \u0026\u0026 isOptionsRankedMoreThanMax\" class\u003d\"text-danger\"\u003e\u003cspan class\u003d\"fa fa-times\"\u003e\u003c/span\u003e"},{"lineNumber":22,"author":{"gitId":"fsgmhoward"},"content":"    Rank no more than {{questionDetails.maxOptionsToBeRanked}} options.\u003c/p\u003e"},{"lineNumber":23,"author":{"gitId":"-"},"content":"\u003c/div\u003e"}],"authorContributionMap":{"fsgmhoward":11,"-":12}},{"path":"src/web/app/components/question-types/question-edit-answer-form/rank-recipients-question-edit-answer-form.component.html","fileType":"html","lines":[{"lineNumber":1,"author":{"gitId":"fsgmhoward"},"content":"\u003cdiv class\u003d\"margin-bottom-15px\"\u003e"},{"lineNumber":2,"author":{"gitId":"-"},"content":"  \u003cselect class\u003d\"form-control\" [ngModel]\u003d\"responseDetails.answer\""},{"lineNumber":3,"author":{"gitId":"-"},"content":"          (ngModelChange)\u003d\"triggerResponseDetailsChange(\u0027answer\u0027, $event)\" [disabled]\u003d\"isDisabled\"\u003e"},{"lineNumber":4,"author":{"gitId":"-"},"content":"    \u003coption [ngValue]\u003d\"RANK_RECIPIENTS_ANSWER_NOT_SUBMITTED\"\u003e\u003c/option\u003e"},{"lineNumber":5,"author":{"gitId":"-"},"content":"    \u003coption *ngFor\u003d\"let rank of ranksToBeAssigned\" [ngValue]\u003d\"rank\"\u003e{{ rank }}\u003c/option\u003e"},{"lineNumber":6,"author":{"gitId":"-"},"content":"  \u003c/select\u003e"},{"lineNumber":7,"author":{"gitId":"-"},"content":"\u003c/div\u003e"}],"authorContributionMap":{"fsgmhoward":1,"-":6}},{"path":"src/web/app/pages-session/session-submission-page/session-submission-page.component.spec.ts","fileType":"ts","lines":[{"lineNumber":1,"author":{"gitId":"-"},"content":"import { HttpClientTestingModule } from \u0027@angular/common/http/testing\u0027;"},{"lineNumber":2,"author":{"gitId":"-"},"content":"import { async, ComponentFixture, TestBed } from \u0027@angular/core/testing\u0027;"},{"lineNumber":3,"author":{"gitId":"-"},"content":"import { FormsModule } from \u0027@angular/forms\u0027;"},{"lineNumber":4,"author":{"gitId":"-"},"content":"import { ActivatedRoute } from \u0027@angular/router\u0027;"},{"lineNumber":5,"author":{"gitId":"-"},"content":"import { RouterTestingModule } from \u0027@angular/router/testing\u0027;"},{"lineNumber":6,"author":{"gitId":"-"},"content":"import { NgbModal } from \u0027@ng-bootstrap/ng-bootstrap\u0027;"},{"lineNumber":7,"author":{"gitId":"-"},"content":"import { NgxPageScrollCoreModule } from \u0027ngx-page-scroll-core\u0027;"},{"lineNumber":8,"author":{"gitId":"-"},"content":"import { of, throwError } from \u0027rxjs\u0027;"},{"lineNumber":9,"author":{"gitId":"-"},"content":"import { environment } from \u0027../../../environments/environment\u0027;"},{"lineNumber":10,"author":{"gitId":"-"},"content":"import { AuthService } from \u0027../../../services/auth.service\u0027;"},{"lineNumber":11,"author":{"gitId":"-"},"content":"import { FeedbackQuestionsService } from \u0027../../../services/feedback-questions.service\u0027;"},{"lineNumber":12,"author":{"gitId":"-"},"content":"import { FeedbackResponseCommentService } from \u0027../../../services/feedback-response-comment.service\u0027;"},{"lineNumber":13,"author":{"gitId":"-"},"content":"import { FeedbackResponsesService } from \u0027../../../services/feedback-responses.service\u0027;"},{"lineNumber":14,"author":{"gitId":"-"},"content":"import { FeedbackSessionsService } from \u0027../../../services/feedback-sessions.service\u0027;"},{"lineNumber":15,"author":{"gitId":"-"},"content":"import { InstructorService } from \u0027../../../services/instructor.service\u0027;"},{"lineNumber":16,"author":{"gitId":"-"},"content":"import { NavigationService } from \u0027../../../services/navigation.service\u0027;"},{"lineNumber":17,"author":{"gitId":"-"},"content":"import { SimpleModalService } from \u0027../../../services/simple-modal.service\u0027;"},{"lineNumber":18,"author":{"gitId":"-"},"content":"import { StudentService } from \u0027../../../services/student.service\u0027;"},{"lineNumber":19,"author":{"gitId":"-"},"content":"import {"},{"lineNumber":20,"author":{"gitId":"-"},"content":"  AuthInfo,"},{"lineNumber":21,"author":{"gitId":"-"},"content":"  CommentVisibilityType,"},{"lineNumber":22,"author":{"gitId":"-"},"content":"  FeedbackConstantSumQuestionDetails,"},{"lineNumber":23,"author":{"gitId":"-"},"content":"  FeedbackConstantSumResponseDetails,"},{"lineNumber":24,"author":{"gitId":"-"},"content":"  FeedbackContributionQuestionDetails,"},{"lineNumber":25,"author":{"gitId":"-"},"content":"  FeedbackContributionResponseDetails,"},{"lineNumber":26,"author":{"gitId":"-"},"content":"  FeedbackMcqQuestionDetails,"},{"lineNumber":27,"author":{"gitId":"-"},"content":"  FeedbackMcqResponseDetails,"},{"lineNumber":28,"author":{"gitId":"-"},"content":"  FeedbackMsqQuestionDetails,"},{"lineNumber":29,"author":{"gitId":"-"},"content":"  FeedbackMsqResponseDetails,"},{"lineNumber":30,"author":{"gitId":"-"},"content":"  FeedbackNumericalScaleQuestionDetails,"},{"lineNumber":31,"author":{"gitId":"-"},"content":"  FeedbackNumericalScaleResponseDetails,"},{"lineNumber":32,"author":{"gitId":"-"},"content":"  FeedbackParticipantType,"},{"lineNumber":33,"author":{"gitId":"-"},"content":"  FeedbackQuestionRecipients,"},{"lineNumber":34,"author":{"gitId":"-"},"content":"  FeedbackQuestions,"},{"lineNumber":35,"author":{"gitId":"-"},"content":"  FeedbackQuestionType,"},{"lineNumber":36,"author":{"gitId":"-"},"content":"  FeedbackRankOptionsQuestionDetails,"},{"lineNumber":37,"author":{"gitId":"-"},"content":"  FeedbackRankOptionsResponseDetails,"},{"lineNumber":38,"author":{"gitId":"-"},"content":"  FeedbackRankRecipientsQuestionDetails,"},{"lineNumber":39,"author":{"gitId":"-"},"content":"  FeedbackResponse,"},{"lineNumber":40,"author":{"gitId":"-"},"content":"  FeedbackResponseComment,"},{"lineNumber":41,"author":{"gitId":"-"},"content":"  FeedbackResponses,"},{"lineNumber":42,"author":{"gitId":"-"},"content":"  FeedbackRubricQuestionDetails,"},{"lineNumber":43,"author":{"gitId":"-"},"content":"  FeedbackRubricResponseDetails,"},{"lineNumber":44,"author":{"gitId":"-"},"content":"  FeedbackSession,"},{"lineNumber":45,"author":{"gitId":"-"},"content":"  FeedbackSessionPublishStatus,"},{"lineNumber":46,"author":{"gitId":"-"},"content":"  FeedbackSessionSubmissionStatus,"},{"lineNumber":47,"author":{"gitId":"-"},"content":"  FeedbackTextQuestionDetails,"},{"lineNumber":48,"author":{"gitId":"-"},"content":"  FeedbackTextResponseDetails,"},{"lineNumber":49,"author":{"gitId":"-"},"content":"  FeedbackVisibilityType,"},{"lineNumber":50,"author":{"gitId":"-"},"content":"  Instructor,"},{"lineNumber":51,"author":{"gitId":"-"},"content":"  JoinState,"},{"lineNumber":52,"author":{"gitId":"-"},"content":"  NumberOfEntitiesToGiveFeedbackToSetting,"},{"lineNumber":53,"author":{"gitId":"-"},"content":"  RegkeyValidity,"},{"lineNumber":54,"author":{"gitId":"-"},"content":"  ResponseVisibleSetting,"},{"lineNumber":55,"author":{"gitId":"-"},"content":"  SessionVisibleSetting,"},{"lineNumber":56,"author":{"gitId":"-"},"content":"  Student,"},{"lineNumber":57,"author":{"gitId":"-"},"content":"} from \u0027../../../types/api-output\u0027;"},{"lineNumber":58,"author":{"gitId":"-"},"content":"import { Intent } from \u0027../../../types/api-request\u0027;"},{"lineNumber":59,"author":{"gitId":"-"},"content":"import { AjaxLoadingModule } from \u0027../../components/ajax-loading/ajax-loading.module\u0027;"},{"lineNumber":60,"author":{"gitId":"-"},"content":"import { LoadingRetryModule } from \u0027../../components/loading-retry/loading-retry.module\u0027;"},{"lineNumber":61,"author":{"gitId":"-"},"content":"import { LoadingSpinnerModule } from \u0027../../components/loading-spinner/loading-spinner.module\u0027;"},{"lineNumber":62,"author":{"gitId":"-"},"content":"import {"},{"lineNumber":63,"author":{"gitId":"-"},"content":"  FeedbackResponseRecipientSubmissionFormModel,"},{"lineNumber":64,"author":{"gitId":"-"},"content":"  QuestionSubmissionFormModel,"},{"lineNumber":65,"author":{"gitId":"-"},"content":"} from \u0027../../components/question-submission-form/question-submission-form-model\u0027;"},{"lineNumber":66,"author":{"gitId":"-"},"content":"import {"},{"lineNumber":67,"author":{"gitId":"-"},"content":"  QuestionSubmissionFormModule,"},{"lineNumber":68,"author":{"gitId":"-"},"content":"} from \u0027../../components/question-submission-form/question-submission-form.module\u0027;"},{"lineNumber":69,"author":{"gitId":"-"},"content":"import { TeammatesCommonModule } from \u0027../../components/teammates-common/teammates-common.module\u0027;"},{"lineNumber":70,"author":{"gitId":"-"},"content":"import { SavingCompleteModalComponent } from \u0027./saving-complete-modal/saving-complete-modal.component\u0027;"},{"lineNumber":71,"author":{"gitId":"-"},"content":"import { SessionSubmissionPageComponent } from \u0027./session-submission-page.component\u0027;"},{"lineNumber":72,"author":{"gitId":"-"},"content":"import Spy \u003d jasmine.Spy;"},{"lineNumber":73,"author":{"gitId":"-"},"content":""},{"lineNumber":74,"author":{"gitId":"-"},"content":"describe(\u0027SessionSubmissionPageComponent\u0027, () \u003d\u003e {"},{"lineNumber":75,"author":{"gitId":"-"},"content":"  const deepCopy: \u003cT\u003e(obj: T) \u003d\u003e T \u003d \u003cT\u003e(obj: T) \u003d\u003e JSON.parse(JSON.stringify(obj));"},{"lineNumber":76,"author":{"gitId":"-"},"content":""},{"lineNumber":77,"author":{"gitId":"-"},"content":"  const testStudent: Student \u003d {"},{"lineNumber":78,"author":{"gitId":"-"},"content":"    email: \u0027alice@tmms.com\u0027,"},{"lineNumber":79,"author":{"gitId":"-"},"content":"    courseId: \u0027course-id\u0027,"},{"lineNumber":80,"author":{"gitId":"-"},"content":"    name: \u0027Alice Betsy\u0027,"},{"lineNumber":81,"author":{"gitId":"-"},"content":"    teamName: \u0027Team 1\u0027,"},{"lineNumber":82,"author":{"gitId":"-"},"content":"    sectionName: \u0027Section 1\u0027,"},{"lineNumber":83,"author":{"gitId":"-"},"content":"  };"},{"lineNumber":84,"author":{"gitId":"-"},"content":""},{"lineNumber":85,"author":{"gitId":"-"},"content":"  const testInstructor: Instructor \u003d {"},{"lineNumber":86,"author":{"gitId":"-"},"content":"    courseId: \u0027course-id\u0027,"},{"lineNumber":87,"author":{"gitId":"-"},"content":"    email: \u0027test@example.com\u0027,"},{"lineNumber":88,"author":{"gitId":"-"},"content":"    name: \u0027Instructor Ho\u0027,"},{"lineNumber":89,"author":{"gitId":"-"},"content":"    joinState: JoinState.JOINED,"},{"lineNumber":90,"author":{"gitId":"-"},"content":"  };"},{"lineNumber":91,"author":{"gitId":"-"},"content":""},{"lineNumber":92,"author":{"gitId":"-"},"content":"  const testOpenFeedbackSession: FeedbackSession \u003d {"},{"lineNumber":93,"author":{"gitId":"-"},"content":"    feedbackSessionName: \u0027First Session\u0027,"},{"lineNumber":94,"author":{"gitId":"-"},"content":"    courseId: \u0027CS1231\u0027,"},{"lineNumber":95,"author":{"gitId":"-"},"content":"    timeZone: \u0027Asia/Singapore\u0027,"},{"lineNumber":96,"author":{"gitId":"-"},"content":"    instructions: \u0027Instructions\u0027,"},{"lineNumber":97,"author":{"gitId":"-"},"content":"    submissionStartTimestamp: 1000000000000,"},{"lineNumber":98,"author":{"gitId":"-"},"content":"    submissionEndTimestamp: Date.now() + 10 * 60 * 1000,  // 10 minutes before closing"},{"lineNumber":99,"author":{"gitId":"-"},"content":"    gracePeriod: 0,"},{"lineNumber":100,"author":{"gitId":"-"},"content":"    sessionVisibleSetting: SessionVisibleSetting.AT_OPEN,"},{"lineNumber":101,"author":{"gitId":"-"},"content":"    responseVisibleSetting: ResponseVisibleSetting.AT_VISIBLE,"},{"lineNumber":102,"author":{"gitId":"-"},"content":"    submissionStatus: FeedbackSessionSubmissionStatus.OPEN,"},{"lineNumber":103,"author":{"gitId":"-"},"content":"    publishStatus: FeedbackSessionPublishStatus.PUBLISHED,"},{"lineNumber":104,"author":{"gitId":"-"},"content":"    isClosingEmailEnabled: true,"},{"lineNumber":105,"author":{"gitId":"-"},"content":"    isPublishedEmailEnabled: true,"},{"lineNumber":106,"author":{"gitId":"-"},"content":"    createdAtTimestamp: 0,"},{"lineNumber":107,"author":{"gitId":"-"},"content":"  };"},{"lineNumber":108,"author":{"gitId":"-"},"content":""},{"lineNumber":109,"author":{"gitId":"-"},"content":"  const testComment: FeedbackResponseComment \u003d {"},{"lineNumber":110,"author":{"gitId":"-"},"content":"    commentGiver: \u0027comment giver\u0027,"},{"lineNumber":111,"author":{"gitId":"-"},"content":"    lastEditorEmail: \u0027last-editor@email.com\u0027,"},{"lineNumber":112,"author":{"gitId":"-"},"content":"    feedbackResponseCommentId: 1,"},{"lineNumber":113,"author":{"gitId":"-"},"content":"    commentText: \u0027comment text\u0027,"},{"lineNumber":114,"author":{"gitId":"-"},"content":"    createdAt: 10000000,"},{"lineNumber":115,"author":{"gitId":"-"},"content":"    lastEditedAt: 20000000,"},{"lineNumber":116,"author":{"gitId":"-"},"content":"    isVisibilityFollowingFeedbackQuestion: true,"},{"lineNumber":117,"author":{"gitId":"-"},"content":"    showCommentTo: [CommentVisibilityType.GIVER, CommentVisibilityType.RECIPIENT],"},{"lineNumber":118,"author":{"gitId":"-"},"content":"    showGiverNameTo: [CommentVisibilityType.GIVER, CommentVisibilityType.RECIPIENT],"},{"lineNumber":119,"author":{"gitId":"-"},"content":"  };"},{"lineNumber":120,"author":{"gitId":"-"},"content":""},{"lineNumber":121,"author":{"gitId":"-"},"content":"  const testMcqRecipientSubmissionForm: FeedbackResponseRecipientSubmissionFormModel \u003d {"},{"lineNumber":122,"author":{"gitId":"-"},"content":"    responseId: \u0027response-id-1\u0027,"},{"lineNumber":123,"author":{"gitId":"-"},"content":"    recipientIdentifier: \u0027barry-harris-id\u0027,"},{"lineNumber":124,"author":{"gitId":"-"},"content":"    responseDetails: {"},{"lineNumber":125,"author":{"gitId":"-"},"content":"      answer: \u0027answer\u0027,"},{"lineNumber":126,"author":{"gitId":"-"},"content":"      questionType: FeedbackQuestionType.MCQ,"},{"lineNumber":127,"author":{"gitId":"-"},"content":"    } as FeedbackMcqResponseDetails,"},{"lineNumber":128,"author":{"gitId":"-"},"content":"    isValid: true,"},{"lineNumber":129,"author":{"gitId":"-"},"content":"    commentByGiver: {"},{"lineNumber":130,"author":{"gitId":"-"},"content":"      originalComment: testComment,"},{"lineNumber":131,"author":{"gitId":"-"},"content":"      commentEditFormModel: {"},{"lineNumber":132,"author":{"gitId":"-"},"content":"        commentText: \u0027comment text here\u0027,"},{"lineNumber":133,"author":{"gitId":"-"},"content":"        isUsingCustomVisibilities: false,"},{"lineNumber":134,"author":{"gitId":"-"},"content":"        showCommentTo: [CommentVisibilityType.GIVER, CommentVisibilityType.RECIPIENT],"},{"lineNumber":135,"author":{"gitId":"-"},"content":"        showGiverNameTo: [CommentVisibilityType.GIVER, CommentVisibilityType.RECIPIENT],"},{"lineNumber":136,"author":{"gitId":"-"},"content":"      },"},{"lineNumber":137,"author":{"gitId":"-"},"content":"      isEditing: false,"},{"lineNumber":138,"author":{"gitId":"-"},"content":"    },"},{"lineNumber":139,"author":{"gitId":"-"},"content":"  };"},{"lineNumber":140,"author":{"gitId":"-"},"content":""},{"lineNumber":141,"author":{"gitId":"-"},"content":"  const testMcqRecipientSubmissionForm2: FeedbackResponseRecipientSubmissionFormModel \u003d {"},{"lineNumber":142,"author":{"gitId":"-"},"content":"    responseId: \u0027response-id-2\u0027,"},{"lineNumber":143,"author":{"gitId":"-"},"content":"    recipientIdentifier: \u0027recipient-identifier\u0027,"},{"lineNumber":144,"author":{"gitId":"-"},"content":"    responseDetails: {"},{"lineNumber":145,"author":{"gitId":"-"},"content":"      answer: \u0027answer\u0027,"},{"lineNumber":146,"author":{"gitId":"-"},"content":"      questionType: FeedbackQuestionType.MCQ,"},{"lineNumber":147,"author":{"gitId":"-"},"content":"    } as FeedbackMcqResponseDetails,"},{"lineNumber":148,"author":{"gitId":"-"},"content":"    isValid: true,"},{"lineNumber":149,"author":{"gitId":"-"},"content":"    commentByGiver: {"},{"lineNumber":150,"author":{"gitId":"-"},"content":"      originalComment: testComment,"},{"lineNumber":151,"author":{"gitId":"-"},"content":"      commentEditFormModel: {"},{"lineNumber":152,"author":{"gitId":"-"},"content":"        commentText: \u0027\u0027,"},{"lineNumber":153,"author":{"gitId":"-"},"content":"        isUsingCustomVisibilities: false,"},{"lineNumber":154,"author":{"gitId":"-"},"content":"        showCommentTo: [CommentVisibilityType.GIVER, CommentVisibilityType.RECIPIENT],"},{"lineNumber":155,"author":{"gitId":"-"},"content":"        showGiverNameTo: [CommentVisibilityType.GIVER, CommentVisibilityType.RECIPIENT],"},{"lineNumber":156,"author":{"gitId":"-"},"content":"      },"},{"lineNumber":157,"author":{"gitId":"-"},"content":"      isEditing: false,"},{"lineNumber":158,"author":{"gitId":"-"},"content":"    },"},{"lineNumber":159,"author":{"gitId":"-"},"content":"  };"},{"lineNumber":160,"author":{"gitId":"-"},"content":""},{"lineNumber":161,"author":{"gitId":"-"},"content":"  const testTextRecipientSubmissionForm: FeedbackResponseRecipientSubmissionFormModel \u003d {"},{"lineNumber":162,"author":{"gitId":"-"},"content":"    responseId: \u0027response-id-3\u0027,"},{"lineNumber":163,"author":{"gitId":"-"},"content":"    recipientIdentifier: \u0027gene-harris-id\u0027,"},{"lineNumber":164,"author":{"gitId":"-"},"content":"    responseDetails: {"},{"lineNumber":165,"author":{"gitId":"-"},"content":"      answer: \u0027answer\u0027,"},{"lineNumber":166,"author":{"gitId":"-"},"content":"      questionType: FeedbackQuestionType.TEXT,"},{"lineNumber":167,"author":{"gitId":"-"},"content":"    } as FeedbackTextResponseDetails,"},{"lineNumber":168,"author":{"gitId":"-"},"content":"    isValid: true,"},{"lineNumber":169,"author":{"gitId":"-"},"content":"    commentByGiver: {"},{"lineNumber":170,"author":{"gitId":"-"},"content":"      commentEditFormModel: {"},{"lineNumber":171,"author":{"gitId":"-"},"content":"        commentText: \u0027comment text here\u0027,"},{"lineNumber":172,"author":{"gitId":"-"},"content":"        isUsingCustomVisibilities: false,"},{"lineNumber":173,"author":{"gitId":"-"},"content":"        showCommentTo: [CommentVisibilityType.GIVER, CommentVisibilityType.RECIPIENT],"},{"lineNumber":174,"author":{"gitId":"-"},"content":"        showGiverNameTo: [CommentVisibilityType.GIVER, CommentVisibilityType.RECIPIENT],"},{"lineNumber":175,"author":{"gitId":"-"},"content":"      },"},{"lineNumber":176,"author":{"gitId":"-"},"content":"      isEditing: false,"},{"lineNumber":177,"author":{"gitId":"-"},"content":"    },"},{"lineNumber":178,"author":{"gitId":"-"},"content":"  };"},{"lineNumber":179,"author":{"gitId":"-"},"content":""},{"lineNumber":180,"author":{"gitId":"-"},"content":"  const testMcqRecipientSubmissionForm3: FeedbackResponseRecipientSubmissionFormModel \u003d {"},{"lineNumber":181,"author":{"gitId":"-"},"content":"    responseId: \u0027response-id-4\u0027,"},{"lineNumber":182,"author":{"gitId":"-"},"content":"    recipientIdentifier: \u0027barry-harris-id\u0027,"},{"lineNumber":183,"author":{"gitId":"-"},"content":"    responseDetails: {"},{"lineNumber":184,"author":{"gitId":"-"},"content":"      answer: \u0027barry-harris-answer\u0027,"},{"lineNumber":185,"author":{"gitId":"-"},"content":"      questionType: FeedbackQuestionType.MCQ,"},{"lineNumber":186,"author":{"gitId":"-"},"content":"    } as FeedbackMcqResponseDetails,"},{"lineNumber":187,"author":{"gitId":"-"},"content":"    isValid: true,"},{"lineNumber":188,"author":{"gitId":"-"},"content":"  };"},{"lineNumber":189,"author":{"gitId":"-"},"content":""},{"lineNumber":190,"author":{"gitId":"-"},"content":"  const testMcqRecipientSubmissionForm4: FeedbackResponseRecipientSubmissionFormModel \u003d {"},{"lineNumber":191,"author":{"gitId":"-"},"content":"    responseId: \u0027response-id-5\u0027,"},{"lineNumber":192,"author":{"gitId":"-"},"content":"    recipientIdentifier: \u0027gene-harris-id\u0027,"},{"lineNumber":193,"author":{"gitId":"-"},"content":"    responseDetails: {"},{"lineNumber":194,"author":{"gitId":"-"},"content":"      answer: \u0027gene-harris-answer\u0027,"},{"lineNumber":195,"author":{"gitId":"-"},"content":"      questionType: FeedbackQuestionType.MCQ,"},{"lineNumber":196,"author":{"gitId":"-"},"content":"    } as FeedbackMcqResponseDetails,"},{"lineNumber":197,"author":{"gitId":"-"},"content":"    isValid: true,"},{"lineNumber":198,"author":{"gitId":"-"},"content":"  };"},{"lineNumber":199,"author":{"gitId":"-"},"content":""},{"lineNumber":200,"author":{"gitId":"-"},"content":"  const testMsqRecipientSubmissionForm: FeedbackResponseRecipientSubmissionFormModel \u003d {"},{"lineNumber":201,"author":{"gitId":"-"},"content":"    responseId: \u0027response-id-6\u0027,"},{"lineNumber":202,"author":{"gitId":"-"},"content":"    recipientIdentifier: \u0027barry-harris-id\u0027,"},{"lineNumber":203,"author":{"gitId":"-"},"content":"    responseDetails: {"},{"lineNumber":204,"author":{"gitId":"-"},"content":"      answers: [\u0027answer 1\u0027, \u0027answer 2\u0027],"},{"lineNumber":205,"author":{"gitId":"-"},"content":"      isOther: false,"},{"lineNumber":206,"author":{"gitId":"-"},"content":"      otherFieldContent: \u0027other field content\u0027,"},{"lineNumber":207,"author":{"gitId":"-"},"content":"      questionType: FeedbackQuestionType.MSQ,"},{"lineNumber":208,"author":{"gitId":"-"},"content":"    } as FeedbackMsqResponseDetails,"},{"lineNumber":209,"author":{"gitId":"-"},"content":"    isValid: true,"},{"lineNumber":210,"author":{"gitId":"-"},"content":"  };"},{"lineNumber":211,"author":{"gitId":"-"},"content":""},{"lineNumber":212,"author":{"gitId":"-"},"content":"  const testNumscaleRecipientSubmissionForm: FeedbackResponseRecipientSubmissionFormModel \u003d {"},{"lineNumber":213,"author":{"gitId":"-"},"content":"    responseId: \u0027response-id-7\u0027,"},{"lineNumber":214,"author":{"gitId":"-"},"content":"    recipientIdentifier: \u0027barry-harris-id\u0027,"},{"lineNumber":215,"author":{"gitId":"-"},"content":"    responseDetails: {"},{"lineNumber":216,"author":{"gitId":"-"},"content":"      answer: 5,"},{"lineNumber":217,"author":{"gitId":"-"},"content":"    } as FeedbackNumericalScaleResponseDetails,"},{"lineNumber":218,"author":{"gitId":"-"},"content":"    isValid: true,"},{"lineNumber":219,"author":{"gitId":"-"},"content":"  };"},{"lineNumber":220,"author":{"gitId":"-"},"content":""},{"lineNumber":221,"author":{"gitId":"-"},"content":"  const testConstsumRecipientSubmissionForm: FeedbackResponseRecipientSubmissionFormModel \u003d {"},{"lineNumber":222,"author":{"gitId":"-"},"content":"    responseId: \u0027response-id-8\u0027,"},{"lineNumber":223,"author":{"gitId":"-"},"content":"    recipientIdentifier: \u0027barry-harris-id\u0027,"},{"lineNumber":224,"author":{"gitId":"-"},"content":"    responseDetails: {"},{"lineNumber":225,"author":{"gitId":"-"},"content":"      answers: [7, 13],"},{"lineNumber":226,"author":{"gitId":"-"},"content":"    } as FeedbackConstantSumResponseDetails,"},{"lineNumber":227,"author":{"gitId":"-"},"content":"    isValid: true,"},{"lineNumber":228,"author":{"gitId":"-"},"content":"  };"},{"lineNumber":229,"author":{"gitId":"-"},"content":""},{"lineNumber":230,"author":{"gitId":"-"},"content":"  const testContribRecipientSubmissionForm: FeedbackResponseRecipientSubmissionFormModel \u003d {"},{"lineNumber":231,"author":{"gitId":"-"},"content":"    responseId: \u0027response-id-9\u0027,"},{"lineNumber":232,"author":{"gitId":"-"},"content":"    recipientIdentifier: \u0027barry-harris-id\u0027,"},{"lineNumber":233,"author":{"gitId":"-"},"content":"    responseDetails: {"},{"lineNumber":234,"author":{"gitId":"-"},"content":"      answer: 20,"},{"lineNumber":235,"author":{"gitId":"-"},"content":"    } as FeedbackContributionResponseDetails,"},{"lineNumber":236,"author":{"gitId":"-"},"content":"    isValid: true,"},{"lineNumber":237,"author":{"gitId":"-"},"content":"  };"},{"lineNumber":238,"author":{"gitId":"-"},"content":""},{"lineNumber":239,"author":{"gitId":"-"},"content":"  const testRubricRecipientSubmissionForm: FeedbackResponseRecipientSubmissionFormModel \u003d {"},{"lineNumber":240,"author":{"gitId":"-"},"content":"    responseId: \u0027response-id-10\u0027,"},{"lineNumber":241,"author":{"gitId":"-"},"content":"    recipientIdentifier: \u0027barry-harris-id\u0027,"},{"lineNumber":242,"author":{"gitId":"-"},"content":"    responseDetails: {"},{"lineNumber":243,"author":{"gitId":"-"},"content":"      answer: [3, 4],"},{"lineNumber":244,"author":{"gitId":"-"},"content":"    } as FeedbackRubricResponseDetails,"},{"lineNumber":245,"author":{"gitId":"-"},"content":"    isValid: true,"},{"lineNumber":246,"author":{"gitId":"-"},"content":"  };"},{"lineNumber":247,"author":{"gitId":"-"},"content":""},{"lineNumber":248,"author":{"gitId":"-"},"content":"  const testRankOptionsRecipientSubmissionForm: FeedbackResponseRecipientSubmissionFormModel \u003d {"},{"lineNumber":249,"author":{"gitId":"-"},"content":"    responseId: \u0027response-id-11\u0027,"},{"lineNumber":250,"author":{"gitId":"-"},"content":"    recipientIdentifier: \u0027barry-harris-id\u0027,"},{"lineNumber":251,"author":{"gitId":"-"},"content":"    responseDetails: {"},{"lineNumber":252,"author":{"gitId":"-"},"content":"      answers: [2, 1],"},{"lineNumber":253,"author":{"gitId":"-"},"content":"    } as FeedbackRankOptionsResponseDetails,"},{"lineNumber":254,"author":{"gitId":"-"},"content":"    isValid: true,"},{"lineNumber":255,"author":{"gitId":"-"},"content":"  };"},{"lineNumber":256,"author":{"gitId":"-"},"content":""},{"lineNumber":257,"author":{"gitId":"-"},"content":"  const testRankRecipientsRecipientSubmissionForm: FeedbackResponseRecipientSubmissionFormModel \u003d {"},{"lineNumber":258,"author":{"gitId":"-"},"content":"    responseId: \u0027response-id-12\u0027,"},{"lineNumber":259,"author":{"gitId":"-"},"content":"    recipientIdentifier: \u0027barry-harris-id\u0027,"},{"lineNumber":260,"author":{"gitId":"-"},"content":"    responseDetails: {"},{"lineNumber":261,"author":{"gitId":"-"},"content":"      minOptionsToBeRanked: 1,"},{"lineNumber":262,"author":{"gitId":"-"},"content":"      maxOptionsToBeRanked: 2,"},{"lineNumber":263,"author":{"gitId":"-"},"content":"      areDuplicatesAllowed: false,"},{"lineNumber":264,"author":{"gitId":"-"},"content":"    } as FeedbackRankRecipientsQuestionDetails,"},{"lineNumber":265,"author":{"gitId":"-"},"content":"    isValid: true,"},{"lineNumber":266,"author":{"gitId":"-"},"content":"  };"},{"lineNumber":267,"author":{"gitId":"-"},"content":""},{"lineNumber":268,"author":{"gitId":"-"},"content":"  const testResponse1: FeedbackResponse \u003d {"},{"lineNumber":269,"author":{"gitId":"-"},"content":"    feedbackResponseId: \u0027response-id-4\u0027,"},{"lineNumber":270,"author":{"gitId":"-"},"content":"    giverIdentifier: \u0027giver-identifier\u0027,"},{"lineNumber":271,"author":{"gitId":"-"},"content":"    recipientIdentifier: \u0027barry-harris-id\u0027,"},{"lineNumber":272,"author":{"gitId":"-"},"content":"    responseDetails: {"},{"lineNumber":273,"author":{"gitId":"-"},"content":"      answer: \u0027barry-harris-answer\u0027,"},{"lineNumber":274,"author":{"gitId":"-"},"content":"      questionType: FeedbackQuestionType.MCQ,"},{"lineNumber":275,"author":{"gitId":"-"},"content":"    } as FeedbackMcqResponseDetails,"},{"lineNumber":276,"author":{"gitId":"-"},"content":"  };"},{"lineNumber":277,"author":{"gitId":"-"},"content":""},{"lineNumber":278,"author":{"gitId":"-"},"content":"  const testResponse2: FeedbackResponse \u003d {"},{"lineNumber":279,"author":{"gitId":"-"},"content":"    feedbackResponseId: \u0027response-id-5\u0027,"},{"lineNumber":280,"author":{"gitId":"-"},"content":"    giverIdentifier: \u0027giver-identifier\u0027,"},{"lineNumber":281,"author":{"gitId":"-"},"content":"    recipientIdentifier: \u0027gene-harris-id\u0027,"},{"lineNumber":282,"author":{"gitId":"-"},"content":"    responseDetails: {"},{"lineNumber":283,"author":{"gitId":"-"},"content":"      answer: \u0027gene-harris-answer\u0027,"},{"lineNumber":284,"author":{"gitId":"-"},"content":"      questionType: FeedbackQuestionType.MCQ,"},{"lineNumber":285,"author":{"gitId":"-"},"content":"    } as FeedbackMcqResponseDetails,"},{"lineNumber":286,"author":{"gitId":"-"},"content":"  };"},{"lineNumber":287,"author":{"gitId":"-"},"content":""},{"lineNumber":288,"author":{"gitId":"-"},"content":"  const testMcqQuestionSubmissionForm: QuestionSubmissionFormModel \u003d {"},{"lineNumber":289,"author":{"gitId":"-"},"content":"    feedbackQuestionId: \u0027feedback-question-id-mcq\u0027,"},{"lineNumber":290,"author":{"gitId":"-"},"content":"    questionNumber: 1,"},{"lineNumber":291,"author":{"gitId":"-"},"content":"    questionBrief: \u0027question brief\u0027,"},{"lineNumber":292,"author":{"gitId":"-"},"content":"    questionDescription: \u0027question description\u0027,"},{"lineNumber":293,"author":{"gitId":"-"},"content":"    questionType: FeedbackQuestionType.MCQ,"},{"lineNumber":294,"author":{"gitId":"-"},"content":"    questionDetails: {"},{"lineNumber":295,"author":{"gitId":"-"},"content":"      questionType: FeedbackQuestionType.MCQ,"},{"lineNumber":296,"author":{"gitId":"-"},"content":"      questionText: \u0027question text\u0027,"},{"lineNumber":297,"author":{"gitId":"-"},"content":"      mcqChoices: [\u0027choice 1\u0027, \u0027choice 2\u0027, \u0027choice 3\u0027],"},{"lineNumber":298,"author":{"gitId":"-"},"content":"    } as FeedbackMcqQuestionDetails,"},{"lineNumber":299,"author":{"gitId":"-"},"content":"    giverType: FeedbackParticipantType.STUDENTS,"},{"lineNumber":300,"author":{"gitId":"-"},"content":"    recipientType: FeedbackParticipantType.OWN_TEAM,"},{"lineNumber":301,"author":{"gitId":"-"},"content":"    recipientList: [],"},{"lineNumber":302,"author":{"gitId":"-"},"content":"    recipientSubmissionForms: [testMcqRecipientSubmissionForm],"},{"lineNumber":303,"author":{"gitId":"-"},"content":"    numberOfEntitiesToGiveFeedbackToSetting: NumberOfEntitiesToGiveFeedbackToSetting.UNLIMITED,"},{"lineNumber":304,"author":{"gitId":"-"},"content":"    customNumberOfEntitiesToGiveFeedbackTo: 5,"},{"lineNumber":305,"author":{"gitId":"-"},"content":"    showResponsesTo: [FeedbackVisibilityType.STUDENTS, FeedbackVisibilityType.INSTRUCTORS],"},{"lineNumber":306,"author":{"gitId":"-"},"content":"    showGiverNameTo: [],"},{"lineNumber":307,"author":{"gitId":"-"},"content":"    showRecipientNameTo: [],"},{"lineNumber":308,"author":{"gitId":"-"},"content":"  };"},{"lineNumber":309,"author":{"gitId":"-"},"content":""},{"lineNumber":310,"author":{"gitId":"-"},"content":"  const testMcqQuestionSubmissionForm2: QuestionSubmissionFormModel \u003d {"},{"lineNumber":311,"author":{"gitId":"-"},"content":"    feedbackQuestionId: \u0027feedback-question-id-mcq-2\u0027,"},{"lineNumber":312,"author":{"gitId":"-"},"content":"    questionNumber: 2,"},{"lineNumber":313,"author":{"gitId":"-"},"content":"    questionBrief: \u0027question brief\u0027,"},{"lineNumber":314,"author":{"gitId":"-"},"content":"    questionDescription: \u0027question description\u0027,"},{"lineNumber":315,"author":{"gitId":"-"},"content":"    questionType: FeedbackQuestionType.MCQ,"},{"lineNumber":316,"author":{"gitId":"-"},"content":"    questionDetails: {"},{"lineNumber":317,"author":{"gitId":"-"},"content":"      questionType: FeedbackQuestionType.MCQ,"},{"lineNumber":318,"author":{"gitId":"-"},"content":"      questionText: \u0027question text\u0027,"},{"lineNumber":319,"author":{"gitId":"-"},"content":"      mcqChoices: [\u0027choice 1\u0027, \u0027choice 2\u0027, \u0027choice 3\u0027],"},{"lineNumber":320,"author":{"gitId":"-"},"content":"    } as FeedbackMcqQuestionDetails,"},{"lineNumber":321,"author":{"gitId":"-"},"content":"    giverType: FeedbackParticipantType.INSTRUCTORS,"},{"lineNumber":322,"author":{"gitId":"-"},"content":"    recipientType: FeedbackParticipantType.TEAMS,"},{"lineNumber":323,"author":{"gitId":"-"},"content":"    recipientList: ["},{"lineNumber":324,"author":{"gitId":"-"},"content":"      {"},{"lineNumber":325,"author":{"gitId":"-"},"content":"        recipientName: \u0027Barry Harris\u0027,"},{"lineNumber":326,"author":{"gitId":"-"},"content":"        recipientIdentifier: \u0027barry-harris-id\u0027,"},{"lineNumber":327,"author":{"gitId":"-"},"content":"      },"},{"lineNumber":328,"author":{"gitId":"-"},"content":"      {"},{"lineNumber":329,"author":{"gitId":"-"},"content":"        recipientName: \u0027Gene Harris\u0027,"},{"lineNumber":330,"author":{"gitId":"-"},"content":"        recipientIdentifier: \u0027gene-harris-id\u0027,"},{"lineNumber":331,"author":{"gitId":"-"},"content":"      },"},{"lineNumber":332,"author":{"gitId":"-"},"content":"    ],"},{"lineNumber":333,"author":{"gitId":"-"},"content":"    recipientSubmissionForms: [testMcqRecipientSubmissionForm3, testMcqRecipientSubmissionForm4],"},{"lineNumber":334,"author":{"gitId":"-"},"content":"    numberOfEntitiesToGiveFeedbackToSetting: NumberOfEntitiesToGiveFeedbackToSetting.UNLIMITED,"},{"lineNumber":335,"author":{"gitId":"-"},"content":"    customNumberOfEntitiesToGiveFeedbackTo: 5,"},{"lineNumber":336,"author":{"gitId":"-"},"content":"    showResponsesTo: [FeedbackVisibilityType.RECIPIENT, FeedbackVisibilityType.INSTRUCTORS],"},{"lineNumber":337,"author":{"gitId":"-"},"content":"    showGiverNameTo: [FeedbackVisibilityType.RECIPIENT, FeedbackVisibilityType.INSTRUCTORS],"},{"lineNumber":338,"author":{"gitId":"-"},"content":"    showRecipientNameTo: [FeedbackVisibilityType.RECIPIENT, FeedbackVisibilityType.INSTRUCTORS],"},{"lineNumber":339,"author":{"gitId":"-"},"content":"  };"},{"lineNumber":340,"author":{"gitId":"-"},"content":""},{"lineNumber":341,"author":{"gitId":"-"},"content":"  const testTextQuestionSubmissionForm: QuestionSubmissionFormModel \u003d {"},{"lineNumber":342,"author":{"gitId":"-"},"content":"    feedbackQuestionId: \u0027feedback-question-id-text\u0027,"},{"lineNumber":343,"author":{"gitId":"-"},"content":"    questionNumber: 3,"},{"lineNumber":344,"author":{"gitId":"-"},"content":"    questionBrief: \u0027question brief\u0027,"},{"lineNumber":345,"author":{"gitId":"-"},"content":"    questionDescription: \u0027question description\u0027,"},{"lineNumber":346,"author":{"gitId":"-"},"content":"    questionType: FeedbackQuestionType.TEXT,"},{"lineNumber":347,"author":{"gitId":"-"},"content":"    questionDetails: {"},{"lineNumber":348,"author":{"gitId":"-"},"content":"      questionType: FeedbackQuestionType.TEXT,"},{"lineNumber":349,"author":{"gitId":"-"},"content":"      questionText: \u0027question text\u0027,"},{"lineNumber":350,"author":{"gitId":"-"},"content":"    } as FeedbackTextQuestionDetails,"},{"lineNumber":351,"author":{"gitId":"-"},"content":"    giverType: FeedbackParticipantType.STUDENTS,"},{"lineNumber":352,"author":{"gitId":"-"},"content":"    recipientType: FeedbackParticipantType.INSTRUCTORS,"},{"lineNumber":353,"author":{"gitId":"-"},"content":"    recipientList: [],"},{"lineNumber":354,"author":{"gitId":"-"},"content":"    recipientSubmissionForms: [testTextRecipientSubmissionForm],"},{"lineNumber":355,"author":{"gitId":"-"},"content":"    numberOfEntitiesToGiveFeedbackToSetting: NumberOfEntitiesToGiveFeedbackToSetting.UNLIMITED,"},{"lineNumber":356,"author":{"gitId":"-"},"content":"    customNumberOfEntitiesToGiveFeedbackTo: 5,"},{"lineNumber":357,"author":{"gitId":"-"},"content":"    showResponsesTo: [FeedbackVisibilityType.GIVER_TEAM_MEMBERS, FeedbackVisibilityType.INSTRUCTORS],"},{"lineNumber":358,"author":{"gitId":"-"},"content":"    showGiverNameTo: [],"},{"lineNumber":359,"author":{"gitId":"-"},"content":"    showRecipientNameTo: [],"},{"lineNumber":360,"author":{"gitId":"-"},"content":"  };"},{"lineNumber":361,"author":{"gitId":"-"},"content":""},{"lineNumber":362,"author":{"gitId":"-"},"content":"  const testMsqQuestionSubmissionForm: QuestionSubmissionFormModel \u003d {"},{"lineNumber":363,"author":{"gitId":"-"},"content":"    feedbackQuestionId: \u0027feedback-question-id-msq\u0027,"},{"lineNumber":364,"author":{"gitId":"-"},"content":"    questionNumber: 4,"},{"lineNumber":365,"author":{"gitId":"-"},"content":"    questionBrief: \u0027MSQ question\u0027,"},{"lineNumber":366,"author":{"gitId":"-"},"content":"    questionDescription: \u0027question description\u0027,"},{"lineNumber":367,"author":{"gitId":"-"},"content":"    questionType: FeedbackQuestionType.MSQ,"},{"lineNumber":368,"author":{"gitId":"-"},"content":"    questionDetails: {"},{"lineNumber":369,"author":{"gitId":"-"},"content":"      msqChoices: [\u0027first\u0027, \u0027second\u0027 , \u0027third\u0027],"},{"lineNumber":370,"author":{"gitId":"-"},"content":"      otherEnabled: false,"},{"lineNumber":371,"author":{"gitId":"-"},"content":"      hasAssignedWeights: true,"},{"lineNumber":372,"author":{"gitId":"-"},"content":"      msqWeights: [1, 2, 3],"},{"lineNumber":373,"author":{"gitId":"-"},"content":"      maxSelectableChoices: 2,"},{"lineNumber":374,"author":{"gitId":"-"},"content":"      minSelectableChoices: 1,"},{"lineNumber":375,"author":{"gitId":"-"},"content":"    } as FeedbackMsqQuestionDetails,"},{"lineNumber":376,"author":{"gitId":"-"},"content":"    giverType: FeedbackParticipantType.INSTRUCTORS,"},{"lineNumber":377,"author":{"gitId":"-"},"content":"    recipientType: FeedbackParticipantType.STUDENTS,"},{"lineNumber":378,"author":{"gitId":"-"},"content":"    recipientList: [{ recipientName: \u0027Barry Harris\u0027, recipientIdentifier: \u0027barry-harris-id\u0027 }],"},{"lineNumber":379,"author":{"gitId":"-"},"content":"    recipientSubmissionForms: [testMsqRecipientSubmissionForm],"},{"lineNumber":380,"author":{"gitId":"-"},"content":"    numberOfEntitiesToGiveFeedbackToSetting: NumberOfEntitiesToGiveFeedbackToSetting.UNLIMITED,"},{"lineNumber":381,"author":{"gitId":"-"},"content":"    customNumberOfEntitiesToGiveFeedbackTo: 5,"},{"lineNumber":382,"author":{"gitId":"-"},"content":"    showResponsesTo: [FeedbackVisibilityType.RECIPIENT, FeedbackVisibilityType.INSTRUCTORS],"},{"lineNumber":383,"author":{"gitId":"-"},"content":"    showGiverNameTo: [FeedbackVisibilityType.RECIPIENT, FeedbackVisibilityType.INSTRUCTORS],"},{"lineNumber":384,"author":{"gitId":"-"},"content":"    showRecipientNameTo: [FeedbackVisibilityType.RECIPIENT, FeedbackVisibilityType.INSTRUCTORS],"},{"lineNumber":385,"author":{"gitId":"-"},"content":"  };"},{"lineNumber":386,"author":{"gitId":"-"},"content":""},{"lineNumber":387,"author":{"gitId":"-"},"content":"  const testNumscaleQuestionSubmissionForm: QuestionSubmissionFormModel \u003d {"},{"lineNumber":388,"author":{"gitId":"-"},"content":"    feedbackQuestionId: \u0027feedback-question-id-numscale\u0027,"},{"lineNumber":389,"author":{"gitId":"-"},"content":"    questionNumber: 5,"},{"lineNumber":390,"author":{"gitId":"-"},"content":"    questionBrief: \u0027numerical scale question\u0027,"},{"lineNumber":391,"author":{"gitId":"-"},"content":"    questionDescription: \u0027question description\u0027,"},{"lineNumber":392,"author":{"gitId":"-"},"content":"    questionType: FeedbackQuestionType.NUMSCALE,"},{"lineNumber":393,"author":{"gitId":"-"},"content":"    questionDetails: {"},{"lineNumber":394,"author":{"gitId":"-"},"content":"      minScale: 1,"},{"lineNumber":395,"author":{"gitId":"-"},"content":"      maxScale: 10,"},{"lineNumber":396,"author":{"gitId":"-"},"content":"      step: 1,"},{"lineNumber":397,"author":{"gitId":"-"},"content":"    } as FeedbackNumericalScaleQuestionDetails,"},{"lineNumber":398,"author":{"gitId":"-"},"content":"    giverType: FeedbackParticipantType.INSTRUCTORS,"},{"lineNumber":399,"author":{"gitId":"-"},"content":"    recipientType: FeedbackParticipantType.STUDENTS,"},{"lineNumber":400,"author":{"gitId":"-"},"content":"    recipientList: [{ recipientName: \u0027Barry Harris\u0027, recipientIdentifier: \u0027barry-harris-id\u0027 }],"},{"lineNumber":401,"author":{"gitId":"-"},"content":"    recipientSubmissionForms: [testNumscaleRecipientSubmissionForm],"},{"lineNumber":402,"author":{"gitId":"-"},"content":"    numberOfEntitiesToGiveFeedbackToSetting: NumberOfEntitiesToGiveFeedbackToSetting.UNLIMITED,"},{"lineNumber":403,"author":{"gitId":"-"},"content":"    customNumberOfEntitiesToGiveFeedbackTo: 5,"},{"lineNumber":404,"author":{"gitId":"-"},"content":"    showResponsesTo: [FeedbackVisibilityType.RECIPIENT, FeedbackVisibilityType.INSTRUCTORS],"},{"lineNumber":405,"author":{"gitId":"-"},"content":"    showGiverNameTo: [FeedbackVisibilityType.RECIPIENT, FeedbackVisibilityType.INSTRUCTORS],"},{"lineNumber":406,"author":{"gitId":"-"},"content":"    showRecipientNameTo: [FeedbackVisibilityType.RECIPIENT, FeedbackVisibilityType.INSTRUCTORS],"},{"lineNumber":407,"author":{"gitId":"-"},"content":"  };"},{"lineNumber":408,"author":{"gitId":"-"},"content":""},{"lineNumber":409,"author":{"gitId":"-"},"content":"  const testConstsumQuestionSubmissionForm: QuestionSubmissionFormModel \u003d {"},{"lineNumber":410,"author":{"gitId":"-"},"content":"    feedbackQuestionId: \u0027feedback-question-id-constsum\u0027,"},{"lineNumber":411,"author":{"gitId":"-"},"content":"    questionNumber: 6,"},{"lineNumber":412,"author":{"gitId":"-"},"content":"    questionBrief: \u0027constant sum question\u0027,"},{"lineNumber":413,"author":{"gitId":"-"},"content":"    questionDescription: \u0027question description\u0027,"},{"lineNumber":414,"author":{"gitId":"-"},"content":"    questionType: FeedbackQuestionType.CONSTSUM_RECIPIENTS,"},{"lineNumber":415,"author":{"gitId":"-"},"content":"    questionDetails: {"},{"lineNumber":416,"author":{"gitId":"-"},"content":"      constSumOptions: [\u0027option 1\u0027, \u0027option 2\u0027],"},{"lineNumber":417,"author":{"gitId":"-"},"content":"      distributeToRecipients: true,"},{"lineNumber":418,"author":{"gitId":"-"},"content":"      pointsPerOption: true,"},{"lineNumber":419,"author":{"gitId":"-"},"content":"      forceUnevenDistribution: false,"},{"lineNumber":420,"author":{"gitId":"-"},"content":"      distributePointsFor: \u0027distribute points for\u0027,"},{"lineNumber":421,"author":{"gitId":"-"},"content":"      points: 20,"},{"lineNumber":422,"author":{"gitId":"-"},"content":"    } as FeedbackConstantSumQuestionDetails,"},{"lineNumber":423,"author":{"gitId":"-"},"content":"    giverType: FeedbackParticipantType.INSTRUCTORS,"},{"lineNumber":424,"author":{"gitId":"-"},"content":"    recipientType: FeedbackParticipantType.STUDENTS,"},{"lineNumber":425,"author":{"gitId":"-"},"content":"    recipientList: [{ recipientName: \u0027Barry Harris\u0027, recipientIdentifier: \u0027barry-harris-id\u0027 }],"},{"lineNumber":426,"author":{"gitId":"-"},"content":"    recipientSubmissionForms: [testConstsumRecipientSubmissionForm],"},{"lineNumber":427,"author":{"gitId":"-"},"content":"    numberOfEntitiesToGiveFeedbackToSetting: NumberOfEntitiesToGiveFeedbackToSetting.UNLIMITED,"},{"lineNumber":428,"author":{"gitId":"-"},"content":"    customNumberOfEntitiesToGiveFeedbackTo: 5,"},{"lineNumber":429,"author":{"gitId":"-"},"content":"    showResponsesTo: [FeedbackVisibilityType.RECIPIENT, FeedbackVisibilityType.INSTRUCTORS],"},{"lineNumber":430,"author":{"gitId":"-"},"content":"    showGiverNameTo: [FeedbackVisibilityType.RECIPIENT, FeedbackVisibilityType.INSTRUCTORS],"},{"lineNumber":431,"author":{"gitId":"-"},"content":"    showRecipientNameTo: [FeedbackVisibilityType.RECIPIENT, FeedbackVisibilityType.INSTRUCTORS],"},{"lineNumber":432,"author":{"gitId":"-"},"content":"  };"},{"lineNumber":433,"author":{"gitId":"-"},"content":""},{"lineNumber":434,"author":{"gitId":"-"},"content":"  const testContribQuestionSubmissionForm: QuestionSubmissionFormModel \u003d {"},{"lineNumber":435,"author":{"gitId":"-"},"content":"    feedbackQuestionId: \u0027feedback-question-id-contrib\u0027,"},{"lineNumber":436,"author":{"gitId":"-"},"content":"    questionNumber: 7,"},{"lineNumber":437,"author":{"gitId":"-"},"content":"    questionBrief: \u0027contribution question\u0027,"},{"lineNumber":438,"author":{"gitId":"-"},"content":"    questionDescription: \u0027question description\u0027,"},{"lineNumber":439,"author":{"gitId":"-"},"content":"    questionType: FeedbackQuestionType.CONTRIB,"},{"lineNumber":440,"author":{"gitId":"-"},"content":"    questionDetails: {"},{"lineNumber":441,"author":{"gitId":"-"},"content":"      isNotSureAllowed: false,"},{"lineNumber":442,"author":{"gitId":"-"},"content":"    } as FeedbackContributionQuestionDetails,"},{"lineNumber":443,"author":{"gitId":"-"},"content":"    giverType: FeedbackParticipantType.INSTRUCTORS,"},{"lineNumber":444,"author":{"gitId":"-"},"content":"    recipientType: FeedbackParticipantType.STUDENTS,"},{"lineNumber":445,"author":{"gitId":"-"},"content":"    recipientList: [{ recipientName: \u0027Barry Harris\u0027, recipientIdentifier: \u0027barry-harris-id\u0027 }],"},{"lineNumber":446,"author":{"gitId":"-"},"content":"    recipientSubmissionForms: [testContribRecipientSubmissionForm],"},{"lineNumber":447,"author":{"gitId":"-"},"content":"    numberOfEntitiesToGiveFeedbackToSetting: NumberOfEntitiesToGiveFeedbackToSetting.UNLIMITED,"},{"lineNumber":448,"author":{"gitId":"-"},"content":"    customNumberOfEntitiesToGiveFeedbackTo: 5,"},{"lineNumber":449,"author":{"gitId":"-"},"content":"    showResponsesTo: [FeedbackVisibilityType.RECIPIENT, FeedbackVisibilityType.INSTRUCTORS],"},{"lineNumber":450,"author":{"gitId":"-"},"content":"    showGiverNameTo: [FeedbackVisibilityType.RECIPIENT, FeedbackVisibilityType.INSTRUCTORS],"},{"lineNumber":451,"author":{"gitId":"-"},"content":"    showRecipientNameTo: [FeedbackVisibilityType.RECIPIENT, FeedbackVisibilityType.INSTRUCTORS],"},{"lineNumber":452,"author":{"gitId":"-"},"content":"  };"},{"lineNumber":453,"author":{"gitId":"-"},"content":""},{"lineNumber":454,"author":{"gitId":"-"},"content":"  const testRubricQuestionSubmissionForm: QuestionSubmissionFormModel \u003d {"},{"lineNumber":455,"author":{"gitId":"-"},"content":"    feedbackQuestionId: \u0027feedback-question-id-rubric\u0027,"},{"lineNumber":456,"author":{"gitId":"-"},"content":"    questionNumber: 8,"},{"lineNumber":457,"author":{"gitId":"-"},"content":"    questionBrief: \u0027question brief\u0027,"},{"lineNumber":458,"author":{"gitId":"-"},"content":"    questionDescription: \u0027question description\u0027,"},{"lineNumber":459,"author":{"gitId":"-"},"content":"    questionType: FeedbackQuestionType.RUBRIC,"},{"lineNumber":460,"author":{"gitId":"-"},"content":"    questionDetails: {"},{"lineNumber":461,"author":{"gitId":"-"},"content":"      hasAssignedWeights: false,"},{"lineNumber":462,"author":{"gitId":"-"},"content":"      rubricWeightsForEachCell: [[1, 2], [2, 1]],"},{"lineNumber":463,"author":{"gitId":"-"},"content":"      rubricChoices: [\u0027choice 1\u0027, \u0027choice 2\u0027],"},{"lineNumber":464,"author":{"gitId":"-"},"content":"      rubricSubQuestions: [\u0027subquestion 1\u0027, \u0027subquestion 2\u0027],"},{"lineNumber":465,"author":{"gitId":"-"},"content":"      rubricDescriptions: [[\u0027description 1\u0027, \u0027description 2\u0027], [\u0027description 3\u0027, \u0027description 4\u0027]],"},{"lineNumber":466,"author":{"gitId":"-"},"content":"    } as FeedbackRubricQuestionDetails,"},{"lineNumber":467,"author":{"gitId":"-"},"content":"    giverType: FeedbackParticipantType.INSTRUCTORS,"},{"lineNumber":468,"author":{"gitId":"-"},"content":"    recipientType: FeedbackParticipantType.STUDENTS,"},{"lineNumber":469,"author":{"gitId":"-"},"content":"    recipientList: [{ recipientName: \u0027Barry Harris\u0027, recipientIdentifier: \u0027barry-harris-id\u0027 }],"},{"lineNumber":470,"author":{"gitId":"-"},"content":"    recipientSubmissionForms: [testRubricRecipientSubmissionForm],"},{"lineNumber":471,"author":{"gitId":"-"},"content":"    numberOfEntitiesToGiveFeedbackToSetting: NumberOfEntitiesToGiveFeedbackToSetting.UNLIMITED,"},{"lineNumber":472,"author":{"gitId":"-"},"content":"    customNumberOfEntitiesToGiveFeedbackTo: 5,"},{"lineNumber":473,"author":{"gitId":"-"},"content":"    showResponsesTo: [FeedbackVisibilityType.RECIPIENT, FeedbackVisibilityType.INSTRUCTORS],"},{"lineNumber":474,"author":{"gitId":"-"},"content":"    showGiverNameTo: [FeedbackVisibilityType.RECIPIENT, FeedbackVisibilityType.INSTRUCTORS],"},{"lineNumber":475,"author":{"gitId":"-"},"content":"    showRecipientNameTo: [FeedbackVisibilityType.RECIPIENT, FeedbackVisibilityType.INSTRUCTORS],"},{"lineNumber":476,"author":{"gitId":"-"},"content":"  };"},{"lineNumber":477,"author":{"gitId":"-"},"content":""},{"lineNumber":478,"author":{"gitId":"-"},"content":"  const testRankOptionsQuestionSubmissionForm: QuestionSubmissionFormModel \u003d {"},{"lineNumber":479,"author":{"gitId":"-"},"content":"    feedbackQuestionId: \u0027feedback-question-id-rank-options\u0027,"},{"lineNumber":480,"author":{"gitId":"-"},"content":"    questionNumber: 9,"},{"lineNumber":481,"author":{"gitId":"-"},"content":"    questionBrief: \u0027question brief\u0027,"},{"lineNumber":482,"author":{"gitId":"-"},"content":"    questionDescription: \u0027question description\u0027,"},{"lineNumber":483,"author":{"gitId":"-"},"content":"    questionType: FeedbackQuestionType.RANK_OPTIONS,"},{"lineNumber":484,"author":{"gitId":"-"},"content":"    questionDetails: {"},{"lineNumber":485,"author":{"gitId":"-"},"content":"      options: [\u0027option 1\u0027, \u0027option 2\u0027],"},{"lineNumber":486,"author":{"gitId":"-"},"content":"    } as FeedbackRankOptionsQuestionDetails,"},{"lineNumber":487,"author":{"gitId":"-"},"content":"    giverType: FeedbackParticipantType.INSTRUCTORS,"},{"lineNumber":488,"author":{"gitId":"-"},"content":"    recipientType: FeedbackParticipantType.STUDENTS,"},{"lineNumber":489,"author":{"gitId":"-"},"content":"    recipientList: [{ recipientName: \u0027Barry Harris\u0027, recipientIdentifier: \u0027barry-harris-id\u0027 }],"},{"lineNumber":490,"author":{"gitId":"-"},"content":"    recipientSubmissionForms: [testRankOptionsRecipientSubmissionForm],"},{"lineNumber":491,"author":{"gitId":"-"},"content":"    numberOfEntitiesToGiveFeedbackToSetting: NumberOfEntitiesToGiveFeedbackToSetting.UNLIMITED,"},{"lineNumber":492,"author":{"gitId":"-"},"content":"    customNumberOfEntitiesToGiveFeedbackTo: 5,"},{"lineNumber":493,"author":{"gitId":"-"},"content":"    showResponsesTo: [FeedbackVisibilityType.RECIPIENT, FeedbackVisibilityType.INSTRUCTORS],"},{"lineNumber":494,"author":{"gitId":"-"},"content":"    showGiverNameTo: [FeedbackVisibilityType.RECIPIENT, FeedbackVisibilityType.INSTRUCTORS],"},{"lineNumber":495,"author":{"gitId":"-"},"content":"    showRecipientNameTo: [FeedbackVisibilityType.RECIPIENT, FeedbackVisibilityType.INSTRUCTORS],"},{"lineNumber":496,"author":{"gitId":"-"},"content":"  };"},{"lineNumber":497,"author":{"gitId":"-"},"content":""},{"lineNumber":498,"author":{"gitId":"-"},"content":"  const testRankRecipientsQuestionSubmissionForm: QuestionSubmissionFormModel \u003d {"},{"lineNumber":499,"author":{"gitId":"-"},"content":"    feedbackQuestionId: \u0027feedback-question-id-rank-recipients\u0027,"},{"lineNumber":500,"author":{"gitId":"-"},"content":"    questionNumber: 10,"},{"lineNumber":501,"author":{"gitId":"-"},"content":"    questionBrief: \u0027question brief\u0027,"},{"lineNumber":502,"author":{"gitId":"-"},"content":"    questionDescription: \u0027question description\u0027,"},{"lineNumber":503,"author":{"gitId":"-"},"content":"    questionType: FeedbackQuestionType.RANK_RECIPIENTS,"},{"lineNumber":504,"author":{"gitId":"-"},"content":"    questionDetails: {"},{"lineNumber":505,"author":{"gitId":"-"},"content":"      minOptionsToBeRanked: 1,"},{"lineNumber":506,"author":{"gitId":"-"},"content":"      maxOptionsToBeRanked: 2,"},{"lineNumber":507,"author":{"gitId":"-"},"content":"      areDuplicatesAllowed: false,"},{"lineNumber":508,"author":{"gitId":"-"},"content":"    } as FeedbackRankRecipientsQuestionDetails,"},{"lineNumber":509,"author":{"gitId":"-"},"content":"    giverType: FeedbackParticipantType.INSTRUCTORS,"},{"lineNumber":510,"author":{"gitId":"-"},"content":"    recipientType: FeedbackParticipantType.STUDENTS,"},{"lineNumber":511,"author":{"gitId":"-"},"content":"    recipientList: [{ recipientName: \u0027Barry Harris\u0027, recipientIdentifier: \u0027barry-harris-id\u0027 }],"},{"lineNumber":512,"author":{"gitId":"-"},"content":"    recipientSubmissionForms: [testRankRecipientsRecipientSubmissionForm],"},{"lineNumber":513,"author":{"gitId":"-"},"content":"    numberOfEntitiesToGiveFeedbackToSetting: NumberOfEntitiesToGiveFeedbackToSetting.UNLIMITED,"},{"lineNumber":514,"author":{"gitId":"-"},"content":"    customNumberOfEntitiesToGiveFeedbackTo: 5,"},{"lineNumber":515,"author":{"gitId":"-"},"content":"    showResponsesTo: [FeedbackVisibilityType.RECIPIENT, FeedbackVisibilityType.INSTRUCTORS],"},{"lineNumber":516,"author":{"gitId":"-"},"content":"    showGiverNameTo: [FeedbackVisibilityType.RECIPIENT, FeedbackVisibilityType.INSTRUCTORS],"},{"lineNumber":517,"author":{"gitId":"-"},"content":"    showRecipientNameTo: [FeedbackVisibilityType.RECIPIENT, FeedbackVisibilityType.INSTRUCTORS],"},{"lineNumber":518,"author":{"gitId":"-"},"content":"  };"},{"lineNumber":519,"author":{"gitId":"-"},"content":""},{"lineNumber":520,"author":{"gitId":"-"},"content":"  const testInfo: AuthInfo \u003d {"},{"lineNumber":521,"author":{"gitId":"-"},"content":"    masquerade: false,"},{"lineNumber":522,"author":{"gitId":"-"},"content":"    user: {"},{"lineNumber":523,"author":{"gitId":"-"},"content":"      id: \u0027user-id\u0027,"},{"lineNumber":524,"author":{"gitId":"-"},"content":"      isAdmin: false,"},{"lineNumber":525,"author":{"gitId":"-"},"content":"      isInstructor: false,"},{"lineNumber":526,"author":{"gitId":"-"},"content":"      isStudent: true,"},{"lineNumber":527,"author":{"gitId":"-"},"content":"      isMaintainer: false,"},{"lineNumber":528,"author":{"gitId":"-"},"content":"    },"},{"lineNumber":529,"author":{"gitId":"-"},"content":"  };"},{"lineNumber":530,"author":{"gitId":"-"},"content":""},{"lineNumber":531,"author":{"gitId":"-"},"content":"  const testQueryParams: any \u003d {"},{"lineNumber":532,"author":{"gitId":"-"},"content":"    courseid: \u0027CS3281\u0027,"},{"lineNumber":533,"author":{"gitId":"-"},"content":"    fsname: \u0027Feedback Session Name\u0027,"},{"lineNumber":534,"author":{"gitId":"-"},"content":"    key: \u0027reg-key\u0027,"},{"lineNumber":535,"author":{"gitId":"-"},"content":"  };"},{"lineNumber":536,"author":{"gitId":"-"},"content":""},{"lineNumber":537,"author":{"gitId":"-"},"content":"  const getFeedbackSessionArgs: any \u003d {"},{"lineNumber":538,"author":{"gitId":"-"},"content":"    courseId: testQueryParams.courseid,"},{"lineNumber":539,"author":{"gitId":"-"},"content":"    feedbackSessionName: testQueryParams.fsname,"},{"lineNumber":540,"author":{"gitId":"-"},"content":"    intent: Intent.STUDENT_SUBMISSION,"},{"lineNumber":541,"author":{"gitId":"-"},"content":"    key: testQueryParams.key,"},{"lineNumber":542,"author":{"gitId":"-"},"content":"    moderatedPerson: \u0027\u0027,"},{"lineNumber":543,"author":{"gitId":"-"},"content":"    previewAs: \u0027\u0027,"},{"lineNumber":544,"author":{"gitId":"-"},"content":"  };"},{"lineNumber":545,"author":{"gitId":"-"},"content":""},{"lineNumber":546,"author":{"gitId":"-"},"content":"  let component: SessionSubmissionPageComponent;"},{"lineNumber":547,"author":{"gitId":"-"},"content":"  let fixture: ComponentFixture\u003cSessionSubmissionPageComponent\u003e;"},{"lineNumber":548,"author":{"gitId":"-"},"content":"  let authService: AuthService;"},{"lineNumber":549,"author":{"gitId":"-"},"content":"  let navService: NavigationService;"},{"lineNumber":550,"author":{"gitId":"-"},"content":"  let studentService: StudentService;"},{"lineNumber":551,"author":{"gitId":"-"},"content":"  let instructorService: InstructorService;"},{"lineNumber":552,"author":{"gitId":"-"},"content":"  let feedbackSessionsService: FeedbackSessionsService;"},{"lineNumber":553,"author":{"gitId":"-"},"content":"  let feedbackResponsesService: FeedbackResponsesService;"},{"lineNumber":554,"author":{"gitId":"-"},"content":"  let feedbackResponseCommentService: FeedbackResponseCommentService;"},{"lineNumber":555,"author":{"gitId":"-"},"content":"  let feedbackQuestionsService: FeedbackQuestionsService;"},{"lineNumber":556,"author":{"gitId":"-"},"content":"  let simpleModalService: SimpleModalService;"},{"lineNumber":557,"author":{"gitId":"-"},"content":"  let ngbModal: NgbModal;"},{"lineNumber":558,"author":{"gitId":"-"},"content":""},{"lineNumber":559,"author":{"gitId":"-"},"content":"  beforeEach(async(() \u003d\u003e {"},{"lineNumber":560,"author":{"gitId":"-"},"content":"    TestBed.configureTestingModule({"},{"lineNumber":561,"author":{"gitId":"-"},"content":"      declarations: [SessionSubmissionPageComponent, SavingCompleteModalComponent],"},{"lineNumber":562,"author":{"gitId":"-"},"content":"      imports: ["},{"lineNumber":563,"author":{"gitId":"-"},"content":"        HttpClientTestingModule,"},{"lineNumber":564,"author":{"gitId":"-"},"content":"        RouterTestingModule,"},{"lineNumber":565,"author":{"gitId":"-"},"content":"        NgxPageScrollCoreModule,"},{"lineNumber":566,"author":{"gitId":"-"},"content":"        TeammatesCommonModule,"},{"lineNumber":567,"author":{"gitId":"-"},"content":"        FormsModule,"},{"lineNumber":568,"author":{"gitId":"-"},"content":"        AjaxLoadingModule,"},{"lineNumber":569,"author":{"gitId":"-"},"content":"        QuestionSubmissionFormModule,"},{"lineNumber":570,"author":{"gitId":"-"},"content":"        LoadingSpinnerModule,"},{"lineNumber":571,"author":{"gitId":"-"},"content":"        LoadingRetryModule,"},{"lineNumber":572,"author":{"gitId":"-"},"content":"      ],"},{"lineNumber":573,"author":{"gitId":"-"},"content":"      providers: ["},{"lineNumber":574,"author":{"gitId":"-"},"content":"        {"},{"lineNumber":575,"author":{"gitId":"-"},"content":"          provide: ActivatedRoute,"},{"lineNumber":576,"author":{"gitId":"-"},"content":"          useValue: {"},{"lineNumber":577,"author":{"gitId":"-"},"content":"            data: {"},{"lineNumber":578,"author":{"gitId":"-"},"content":"              intent: Intent.STUDENT_SUBMISSION,"},{"lineNumber":579,"author":{"gitId":"-"},"content":"              pipe: () \u003d\u003e {"},{"lineNumber":580,"author":{"gitId":"-"},"content":"                return {"},{"lineNumber":581,"author":{"gitId":"-"},"content":"                  subscribe: (fn: (value: any) \u003d\u003e void) \u003d\u003e fn(testQueryParams),"},{"lineNumber":582,"author":{"gitId":"-"},"content":"                };"},{"lineNumber":583,"author":{"gitId":"-"},"content":"              },"},{"lineNumber":584,"author":{"gitId":"-"},"content":"            },"},{"lineNumber":585,"author":{"gitId":"-"},"content":"          },"},{"lineNumber":586,"author":{"gitId":"-"},"content":"        },"},{"lineNumber":587,"author":{"gitId":"-"},"content":"      ],"},{"lineNumber":588,"author":{"gitId":"-"},"content":"    })"},{"lineNumber":589,"author":{"gitId":"-"},"content":"    .compileComponents();"},{"lineNumber":590,"author":{"gitId":"-"},"content":"  }));"},{"lineNumber":591,"author":{"gitId":"-"},"content":""},{"lineNumber":592,"author":{"gitId":"-"},"content":"  beforeEach(() \u003d\u003e {"},{"lineNumber":593,"author":{"gitId":"-"},"content":"    fixture \u003d TestBed.createComponent(SessionSubmissionPageComponent);"},{"lineNumber":594,"author":{"gitId":"-"},"content":"    authService \u003d TestBed.inject(AuthService);"},{"lineNumber":595,"author":{"gitId":"-"},"content":"    navService \u003d TestBed.inject(NavigationService);"},{"lineNumber":596,"author":{"gitId":"-"},"content":"    studentService \u003d TestBed.inject(StudentService);"},{"lineNumber":597,"author":{"gitId":"-"},"content":"    instructorService \u003d TestBed.inject(InstructorService);"},{"lineNumber":598,"author":{"gitId":"-"},"content":"    feedbackQuestionsService \u003d TestBed.inject(FeedbackQuestionsService);"},{"lineNumber":599,"author":{"gitId":"-"},"content":"    feedbackResponsesService \u003d TestBed.inject(FeedbackResponsesService);"},{"lineNumber":600,"author":{"gitId":"-"},"content":"    feedbackResponseCommentService \u003d TestBed.inject(FeedbackResponseCommentService);"},{"lineNumber":601,"author":{"gitId":"-"},"content":"    feedbackSessionsService \u003d TestBed.inject(FeedbackSessionsService);"},{"lineNumber":602,"author":{"gitId":"-"},"content":"    simpleModalService \u003d TestBed.inject(SimpleModalService);"},{"lineNumber":603,"author":{"gitId":"-"},"content":"    ngbModal \u003d TestBed.inject(NgbModal);"},{"lineNumber":604,"author":{"gitId":"-"},"content":"    component \u003d fixture.componentInstance;"},{"lineNumber":605,"author":{"gitId":"-"},"content":"    fixture.detectChanges();"},{"lineNumber":606,"author":{"gitId":"-"},"content":"  });"},{"lineNumber":607,"author":{"gitId":"-"},"content":""},{"lineNumber":608,"author":{"gitId":"-"},"content":"  it(\u0027should create\u0027, () \u003d\u003e {"},{"lineNumber":609,"author":{"gitId":"-"},"content":"    expect(component).toBeTruthy();"},{"lineNumber":610,"author":{"gitId":"-"},"content":"  });"},{"lineNumber":611,"author":{"gitId":"-"},"content":""},{"lineNumber":612,"author":{"gitId":"-"},"content":"  it(\u0027should snap with default fields\u0027, () \u003d\u003e {"},{"lineNumber":613,"author":{"gitId":"-"},"content":"    expect(fixture).toMatchSnapshot();"},{"lineNumber":614,"author":{"gitId":"-"},"content":"  });"},{"lineNumber":615,"author":{"gitId":"-"},"content":""},{"lineNumber":616,"author":{"gitId":"-"},"content":"  it(\u0027should snap when feedback session questions have failed to load\u0027, () \u003d\u003e {"},{"lineNumber":617,"author":{"gitId":"-"},"content":"    component.retryAttempts \u003d 0;"},{"lineNumber":618,"author":{"gitId":"-"},"content":"    component.hasFeedbackSessionQuestionsLoadingFailed \u003d true;"},{"lineNumber":619,"author":{"gitId":"-"},"content":"    fixture.detectChanges();"},{"lineNumber":620,"author":{"gitId":"-"},"content":"    expect(fixture).toMatchSnapshot();"},{"lineNumber":621,"author":{"gitId":"-"},"content":"  });"},{"lineNumber":622,"author":{"gitId":"-"},"content":""},{"lineNumber":623,"author":{"gitId":"-"},"content":"  it(\u0027should snap when saving responses\u0027, () \u003d\u003e {"},{"lineNumber":624,"author":{"gitId":"-"},"content":"    component.isSavingResponses \u003d true;"},{"lineNumber":625,"author":{"gitId":"-"},"content":"    fixture.detectChanges();"},{"lineNumber":626,"author":{"gitId":"-"},"content":"    expect(fixture).toMatchSnapshot();"},{"lineNumber":627,"author":{"gitId":"-"},"content":"  });"},{"lineNumber":628,"author":{"gitId":"-"},"content":""},{"lineNumber":629,"author":{"gitId":"-"},"content":"  it(\u0027should snap with user that is logged in and using session link\u0027, () \u003d\u003e {"},{"lineNumber":630,"author":{"gitId":"-"},"content":"    component.regKey \u003d \u0027reg-key\u0027;"},{"lineNumber":631,"author":{"gitId":"-"},"content":"    component.loggedInUser \u003d \u0027alice\u0027;"},{"lineNumber":632,"author":{"gitId":"-"},"content":"    component.personName \u003d \u0027alice\u0027;"},{"lineNumber":633,"author":{"gitId":"-"},"content":"    fixture.detectChanges();"},{"lineNumber":634,"author":{"gitId":"-"},"content":"    expect(fixture).toMatchSnapshot();"},{"lineNumber":635,"author":{"gitId":"-"},"content":"  });"},{"lineNumber":636,"author":{"gitId":"-"},"content":""},{"lineNumber":637,"author":{"gitId":"-"},"content":"  it(\u0027should snap with user that is not logged in and using session link\u0027, () \u003d\u003e {"},{"lineNumber":638,"author":{"gitId":"-"},"content":"    component.regKey \u003d \u0027reg-key\u0027;"},{"lineNumber":639,"author":{"gitId":"-"},"content":"    component.loggedInUser \u003d \u0027\u0027;"},{"lineNumber":640,"author":{"gitId":"-"},"content":"    component.personName \u003d \u0027alice\u0027;"},{"lineNumber":641,"author":{"gitId":"-"},"content":"    fixture.detectChanges();"},{"lineNumber":642,"author":{"gitId":"-"},"content":"    expect(fixture).toMatchSnapshot();"},{"lineNumber":643,"author":{"gitId":"-"},"content":"  });"},{"lineNumber":644,"author":{"gitId":"-"},"content":""},{"lineNumber":645,"author":{"gitId":"-"},"content":"  it(\u0027should snap with feedback session and user details\u0027, () \u003d\u003e {"},{"lineNumber":646,"author":{"gitId":"-"},"content":"    component.courseId \u003d \u0027test.exa-demo\u0027;"},{"lineNumber":647,"author":{"gitId":"-"},"content":"    component.feedbackSessionName \u003d \u0027First team feedback session\u0027;"},{"lineNumber":648,"author":{"gitId":"-"},"content":"    component.regKey \u003d \u0027reg-key\u0027;"},{"lineNumber":649,"author":{"gitId":"-"},"content":"    component.loggedInUser \u003d \u0027logged-in-user\u0027;"},{"lineNumber":650,"author":{"gitId":"-"},"content":"    component.personName \u003d \u0027person name\u0027;"},{"lineNumber":651,"author":{"gitId":"-"},"content":"    component.personEmail \u003d \u0027person@email.com\u0027;"},{"lineNumber":652,"author":{"gitId":"-"},"content":"    component.formattedSessionOpeningTime \u003d \u0027Sun, 01 Apr, 2012, 11:59 PM +08\u0027;"},{"lineNumber":653,"author":{"gitId":"-"},"content":"    component.formattedSessionClosingTime \u003d \u0027Mon, 02 Apr, 2012, 11:59 PM +08\u0027;"},{"lineNumber":654,"author":{"gitId":"-"},"content":"    component.feedbackSessionInstructions \u003d \u0027Please give your feedback based on the following questions.\u0027;"},{"lineNumber":655,"author":{"gitId":"-"},"content":"    component.isFeedbackSessionLoading \u003d false;"},{"lineNumber":656,"author":{"gitId":"-"},"content":"    fixture.detectChanges();"},{"lineNumber":657,"author":{"gitId":"-"},"content":"    expect(fixture).toMatchSnapshot();"},{"lineNumber":658,"author":{"gitId":"-"},"content":"  });"},{"lineNumber":659,"author":{"gitId":"-"},"content":""},{"lineNumber":660,"author":{"gitId":"-"},"content":"  it(\u0027should snap with feedback session question submission forms\u0027, () \u003d\u003e {"},{"lineNumber":661,"author":{"gitId":"-"},"content":"    component.questionSubmissionForms \u003d ["},{"lineNumber":662,"author":{"gitId":"-"},"content":"      testMcqQuestionSubmissionForm,"},{"lineNumber":663,"author":{"gitId":"-"},"content":"      testTextQuestionSubmissionForm,"},{"lineNumber":664,"author":{"gitId":"-"},"content":"      testMcqQuestionSubmissionForm2,"},{"lineNumber":665,"author":{"gitId":"-"},"content":"      testMsqQuestionSubmissionForm,"},{"lineNumber":666,"author":{"gitId":"-"},"content":"      testNumscaleQuestionSubmissionForm,"},{"lineNumber":667,"author":{"gitId":"-"},"content":"      testConstsumQuestionSubmissionForm,"},{"lineNumber":668,"author":{"gitId":"-"},"content":"      testContribQuestionSubmissionForm,"},{"lineNumber":669,"author":{"gitId":"-"},"content":"      testRubricQuestionSubmissionForm,"},{"lineNumber":670,"author":{"gitId":"-"},"content":"      testRankOptionsQuestionSubmissionForm,"},{"lineNumber":671,"author":{"gitId":"-"},"content":"      testRankRecipientsQuestionSubmissionForm,"},{"lineNumber":672,"author":{"gitId":"-"},"content":"    ];"},{"lineNumber":673,"author":{"gitId":"-"},"content":"    component.isFeedbackSessionLoading \u003d false;"},{"lineNumber":674,"author":{"gitId":"-"},"content":"    component.isFeedbackSessionQuestionsLoading \u003d false;"},{"lineNumber":675,"author":{"gitId":"-"},"content":"    component.isFeedbackSessionQuestionResponsesLoading \u003d false;"},{"lineNumber":676,"author":{"gitId":"-"},"content":"    fixture.detectChanges();"},{"lineNumber":677,"author":{"gitId":"-"},"content":"    expect(fixture).toMatchSnapshot();"},{"lineNumber":678,"author":{"gitId":"-"},"content":"  });"},{"lineNumber":679,"author":{"gitId":"-"},"content":""},{"lineNumber":680,"author":{"gitId":"-"},"content":"  it(\u0027should snap with feedback session question submission forms when disabled\u0027, () \u003d\u003e {"},{"lineNumber":681,"author":{"gitId":"-"},"content":"    component.questionSubmissionForms \u003d ["},{"lineNumber":682,"author":{"gitId":"-"},"content":"      testMcqQuestionSubmissionForm,"},{"lineNumber":683,"author":{"gitId":"-"},"content":"      testTextQuestionSubmissionForm,"},{"lineNumber":684,"author":{"gitId":"-"},"content":"      testMcqQuestionSubmissionForm2,"},{"lineNumber":685,"author":{"gitId":"-"},"content":"      testMsqQuestionSubmissionForm,"},{"lineNumber":686,"author":{"gitId":"-"},"content":"      testNumscaleQuestionSubmissionForm,"},{"lineNumber":687,"author":{"gitId":"-"},"content":"      testConstsumQuestionSubmissionForm,"},{"lineNumber":688,"author":{"gitId":"-"},"content":"      testContribQuestionSubmissionForm,"},{"lineNumber":689,"author":{"gitId":"-"},"content":"      testRubricQuestionSubmissionForm,"},{"lineNumber":690,"author":{"gitId":"-"},"content":"      testRankOptionsQuestionSubmissionForm,"},{"lineNumber":691,"author":{"gitId":"-"},"content":"      testRankRecipientsQuestionSubmissionForm,"},{"lineNumber":692,"author":{"gitId":"-"},"content":"    ];"},{"lineNumber":693,"author":{"gitId":"-"},"content":"    component.isSubmissionFormsDisabled \u003d true;"},{"lineNumber":694,"author":{"gitId":"-"},"content":"    component.isFeedbackSessionLoading \u003d false;"},{"lineNumber":695,"author":{"gitId":"-"},"content":"    component.isFeedbackSessionQuestionsLoading \u003d false;"},{"lineNumber":696,"author":{"gitId":"-"},"content":"    component.isFeedbackSessionQuestionResponsesLoading \u003d false;"},{"lineNumber":697,"author":{"gitId":"-"},"content":"    fixture.detectChanges();"},{"lineNumber":698,"author":{"gitId":"-"},"content":"    expect(fixture).toMatchSnapshot();"},{"lineNumber":699,"author":{"gitId":"-"},"content":"  });"},{"lineNumber":700,"author":{"gitId":"-"},"content":""},{"lineNumber":701,"author":{"gitId":"-"},"content":"  it(\u0027should fetch auth info on init\u0027, () \u003d\u003e {"},{"lineNumber":702,"author":{"gitId":"-"},"content":"    spyOn(authService, \u0027getAuthUser\u0027).and.returnValue(of(testInfo));"},{"lineNumber":703,"author":{"gitId":"-"},"content":"    component.ngOnInit();"},{"lineNumber":704,"author":{"gitId":"-"},"content":"    expect(component.intent).toEqual(Intent.STUDENT_SUBMISSION);"},{"lineNumber":705,"author":{"gitId":"-"},"content":"    expect(component.courseId).toEqual(testQueryParams.courseid);"},{"lineNumber":706,"author":{"gitId":"-"},"content":"    expect(component.feedbackSessionName).toEqual(testQueryParams.fsname);"},{"lineNumber":707,"author":{"gitId":"-"},"content":"    expect(component.regKey).toEqual(testQueryParams.key);"},{"lineNumber":708,"author":{"gitId":"-"},"content":"    expect(component.loggedInUser).toEqual(testInfo.user?.id);"},{"lineNumber":709,"author":{"gitId":"-"},"content":"  });"},{"lineNumber":710,"author":{"gitId":"-"},"content":""},{"lineNumber":711,"author":{"gitId":"-"},"content":"  it(\u0027should verify allowed access with used reg key\u0027, () \u003d\u003e {"},{"lineNumber":712,"author":{"gitId":"-"},"content":"    const testValidity: RegkeyValidity \u003d {"},{"lineNumber":713,"author":{"gitId":"-"},"content":"      isAllowedAccess: true,"},{"lineNumber":714,"author":{"gitId":"-"},"content":"      isUsed: true,"},{"lineNumber":715,"author":{"gitId":"-"},"content":"      isValid: false,"},{"lineNumber":716,"author":{"gitId":"-"},"content":"    };"},{"lineNumber":717,"author":{"gitId":"-"},"content":"    spyOn(authService, \u0027getAuthUser\u0027).and.returnValue(of(testInfo));"},{"lineNumber":718,"author":{"gitId":"-"},"content":"    spyOn(authService, \u0027getAuthRegkeyValidity\u0027).and.returnValue(of(testValidity));"},{"lineNumber":719,"author":{"gitId":"-"},"content":"    const navSpy: Spy \u003d spyOn(navService, \u0027navigateByURLWithParamEncoding\u0027);"},{"lineNumber":720,"author":{"gitId":"-"},"content":""},{"lineNumber":721,"author":{"gitId":"-"},"content":"    component.ngOnInit();"},{"lineNumber":722,"author":{"gitId":"-"},"content":""},{"lineNumber":723,"author":{"gitId":"-"},"content":"    expect(navSpy.calls.count()).toEqual(1);"},{"lineNumber":724,"author":{"gitId":"-"},"content":"    expect(navSpy.calls.mostRecent().args[1]).toEqual(\u0027/web/student/sessions/submission\u0027);"},{"lineNumber":725,"author":{"gitId":"-"},"content":"  });"},{"lineNumber":726,"author":{"gitId":"-"},"content":""},{"lineNumber":727,"author":{"gitId":"-"},"content":"  it(\u0027should deny unallowed access with valid reg key for logged in user\u0027, () \u003d\u003e {"},{"lineNumber":728,"author":{"gitId":"-"},"content":"    const testValidity: RegkeyValidity \u003d {"},{"lineNumber":729,"author":{"gitId":"-"},"content":"      isAllowedAccess: false,"},{"lineNumber":730,"author":{"gitId":"-"},"content":"      isUsed: false,"},{"lineNumber":731,"author":{"gitId":"-"},"content":"      isValid: true,"},{"lineNumber":732,"author":{"gitId":"-"},"content":"    };"},{"lineNumber":733,"author":{"gitId":"-"},"content":"    spyOn(authService, \u0027getAuthUser\u0027).and.returnValue(of(testInfo));"},{"lineNumber":734,"author":{"gitId":"-"},"content":"    spyOn(authService, \u0027getAuthRegkeyValidity\u0027).and.returnValue(of(testValidity));"},{"lineNumber":735,"author":{"gitId":"-"},"content":"    const navSpy: Spy \u003d spyOn(navService, \u0027navigateWithErrorMessage\u0027);"},{"lineNumber":736,"author":{"gitId":"-"},"content":""},{"lineNumber":737,"author":{"gitId":"-"},"content":"    component.ngOnInit();"},{"lineNumber":738,"author":{"gitId":"-"},"content":""},{"lineNumber":739,"author":{"gitId":"-"},"content":"    expect(navSpy.calls.count()).toEqual(1);"},{"lineNumber":740,"author":{"gitId":"-"},"content":"    expect(navSpy.calls.mostRecent().args[1]).toEqual(\u0027/web/front\u0027);"},{"lineNumber":741,"author":{"gitId":"-"},"content":"    expect(navSpy.calls.mostRecent().args[2]).toEqual("},{"lineNumber":742,"author":{"gitId":"-"},"content":"        `You are trying to access TEAMMATES using the Google account user-id, which"},{"lineNumber":743,"author":{"gitId":"-"},"content":"                    is not linked to this TEAMMATES account. If you used a different Google account to"},{"lineNumber":744,"author":{"gitId":"-"},"content":"                    join/access TEAMMATES before, please use that Google account to access TEAMMATES. If you"},{"lineNumber":745,"author":{"gitId":"-"},"content":"                    cannot remember which Google account you used before, please email us at"},{"lineNumber":746,"author":{"gitId":"-"},"content":"                    ${environment.supportEmail} for help.`);"},{"lineNumber":747,"author":{"gitId":"-"},"content":"  });"},{"lineNumber":748,"author":{"gitId":"-"},"content":""},{"lineNumber":749,"author":{"gitId":"-"},"content":"  it(\u0027should deny unallowed access with invalid reg key\u0027, () \u003d\u003e {"},{"lineNumber":750,"author":{"gitId":"-"},"content":"    const testValidity: RegkeyValidity \u003d {"},{"lineNumber":751,"author":{"gitId":"-"},"content":"      isAllowedAccess: false,"},{"lineNumber":752,"author":{"gitId":"-"},"content":"      isUsed: false,"},{"lineNumber":753,"author":{"gitId":"-"},"content":"      isValid: false,"},{"lineNumber":754,"author":{"gitId":"-"},"content":"    };"},{"lineNumber":755,"author":{"gitId":"-"},"content":"    spyOn(authService, \u0027getAuthUser\u0027).and.returnValue(of(testInfo));"},{"lineNumber":756,"author":{"gitId":"-"},"content":"    spyOn(authService, \u0027getAuthRegkeyValidity\u0027).and.returnValue(of(testValidity));"},{"lineNumber":757,"author":{"gitId":"-"},"content":"    const navSpy: Spy \u003d spyOn(navService, \u0027navigateWithErrorMessage\u0027);"},{"lineNumber":758,"author":{"gitId":"-"},"content":""},{"lineNumber":759,"author":{"gitId":"-"},"content":"    component.ngOnInit();"},{"lineNumber":760,"author":{"gitId":"-"},"content":""},{"lineNumber":761,"author":{"gitId":"-"},"content":"    expect(navSpy.calls.count()).toEqual(1);"},{"lineNumber":762,"author":{"gitId":"-"},"content":"    expect(navSpy.calls.mostRecent().args[1]).toEqual(\u0027/web/front\u0027);"},{"lineNumber":763,"author":{"gitId":"-"},"content":"  });"},{"lineNumber":764,"author":{"gitId":"-"},"content":""},{"lineNumber":765,"author":{"gitId":"-"},"content":"  it(\u0027should load a student name\u0027, () \u003d\u003e {"},{"lineNumber":766,"author":{"gitId":"-"},"content":"    component.intent \u003d Intent.STUDENT_SUBMISSION;"},{"lineNumber":767,"author":{"gitId":"-"},"content":"    spyOn(studentService, \u0027getStudent\u0027).and.returnValue(of(testStudent));"},{"lineNumber":768,"author":{"gitId":"-"},"content":"    component.loadPersonName();"},{"lineNumber":769,"author":{"gitId":"-"},"content":"    expect(component.personName).toEqual(testStudent.name);"},{"lineNumber":770,"author":{"gitId":"-"},"content":"    expect(component.personEmail).toEqual(testStudent.email);"},{"lineNumber":771,"author":{"gitId":"-"},"content":"  });"},{"lineNumber":772,"author":{"gitId":"-"},"content":""},{"lineNumber":773,"author":{"gitId":"-"},"content":"  it(\u0027should load an instructor name\u0027, () \u003d\u003e {"},{"lineNumber":774,"author":{"gitId":"-"},"content":"    component.intent \u003d Intent.INSTRUCTOR_SUBMISSION;"},{"lineNumber":775,"author":{"gitId":"-"},"content":"    spyOn(instructorService, \u0027getInstructor\u0027).and.returnValue(of(testInstructor));"},{"lineNumber":776,"author":{"gitId":"-"},"content":"    component.loadPersonName();"},{"lineNumber":777,"author":{"gitId":"-"},"content":"    expect(component.personName).toEqual(testInstructor.name);"},{"lineNumber":778,"author":{"gitId":"-"},"content":"    expect(component.personEmail).toEqual(testInstructor.email);"},{"lineNumber":779,"author":{"gitId":"-"},"content":"  });"},{"lineNumber":780,"author":{"gitId":"-"},"content":""},{"lineNumber":781,"author":{"gitId":"-"},"content":"  it(\u0027should join course for unregistered student\u0027, () \u003d\u003e {"},{"lineNumber":782,"author":{"gitId":"-"},"content":"    const navSpy: Spy \u003d spyOn(navService, \u0027navigateByURL\u0027);"},{"lineNumber":783,"author":{"gitId":"-"},"content":"    component.joinCourseForUnregisteredEntity();"},{"lineNumber":784,"author":{"gitId":"-"},"content":"    expect(navSpy.calls.count()).toEqual(1);"},{"lineNumber":785,"author":{"gitId":"-"},"content":"    expect(navSpy.calls.mostRecent().args[1]).toEqual(\u0027/web/join\u0027);"},{"lineNumber":786,"author":{"gitId":"-"},"content":"    expect(navSpy.calls.mostRecent().args[2]).toEqual({ entitytype: \u0027student\u0027, key: testQueryParams.key });"},{"lineNumber":787,"author":{"gitId":"-"},"content":"  });"},{"lineNumber":788,"author":{"gitId":"-"},"content":""},{"lineNumber":789,"author":{"gitId":"-"},"content":"  it(\u0027should load an open feedback session\u0027, () \u003d\u003e {"},{"lineNumber":790,"author":{"gitId":"-"},"content":"    const fsSpy: Spy \u003d spyOn(feedbackSessionsService, \u0027getFeedbackSession\u0027)"},{"lineNumber":791,"author":{"gitId":"-"},"content":"        .and.returnValue(of(testOpenFeedbackSession));"},{"lineNumber":792,"author":{"gitId":"-"},"content":"    const modalSpy: Spy \u003d spyOn(simpleModalService, \u0027openInformationModal\u0027);"},{"lineNumber":793,"author":{"gitId":"-"},"content":""},{"lineNumber":794,"author":{"gitId":"-"},"content":"    component.loadFeedbackSession();"},{"lineNumber":795,"author":{"gitId":"-"},"content":""},{"lineNumber":796,"author":{"gitId":"-"},"content":"    expect(fsSpy.calls.count()).toEqual(1);"},{"lineNumber":797,"author":{"gitId":"-"},"content":"    expect(fsSpy.calls.mostRecent().args[0]).toEqual(getFeedbackSessionArgs);"},{"lineNumber":798,"author":{"gitId":"-"},"content":"    expect(modalSpy.calls.count()).toEqual(1);"},{"lineNumber":799,"author":{"gitId":"-"},"content":"    expect(modalSpy.calls.mostRecent().args[0]).toEqual(\u0027Feedback Session Will Be Closing Soon!\u0027);"},{"lineNumber":800,"author":{"gitId":"-"},"content":"    expect(component.feedbackSessionInstructions).toEqual(testOpenFeedbackSession.instructions);"},{"lineNumber":801,"author":{"gitId":"-"},"content":"    expect(component.feedbackSessionSubmissionStatus).toEqual(testOpenFeedbackSession.submissionStatus);"},{"lineNumber":802,"author":{"gitId":"-"},"content":"    expect(component.feedbackSessionTimezone).toEqual(testOpenFeedbackSession.timeZone);"},{"lineNumber":803,"author":{"gitId":"-"},"content":"    expect(component.isSubmissionFormsDisabled).toEqual(false);"},{"lineNumber":804,"author":{"gitId":"-"},"content":"  });"},{"lineNumber":805,"author":{"gitId":"-"},"content":""},{"lineNumber":806,"author":{"gitId":"-"},"content":"  it(\u0027should load a closed feedback session\u0027, () \u003d\u003e {"},{"lineNumber":807,"author":{"gitId":"-"},"content":"    const testClosedFeedbackSession: FeedbackSession \u003d deepCopy(testOpenFeedbackSession);"},{"lineNumber":808,"author":{"gitId":"-"},"content":"    testClosedFeedbackSession.submissionStatus \u003d FeedbackSessionSubmissionStatus.CLOSED;"},{"lineNumber":809,"author":{"gitId":"-"},"content":"    const fsSpy: Spy \u003d spyOn(feedbackSessionsService, \u0027getFeedbackSession\u0027)"},{"lineNumber":810,"author":{"gitId":"-"},"content":"        .and.returnValue(of(testClosedFeedbackSession));"},{"lineNumber":811,"author":{"gitId":"-"},"content":"    const modalSpy: Spy \u003d spyOn(simpleModalService, \u0027openInformationModal\u0027);"},{"lineNumber":812,"author":{"gitId":"-"},"content":""},{"lineNumber":813,"author":{"gitId":"-"},"content":"    component.loadFeedbackSession();"},{"lineNumber":814,"author":{"gitId":"-"},"content":""},{"lineNumber":815,"author":{"gitId":"-"},"content":"    expect(fsSpy.calls.count()).toEqual(1);"},{"lineNumber":816,"author":{"gitId":"-"},"content":"    expect(fsSpy.calls.mostRecent().args[0]).toEqual(getFeedbackSessionArgs);"},{"lineNumber":817,"author":{"gitId":"-"},"content":"    expect(modalSpy.calls.count()).toEqual(1);"},{"lineNumber":818,"author":{"gitId":"-"},"content":"    expect(modalSpy.calls.mostRecent().args[0]).toEqual(\u0027Feedback Session Closed\u0027);"},{"lineNumber":819,"author":{"gitId":"-"},"content":"    expect(component.feedbackSessionInstructions).toEqual(testClosedFeedbackSession.instructions);"},{"lineNumber":820,"author":{"gitId":"-"},"content":"    expect(component.feedbackSessionSubmissionStatus).toEqual(testClosedFeedbackSession.submissionStatus);"},{"lineNumber":821,"author":{"gitId":"-"},"content":"    expect(component.feedbackSessionTimezone).toEqual(testClosedFeedbackSession.timeZone);"},{"lineNumber":822,"author":{"gitId":"-"},"content":"    expect(component.isSubmissionFormsDisabled).toEqual(true);"},{"lineNumber":823,"author":{"gitId":"-"},"content":"  });"},{"lineNumber":824,"author":{"gitId":"-"},"content":""},{"lineNumber":825,"author":{"gitId":"-"},"content":"  it(\u0027should load a visible not open feedback session\u0027, () \u003d\u003e {"},{"lineNumber":826,"author":{"gitId":"-"},"content":"    const testVisibleNotOpenFeedbackSession: FeedbackSession \u003d deepCopy(testOpenFeedbackSession);"},{"lineNumber":827,"author":{"gitId":"-"},"content":"    testVisibleNotOpenFeedbackSession.submissionStatus \u003d FeedbackSessionSubmissionStatus.VISIBLE_NOT_OPEN;"},{"lineNumber":828,"author":{"gitId":"-"},"content":"    const fsSpy: Spy \u003d spyOn(feedbackSessionsService, \u0027getFeedbackSession\u0027)"},{"lineNumber":829,"author":{"gitId":"-"},"content":"        .and.returnValue(of(testVisibleNotOpenFeedbackSession));"},{"lineNumber":830,"author":{"gitId":"-"},"content":"    const modalSpy: Spy \u003d spyOn(simpleModalService, \u0027openInformationModal\u0027);"},{"lineNumber":831,"author":{"gitId":"-"},"content":""},{"lineNumber":832,"author":{"gitId":"-"},"content":"    component.loadFeedbackSession();"},{"lineNumber":833,"author":{"gitId":"-"},"content":""},{"lineNumber":834,"author":{"gitId":"-"},"content":"    expect(fsSpy.calls.count()).toEqual(1);"},{"lineNumber":835,"author":{"gitId":"-"},"content":"    expect(fsSpy.calls.mostRecent().args[0]).toEqual(getFeedbackSessionArgs);"},{"lineNumber":836,"author":{"gitId":"-"},"content":"    expect(modalSpy.calls.count()).toEqual(1);"},{"lineNumber":837,"author":{"gitId":"-"},"content":"    expect(modalSpy.calls.mostRecent().args[0]).toEqual(\u0027Feedback Session Not Open\u0027);"},{"lineNumber":838,"author":{"gitId":"-"},"content":"    expect(component.feedbackSessionInstructions).toEqual(testVisibleNotOpenFeedbackSession.instructions);"},{"lineNumber":839,"author":{"gitId":"-"},"content":"    expect(component.feedbackSessionSubmissionStatus).toEqual(testVisibleNotOpenFeedbackSession.submissionStatus);"},{"lineNumber":840,"author":{"gitId":"-"},"content":"    expect(component.feedbackSessionTimezone).toEqual(testVisibleNotOpenFeedbackSession.timeZone);"},{"lineNumber":841,"author":{"gitId":"-"},"content":"    expect(component.isSubmissionFormsDisabled).toEqual(true);"},{"lineNumber":842,"author":{"gitId":"-"},"content":"  });"},{"lineNumber":843,"author":{"gitId":"-"},"content":""},{"lineNumber":844,"author":{"gitId":"-"},"content":"  it(\u0027should redirect when loading non-existent feedback session\u0027, () \u003d\u003e {"},{"lineNumber":845,"author":{"gitId":"-"},"content":"    spyOn(feedbackSessionsService, \u0027getFeedbackSession\u0027).and.returnValue(throwError({"},{"lineNumber":846,"author":{"gitId":"-"},"content":"      error: { message: \u0027This is an error\u0027 },"},{"lineNumber":847,"author":{"gitId":"-"},"content":"      status: 404,"},{"lineNumber":848,"author":{"gitId":"-"},"content":"    }));"},{"lineNumber":849,"author":{"gitId":"-"},"content":"    const navSpy: Spy \u003d spyOn(navService, \u0027navigateByURL\u0027);"},{"lineNumber":850,"author":{"gitId":"-"},"content":"    const modalSpy: Spy \u003d spyOn(simpleModalService, \u0027openInformationModal\u0027);"},{"lineNumber":851,"author":{"gitId":"-"},"content":""},{"lineNumber":852,"author":{"gitId":"-"},"content":"    component.loadFeedbackSession();"},{"lineNumber":853,"author":{"gitId":"-"},"content":""},{"lineNumber":854,"author":{"gitId":"-"},"content":"    expect(modalSpy.calls.count()).toEqual(1);"},{"lineNumber":855,"author":{"gitId":"-"},"content":"    expect(modalSpy.calls.mostRecent().args[0]).toEqual(\u0027Feedback Session Does Not Exist!\u0027);"},{"lineNumber":856,"author":{"gitId":"-"},"content":"    expect(navSpy.calls.count()).toEqual(1);"},{"lineNumber":857,"author":{"gitId":"-"},"content":"    expect(navSpy.calls.mostRecent().args[1]).toEqual(\u0027/web/student/home\u0027);"},{"lineNumber":858,"author":{"gitId":"-"},"content":"  });"},{"lineNumber":859,"author":{"gitId":"-"},"content":""},{"lineNumber":860,"author":{"gitId":"-"},"content":"  it(\u0027should redirect when loading non-viewable feedback session\u0027, () \u003d\u003e {"},{"lineNumber":861,"author":{"gitId":"-"},"content":"    spyOn(feedbackSessionsService, \u0027getFeedbackSession\u0027).and.returnValue(throwError({"},{"lineNumber":862,"author":{"gitId":"-"},"content":"      error: { message: \u0027This is an error\u0027 },"},{"lineNumber":863,"author":{"gitId":"-"},"content":"      status: 403,"},{"lineNumber":864,"author":{"gitId":"-"},"content":"    }));"},{"lineNumber":865,"author":{"gitId":"-"},"content":"    const navSpy: Spy \u003d spyOn(navService, \u0027navigateByURL\u0027);"},{"lineNumber":866,"author":{"gitId":"-"},"content":"    const modalSpy: Spy \u003d spyOn(simpleModalService, \u0027openInformationModal\u0027);"},{"lineNumber":867,"author":{"gitId":"-"},"content":""},{"lineNumber":868,"author":{"gitId":"-"},"content":"    component.loadFeedbackSession();"},{"lineNumber":869,"author":{"gitId":"-"},"content":""},{"lineNumber":870,"author":{"gitId":"-"},"content":"    expect(modalSpy.calls.count()).toEqual(1);"},{"lineNumber":871,"author":{"gitId":"-"},"content":"    expect(modalSpy.calls.mostRecent().args[0]).toEqual(\u0027Not Authorised To Access!\u0027);"},{"lineNumber":872,"author":{"gitId":"-"},"content":"    expect(navSpy.calls.count()).toEqual(1);"},{"lineNumber":873,"author":{"gitId":"-"},"content":"    expect(navSpy.calls.mostRecent().args[1]).toEqual(\u0027/web/student/home\u0027);"},{"lineNumber":874,"author":{"gitId":"-"},"content":"  });"},{"lineNumber":875,"author":{"gitId":"-"},"content":""},{"lineNumber":876,"author":{"gitId":"-"},"content":"  it(\u0027should load feedback questions and recipients and responses\u0027, () \u003d\u003e {"},{"lineNumber":877,"author":{"gitId":"-"},"content":"    const testFeedbackQuestions: FeedbackQuestions \u003d {"},{"lineNumber":878,"author":{"gitId":"-"},"content":"      questions: ["},{"lineNumber":879,"author":{"gitId":"-"},"content":"        {"},{"lineNumber":880,"author":{"gitId":"-"},"content":"          feedbackQuestionId: testMcqQuestionSubmissionForm2.feedbackQuestionId,"},{"lineNumber":881,"author":{"gitId":"-"},"content":"          questionNumber: testMcqQuestionSubmissionForm2.questionNumber,"},{"lineNumber":882,"author":{"gitId":"-"},"content":"          questionBrief: testMcqQuestionSubmissionForm2.questionBrief,"},{"lineNumber":883,"author":{"gitId":"-"},"content":"          questionDescription: testMcqQuestionSubmissionForm2.questionDescription,"},{"lineNumber":884,"author":{"gitId":"-"},"content":"          questionDetails: testMcqQuestionSubmissionForm2.questionDetails,"},{"lineNumber":885,"author":{"gitId":"-"},"content":"          questionType: testMcqQuestionSubmissionForm2.questionType,"},{"lineNumber":886,"author":{"gitId":"-"},"content":"          giverType: testMcqQuestionSubmissionForm2.giverType,"},{"lineNumber":887,"author":{"gitId":"-"},"content":"          recipientType: testMcqQuestionSubmissionForm2.recipientType,"},{"lineNumber":888,"author":{"gitId":"-"},"content":"          numberOfEntitiesToGiveFeedbackToSetting:"},{"lineNumber":889,"author":{"gitId":"-"},"content":"            testMcqQuestionSubmissionForm2.numberOfEntitiesToGiveFeedbackToSetting,"},{"lineNumber":890,"author":{"gitId":"-"},"content":"          customNumberOfEntitiesToGiveFeedbackTo: testMcqQuestionSubmissionForm2.customNumberOfEntitiesToGiveFeedbackTo,"},{"lineNumber":891,"author":{"gitId":"-"},"content":"          showResponsesTo: testMcqQuestionSubmissionForm2.showResponsesTo,"},{"lineNumber":892,"author":{"gitId":"-"},"content":"          showGiverNameTo: testMcqQuestionSubmissionForm2.showGiverNameTo,"},{"lineNumber":893,"author":{"gitId":"-"},"content":"          showRecipientNameTo: testMcqQuestionSubmissionForm2.showRecipientNameTo,"},{"lineNumber":894,"author":{"gitId":"-"},"content":"        },"},{"lineNumber":895,"author":{"gitId":"-"},"content":"      ],"},{"lineNumber":896,"author":{"gitId":"-"},"content":"    };"},{"lineNumber":897,"author":{"gitId":"-"},"content":"    const testFeedbackQuestionRecipients: FeedbackQuestionRecipients \u003d {"},{"lineNumber":898,"author":{"gitId":"-"},"content":"      recipients: ["},{"lineNumber":899,"author":{"gitId":"-"},"content":"        {"},{"lineNumber":900,"author":{"gitId":"-"},"content":"          name: \u0027Barry Harris\u0027,"},{"lineNumber":901,"author":{"gitId":"-"},"content":"          identifier: \u0027barry-harris-id\u0027,"},{"lineNumber":902,"author":{"gitId":"-"},"content":"        },"},{"lineNumber":903,"author":{"gitId":"-"},"content":"        {"},{"lineNumber":904,"author":{"gitId":"-"},"content":"          name: \u0027Gene Harris\u0027,"},{"lineNumber":905,"author":{"gitId":"-"},"content":"          identifier: \u0027gene-harris-id\u0027,"},{"lineNumber":906,"author":{"gitId":"-"},"content":"        },"},{"lineNumber":907,"author":{"gitId":"-"},"content":"      ],"},{"lineNumber":908,"author":{"gitId":"-"},"content":"    };"},{"lineNumber":909,"author":{"gitId":"-"},"content":"    const testExistingResponses: FeedbackResponses \u003d {"},{"lineNumber":910,"author":{"gitId":"-"},"content":"      responses: [testResponse1, testResponse2],"},{"lineNumber":911,"author":{"gitId":"-"},"content":"    };"},{"lineNumber":912,"author":{"gitId":"-"},"content":""},{"lineNumber":913,"author":{"gitId":"-"},"content":"    const getQuestionsSpy: Spy \u003d spyOn(feedbackQuestionsService, \u0027getFeedbackQuestions\u0027)"},{"lineNumber":914,"author":{"gitId":"-"},"content":"        .and.returnValue(of(testFeedbackQuestions));"},{"lineNumber":915,"author":{"gitId":"-"},"content":"    const loadRecipientsSpy: Spy \u003d spyOn(feedbackQuestionsService, \u0027loadFeedbackQuestionRecipients\u0027)"},{"lineNumber":916,"author":{"gitId":"-"},"content":"        .and.returnValue(of(testFeedbackQuestionRecipients));"},{"lineNumber":917,"author":{"gitId":"-"},"content":"    const getResponseSpy: Spy \u003d spyOn(feedbackResponsesService, \u0027getFeedbackResponse\u0027)"},{"lineNumber":918,"author":{"gitId":"-"},"content":"        .and.returnValue(of(testExistingResponses));"},{"lineNumber":919,"author":{"gitId":"-"},"content":""},{"lineNumber":920,"author":{"gitId":"-"},"content":"    component.loadFeedbackQuestions();"},{"lineNumber":921,"author":{"gitId":"-"},"content":""},{"lineNumber":922,"author":{"gitId":"-"},"content":"    expect(getQuestionsSpy.calls.mostRecent().args[0]).toEqual(getFeedbackSessionArgs);"},{"lineNumber":923,"author":{"gitId":"-"},"content":"    expect(loadRecipientsSpy.calls.mostRecent().args[0].questionId)"},{"lineNumber":924,"author":{"gitId":"-"},"content":"        .toEqual(testMcqQuestionSubmissionForm2.feedbackQuestionId);"},{"lineNumber":925,"author":{"gitId":"-"},"content":"    expect(getResponseSpy.calls.mostRecent().args[0].questionId)"},{"lineNumber":926,"author":{"gitId":"-"},"content":"        .toEqual(testMcqQuestionSubmissionForm2.feedbackQuestionId);"},{"lineNumber":927,"author":{"gitId":"-"},"content":"    expect(component.questionSubmissionForms.length).toEqual(1);"},{"lineNumber":928,"author":{"gitId":"-"},"content":"    expect(component.questionSubmissionForms[0]).toEqual(testMcqQuestionSubmissionForm2);"},{"lineNumber":929,"author":{"gitId":"-"},"content":"    expect(component.hasAnyResponseToSubmit).toEqual(true);"},{"lineNumber":930,"author":{"gitId":"-"},"content":"  });"},{"lineNumber":931,"author":{"gitId":"-"},"content":""},{"lineNumber":932,"author":{"gitId":"-"},"content":"  it(\u0027should check that there are no responses to submit\u0027, () \u003d\u003e {"},{"lineNumber":933,"author":{"gitId":"-"},"content":"    const testSubmissionForm: QuestionSubmissionFormModel \u003d deepCopy(testTextQuestionSubmissionForm);"},{"lineNumber":934,"author":{"gitId":"-"},"content":"    testSubmissionForm.recipientSubmissionForms \u003d [];"},{"lineNumber":935,"author":{"gitId":"-"},"content":"    component.questionSubmissionForms \u003d [testSubmissionForm];"},{"lineNumber":936,"author":{"gitId":"-"},"content":"    expect(component.hasAnyResponseToSubmit).toEqual(false);"},{"lineNumber":937,"author":{"gitId":"-"},"content":"  });"},{"lineNumber":938,"author":{"gitId":"-"},"content":""},{"lineNumber":939,"author":{"gitId":"-"},"content":"  it(\u0027should save feedback responses\u0027, () \u003d\u003e {"},{"lineNumber":940,"author":{"gitId":"-"},"content":"    const mockModalRef: any \u003d { componentInstance: {} };"},{"lineNumber":941,"author":{"gitId":"-"},"content":"    const testResponseDetails1: any \u003d deepCopy(testMcqRecipientSubmissionForm.responseDetails);"},{"lineNumber":942,"author":{"gitId":"-"},"content":"    // leave question unanswered"},{"lineNumber":943,"author":{"gitId":"-"},"content":"    const testResponseDetails2: FeedbackTextResponseDetails \u003d { answer: \u0027\u0027, questionType: FeedbackQuestionType.TEXT };"},{"lineNumber":944,"author":{"gitId":"-"},"content":"    const testQuestionSubmissionForm1: QuestionSubmissionFormModel \u003d deepCopy(testMcqQuestionSubmissionForm);"},{"lineNumber":945,"author":{"gitId":"-"},"content":"    const testQuestionSubmissionForm2: QuestionSubmissionFormModel \u003d deepCopy(testTextQuestionSubmissionForm);"},{"lineNumber":946,"author":{"gitId":"-"},"content":"    testQuestionSubmissionForm1.recipientSubmissionForms[0].responseDetails \u003d testResponseDetails1;"},{"lineNumber":947,"author":{"gitId":"-"},"content":"    testQuestionSubmissionForm2.recipientSubmissionForms[0].responseDetails \u003d testResponseDetails2;"},{"lineNumber":948,"author":{"gitId":"-"},"content":"    component.questionSubmissionForms \u003d [testQuestionSubmissionForm1, testQuestionSubmissionForm2];"},{"lineNumber":949,"author":{"gitId":"-"},"content":""},{"lineNumber":950,"author":{"gitId":"-"},"content":"    const responseSpy: Spy \u003d spyOn(feedbackResponsesService, \u0027submitFeedbackResponses\u0027).and.callFake((id: string) \u003d\u003e {"},{"lineNumber":951,"author":{"gitId":"-"},"content":"      if (id \u003d\u003d\u003d testQuestionSubmissionForm1.feedbackQuestionId) {"},{"lineNumber":952,"author":{"gitId":"-"},"content":"        return of({ responses: [testResponse1], requestId: \u002710\u0027 });"},{"lineNumber":953,"author":{"gitId":"-"},"content":"      }"},{"lineNumber":954,"author":{"gitId":"-"},"content":"      return of({ responses: [testResponse2], requestId: \u002720\u0027 });"},{"lineNumber":955,"author":{"gitId":"-"},"content":"    });"},{"lineNumber":956,"author":{"gitId":"-"},"content":"    spyOn(feedbackResponseCommentService, \u0027createComment\u0027).and.returnValue(of({}));"},{"lineNumber":957,"author":{"gitId":"-"},"content":"    spyOn(feedbackResponseCommentService, \u0027updateComment\u0027).and.returnValue(of({}));"},{"lineNumber":958,"author":{"gitId":"-"},"content":"    spyOn(ngbModal, \u0027open\u0027).and.returnValue(mockModalRef);"},{"lineNumber":959,"author":{"gitId":"-"},"content":""},{"lineNumber":960,"author":{"gitId":"-"},"content":"    component.saveFeedbackResponses();"},{"lineNumber":961,"author":{"gitId":"-"},"content":""},{"lineNumber":962,"author":{"gitId":"-"},"content":"    expect(responseSpy).toBeCalledTimes(2);"},{"lineNumber":963,"author":{"gitId":"-"},"content":"    expect(responseSpy.calls.first().args[0]).toEqual(\u0027feedback-question-id-mcq\u0027);"},{"lineNumber":964,"author":{"gitId":"-"},"content":"    expect(responseSpy.calls.first().args[2].responses[0].responseDetails).toEqual(testResponseDetails1);"},{"lineNumber":965,"author":{"gitId":"-"},"content":"    expect(responseSpy.calls.mostRecent().args[0]).toEqual(\u0027feedback-question-id-text\u0027);"},{"lineNumber":966,"author":{"gitId":"-"},"content":"    expect(responseSpy.calls.mostRecent().args[2].responses).toEqual([]);  // do not call for empty response details"},{"lineNumber":967,"author":{"gitId":"-"},"content":""},{"lineNumber":968,"author":{"gitId":"-"},"content":"    expect(mockModalRef.componentInstance.requestIds).toEqual({"},{"lineNumber":969,"author":{"gitId":"-"},"content":"      \u0027feedback-question-id-mcq\u0027: \u002710\u0027,"},{"lineNumber":970,"author":{"gitId":"-"},"content":"      \u0027feedback-question-id-text\u0027: \u002720\u0027,"},{"lineNumber":971,"author":{"gitId":"-"},"content":"    });"},{"lineNumber":972,"author":{"gitId":"-"},"content":"    expect(mockModalRef.componentInstance.questions).toEqual(["},{"lineNumber":973,"author":{"gitId":"-"},"content":"      testQuestionSubmissionForm1,"},{"lineNumber":974,"author":{"gitId":"-"},"content":"      testQuestionSubmissionForm2,"},{"lineNumber":975,"author":{"gitId":"-"},"content":"    ]);"},{"lineNumber":976,"author":{"gitId":"-"},"content":"    expect(mockModalRef.componentInstance.answers).toEqual({"},{"lineNumber":977,"author":{"gitId":"-"},"content":"      \u0027feedback-question-id-mcq\u0027: [testResponse1],"},{"lineNumber":978,"author":{"gitId":"-"},"content":"      \u0027feedback-question-id-text\u0027: [testResponse2],"},{"lineNumber":979,"author":{"gitId":"-"},"content":"    });"},{"lineNumber":980,"author":{"gitId":"-"},"content":"    expect(mockModalRef.componentInstance.notYetAnsweredQuestions).toHaveLength(1);"},{"lineNumber":981,"author":{"gitId":"-"},"content":"    expect(mockModalRef.componentInstance.failToSaveQuestions).toEqual({});"},{"lineNumber":982,"author":{"gitId":"-"},"content":"  });"},{"lineNumber":983,"author":{"gitId":"-"},"content":""},{"lineNumber":984,"author":{"gitId":"zhaojj2209"},"content":"  it(\u0027should not save invalid feedback responses\u0027, () \u003d\u003e {"},{"lineNumber":985,"author":{"gitId":"zhaojj2209"},"content":"    const mockModalRef: any \u003d { componentInstance: {} };"},{"lineNumber":986,"author":{"gitId":"zhaojj2209"},"content":"    const testResponseDetails1: any \u003d deepCopy(testMcqRecipientSubmissionForm.responseDetails);"},{"lineNumber":987,"author":{"gitId":"zhaojj2209"},"content":"    const testResponseDetails2: any \u003d deepCopy(testConstsumRecipientSubmissionForm.responseDetails);"},{"lineNumber":988,"author":{"gitId":"zhaojj2209"},"content":"    const testQuestionSubmissionForm1: QuestionSubmissionFormModel \u003d deepCopy(testMcqQuestionSubmissionForm);"},{"lineNumber":989,"author":{"gitId":"zhaojj2209"},"content":"    const testQuestionSubmissionForm2: QuestionSubmissionFormModel \u003d deepCopy(testConstsumQuestionSubmissionForm);"},{"lineNumber":990,"author":{"gitId":"zhaojj2209"},"content":"    testQuestionSubmissionForm1.recipientSubmissionForms[0].responseDetails \u003d testResponseDetails1;"},{"lineNumber":991,"author":{"gitId":"zhaojj2209"},"content":"    testQuestionSubmissionForm2.recipientSubmissionForms[0].responseDetails \u003d testResponseDetails2;"},{"lineNumber":992,"author":{"gitId":"zhaojj2209"},"content":"    // invalid response"},{"lineNumber":993,"author":{"gitId":"zhaojj2209"},"content":"    testQuestionSubmissionForm2.recipientSubmissionForms[0].isValid \u003d false;"},{"lineNumber":994,"author":{"gitId":"zhaojj2209"},"content":"    component.questionSubmissionForms \u003d [testQuestionSubmissionForm1, testQuestionSubmissionForm2];"},{"lineNumber":995,"author":{"gitId":"zhaojj2209"},"content":""},{"lineNumber":996,"author":{"gitId":"zhaojj2209"},"content":"    const responseSpy: Spy \u003d spyOn(feedbackResponsesService, \u0027submitFeedbackResponses\u0027).and.callFake(() \u003d\u003e {"},{"lineNumber":997,"author":{"gitId":"zhaojj2209"},"content":"      return of({ responses: [testResponse1], requestId: \u002710\u0027 });"},{"lineNumber":998,"author":{"gitId":"zhaojj2209"},"content":"    });"},{"lineNumber":999,"author":{"gitId":"zhaojj2209"},"content":"    spyOn(feedbackResponseCommentService, \u0027createComment\u0027).and.returnValue(of({}));"},{"lineNumber":1000,"author":{"gitId":"zhaojj2209"},"content":"    spyOn(feedbackResponseCommentService, \u0027updateComment\u0027).and.returnValue(of({}));"},{"lineNumber":1001,"author":{"gitId":"zhaojj2209"},"content":"    spyOn(ngbModal, \u0027open\u0027).and.returnValue(mockModalRef);"},{"lineNumber":1002,"author":{"gitId":"zhaojj2209"},"content":""},{"lineNumber":1003,"author":{"gitId":"zhaojj2209"},"content":"    component.saveFeedbackResponses();"},{"lineNumber":1004,"author":{"gitId":"zhaojj2209"},"content":""},{"lineNumber":1005,"author":{"gitId":"zhaojj2209"},"content":"    expect(responseSpy).toBeCalledTimes(1);"},{"lineNumber":1006,"author":{"gitId":"zhaojj2209"},"content":"    expect(responseSpy.calls.first().args[0]).toEqual(testQuestionSubmissionForm1.feedbackQuestionId);"},{"lineNumber":1007,"author":{"gitId":"zhaojj2209"},"content":"    expect(responseSpy.calls.first().args[2].responses[0].responseDetails).toEqual(testResponseDetails1);"},{"lineNumber":1008,"author":{"gitId":"zhaojj2209"},"content":""},{"lineNumber":1009,"author":{"gitId":"zhaojj2209"},"content":"    // only the valid response is saved"},{"lineNumber":1010,"author":{"gitId":"zhaojj2209"},"content":"    expect(mockModalRef.componentInstance.requestIds).toEqual({"},{"lineNumber":1011,"author":{"gitId":"zhaojj2209"},"content":"      [testQuestionSubmissionForm1.feedbackQuestionId]: \u002710\u0027,"},{"lineNumber":1012,"author":{"gitId":"zhaojj2209"},"content":"    });"},{"lineNumber":1013,"author":{"gitId":"zhaojj2209"},"content":"    expect(mockModalRef.componentInstance.questions).toEqual(["},{"lineNumber":1014,"author":{"gitId":"zhaojj2209"},"content":"      testQuestionSubmissionForm1,"},{"lineNumber":1015,"author":{"gitId":"zhaojj2209"},"content":"      testQuestionSubmissionForm2,"},{"lineNumber":1016,"author":{"gitId":"zhaojj2209"},"content":"    ]);"},{"lineNumber":1017,"author":{"gitId":"zhaojj2209"},"content":"    expect(mockModalRef.componentInstance.answers).toEqual({"},{"lineNumber":1018,"author":{"gitId":"zhaojj2209"},"content":"      [testQuestionSubmissionForm1.feedbackQuestionId]: [testResponse1],"},{"lineNumber":1019,"author":{"gitId":"zhaojj2209"},"content":"    });"},{"lineNumber":1020,"author":{"gitId":"zhaojj2209"},"content":"    expect(mockModalRef.componentInstance.failToSaveQuestions).toEqual({"},{"lineNumber":1021,"author":{"gitId":"zhaojj2209"},"content":"      [testQuestionSubmissionForm2.questionNumber]: \u0027Invalid responses provided. Please check question constraints.\u0027,"},{"lineNumber":1022,"author":{"gitId":"zhaojj2209"},"content":"    });"},{"lineNumber":1023,"author":{"gitId":"zhaojj2209"},"content":"  });"},{"lineNumber":1024,"author":{"gitId":"zhaojj2209"},"content":""},{"lineNumber":1025,"author":{"gitId":"-"},"content":"  it(\u0027should create comment request to create new comment when submission form has no original comment\u0027, () \u003d\u003e {"},{"lineNumber":1026,"author":{"gitId":"-"},"content":"    const testSubmissionForm: FeedbackResponseRecipientSubmissionFormModel \u003d deepCopy(testTextRecipientSubmissionForm);"},{"lineNumber":1027,"author":{"gitId":"-"},"content":"    const commentSpy: Spy \u003d spyOn(feedbackResponseCommentService, \u0027createComment\u0027).and.returnValue(of(testComment));"},{"lineNumber":1028,"author":{"gitId":"-"},"content":""},{"lineNumber":1029,"author":{"gitId":"-"},"content":"    component.createCommentRequest(testSubmissionForm).subscribe(() \u003d\u003e {"},{"lineNumber":1030,"author":{"gitId":"-"},"content":"      expect(testSubmissionForm.commentByGiver).toEqual(component.getCommentModel(testComment));"},{"lineNumber":1031,"author":{"gitId":"-"},"content":"    });"},{"lineNumber":1032,"author":{"gitId":"-"},"content":""},{"lineNumber":1033,"author":{"gitId":"-"},"content":"    expect(commentSpy.calls.count()).toEqual(1);"},{"lineNumber":1034,"author":{"gitId":"-"},"content":"    expect(commentSpy.calls.mostRecent().args[0]).toEqual({"},{"lineNumber":1035,"author":{"gitId":"-"},"content":"      commentText: \u0027comment text here\u0027,"},{"lineNumber":1036,"author":{"gitId":"-"},"content":"      showCommentTo: [],"},{"lineNumber":1037,"author":{"gitId":"-"},"content":"      showGiverNameTo: [],"},{"lineNumber":1038,"author":{"gitId":"-"},"content":"    });"},{"lineNumber":1039,"author":{"gitId":"-"},"content":"    expect(commentSpy.calls.mostRecent().args[1]).toEqual(testTextRecipientSubmissionForm.responseId);"},{"lineNumber":1040,"author":{"gitId":"-"},"content":"    expect(commentSpy.calls.mostRecent().args[2]).toEqual(Intent.STUDENT_SUBMISSION);"},{"lineNumber":1041,"author":{"gitId":"-"},"content":"    expect(commentSpy.calls.mostRecent().args[3]).toEqual({ key: testQueryParams.key, moderatedperson: \u0027\u0027 });"},{"lineNumber":1042,"author":{"gitId":"-"},"content":"  });"},{"lineNumber":1043,"author":{"gitId":"-"},"content":""},{"lineNumber":1044,"author":{"gitId":"-"},"content":"  it(\u0027should create comment request to update existing comment when submission form has original comment\u0027, () \u003d\u003e {"},{"lineNumber":1045,"author":{"gitId":"-"},"content":"    const testSubmissionForm: FeedbackResponseRecipientSubmissionFormModel \u003d deepCopy(testMcqRecipientSubmissionForm);"},{"lineNumber":1046,"author":{"gitId":"-"},"content":"    const expectedId: any \u003d testMcqRecipientSubmissionForm.commentByGiver?.originalComment?.feedbackResponseCommentId;"},{"lineNumber":1047,"author":{"gitId":"-"},"content":"    const commentSpy: Spy \u003d spyOn(feedbackResponseCommentService, \u0027updateComment\u0027).and.returnValue(of(testComment));"},{"lineNumber":1048,"author":{"gitId":"-"},"content":""},{"lineNumber":1049,"author":{"gitId":"-"},"content":"    component.createCommentRequest(testSubmissionForm).subscribe(() \u003d\u003e {"},{"lineNumber":1050,"author":{"gitId":"-"},"content":"      expect(testSubmissionForm.commentByGiver).toEqual(component.getCommentModel(testComment));"},{"lineNumber":1051,"author":{"gitId":"-"},"content":"    });"},{"lineNumber":1052,"author":{"gitId":"-"},"content":""},{"lineNumber":1053,"author":{"gitId":"-"},"content":"    expect(commentSpy.calls.count()).toEqual(1);"},{"lineNumber":1054,"author":{"gitId":"-"},"content":"    expect(commentSpy.calls.mostRecent().args[0]).toEqual({"},{"lineNumber":1055,"author":{"gitId":"-"},"content":"      commentText: \u0027comment text here\u0027,"},{"lineNumber":1056,"author":{"gitId":"-"},"content":"      showCommentTo: [],"},{"lineNumber":1057,"author":{"gitId":"-"},"content":"      showGiverNameTo: [],"},{"lineNumber":1058,"author":{"gitId":"-"},"content":"    });"},{"lineNumber":1059,"author":{"gitId":"-"},"content":"    expect(commentSpy.calls.mostRecent().args[1]).toEqual(expectedId);"},{"lineNumber":1060,"author":{"gitId":"-"},"content":"    expect(commentSpy.calls.mostRecent().args[2]).toEqual(Intent.STUDENT_SUBMISSION);"},{"lineNumber":1061,"author":{"gitId":"-"},"content":"    expect(commentSpy.calls.mostRecent().args[3]).toEqual({ key: testQueryParams.key, moderatedperson: \u0027\u0027 });"},{"lineNumber":1062,"author":{"gitId":"-"},"content":"  });"},{"lineNumber":1063,"author":{"gitId":"-"},"content":""},{"lineNumber":1064,"author":{"gitId":"-"},"content":"  it(\u0027should create comment request to delete existing comment when new comment text is empty\u0027, () \u003d\u003e {"},{"lineNumber":1065,"author":{"gitId":"-"},"content":"    const testSubmissionForm: FeedbackResponseRecipientSubmissionFormModel \u003d deepCopy(testMcqRecipientSubmissionForm2);"},{"lineNumber":1066,"author":{"gitId":"-"},"content":"    const expectedId: any \u003d testMcqRecipientSubmissionForm2.commentByGiver?.originalComment?.feedbackResponseCommentId;"},{"lineNumber":1067,"author":{"gitId":"-"},"content":"    const commentSpy: Spy \u003d spyOn(feedbackResponseCommentService, \u0027deleteComment\u0027).and.returnValue(of({}));"},{"lineNumber":1068,"author":{"gitId":"-"},"content":""},{"lineNumber":1069,"author":{"gitId":"-"},"content":"    component.createCommentRequest(testSubmissionForm).subscribe(() \u003d\u003e {"},{"lineNumber":1070,"author":{"gitId":"-"},"content":"      expect(testSubmissionForm.commentByGiver).toEqual(undefined);"},{"lineNumber":1071,"author":{"gitId":"-"},"content":"    });"},{"lineNumber":1072,"author":{"gitId":"-"},"content":""},{"lineNumber":1073,"author":{"gitId":"-"},"content":"    expect(commentSpy.calls.count()).toEqual(1);"},{"lineNumber":1074,"author":{"gitId":"-"},"content":"    expect(commentSpy.calls.mostRecent().args[0]).toEqual(expectedId);"},{"lineNumber":1075,"author":{"gitId":"-"},"content":"    expect(commentSpy.calls.mostRecent().args[1]).toEqual(Intent.STUDENT_SUBMISSION);"},{"lineNumber":1076,"author":{"gitId":"-"},"content":"    expect(commentSpy.calls.mostRecent().args[2]).toEqual({ key: testQueryParams.key, moderatedperson: \u0027\u0027 });"},{"lineNumber":1077,"author":{"gitId":"-"},"content":"  });"},{"lineNumber":1078,"author":{"gitId":"-"},"content":""},{"lineNumber":1079,"author":{"gitId":"-"},"content":"  it(\u0027should delete participant comment\u0027, () \u003d\u003e {"},{"lineNumber":1080,"author":{"gitId":"-"},"content":"    const testSubmissionForm: QuestionSubmissionFormModel \u003d deepCopy(testMcqQuestionSubmissionForm);"},{"lineNumber":1081,"author":{"gitId":"-"},"content":"    const expectedId: any \u003d testMcqQuestionSubmissionForm.recipientSubmissionForms[0]"},{"lineNumber":1082,"author":{"gitId":"-"},"content":"        .commentByGiver?.originalComment?.feedbackResponseCommentId;"},{"lineNumber":1083,"author":{"gitId":"-"},"content":"    const commentSpy: Spy \u003d spyOn(feedbackResponseCommentService, \u0027deleteComment\u0027).and.returnValue(of(true));"},{"lineNumber":1084,"author":{"gitId":"-"},"content":""},{"lineNumber":1085,"author":{"gitId":"-"},"content":"    component.questionSubmissionForms \u003d [testSubmissionForm];"},{"lineNumber":1086,"author":{"gitId":"-"},"content":"    component.deleteParticipantComment(0, 0);"},{"lineNumber":1087,"author":{"gitId":"-"},"content":""},{"lineNumber":1088,"author":{"gitId":"-"},"content":"    expect(commentSpy.calls.count()).toEqual(1);"},{"lineNumber":1089,"author":{"gitId":"-"},"content":"    expect(commentSpy.calls.mostRecent().args[0]).toEqual(expectedId);"},{"lineNumber":1090,"author":{"gitId":"-"},"content":"    expect(commentSpy.calls.mostRecent().args[1]).toEqual(Intent.STUDENT_SUBMISSION);"},{"lineNumber":1091,"author":{"gitId":"-"},"content":"    expect(commentSpy.calls.mostRecent().args[2]).toEqual({ key: testQueryParams.key, moderatedperson: \u0027\u0027 });"},{"lineNumber":1092,"author":{"gitId":"-"},"content":"  });"},{"lineNumber":1093,"author":{"gitId":"-"},"content":"});"}],"authorContributionMap":{"zhaojj2209":41,"-":1052}},{"path":"src/web/app/pages-session/session-submission-page/session-submission-page.component.ts","fileType":"ts","lines":[{"lineNumber":1,"author":{"gitId":"-"},"content":"import { DOCUMENT } from \u0027@angular/common\u0027;"},{"lineNumber":2,"author":{"gitId":"-"},"content":"import { AfterViewInit, Component, Inject, OnInit } from \u0027@angular/core\u0027;"},{"lineNumber":3,"author":{"gitId":"-"},"content":"import { ActivatedRoute, Router } from \u0027@angular/router\u0027;"},{"lineNumber":4,"author":{"gitId":"-"},"content":"import { NgbModal, NgbModalRef } from \u0027@ng-bootstrap/ng-bootstrap\u0027;"},{"lineNumber":5,"author":{"gitId":"-"},"content":"import { PageScrollService } from \u0027ngx-page-scroll-core\u0027;"},{"lineNumber":6,"author":{"gitId":"-"},"content":"import { forkJoin, Observable, of } from \u0027rxjs\u0027;"},{"lineNumber":7,"author":{"gitId":"-"},"content":"import { catchError, finalize, switchMap, tap } from \u0027rxjs/operators\u0027;"},{"lineNumber":8,"author":{"gitId":"-"},"content":"import { environment } from \u0027../../../environments/environment\u0027;"},{"lineNumber":9,"author":{"gitId":"-"},"content":"import { AuthService } from \u0027../../../services/auth.service\u0027;"},{"lineNumber":10,"author":{"gitId":"-"},"content":"import { FeedbackQuestionsService } from \u0027../../../services/feedback-questions.service\u0027;"},{"lineNumber":11,"author":{"gitId":"-"},"content":"import { FeedbackResponseCommentService } from \u0027../../../services/feedback-response-comment.service\u0027;"},{"lineNumber":12,"author":{"gitId":"-"},"content":"import { FeedbackResponsesService } from \u0027../../../services/feedback-responses.service\u0027;"},{"lineNumber":13,"author":{"gitId":"-"},"content":"import { FeedbackSessionsService } from \u0027../../../services/feedback-sessions.service\u0027;"},{"lineNumber":14,"author":{"gitId":"-"},"content":"import { InstructorService } from \u0027../../../services/instructor.service\u0027;"},{"lineNumber":15,"author":{"gitId":"-"},"content":"import { LogService } from \u0027../../../services/log.service\u0027;"},{"lineNumber":16,"author":{"gitId":"-"},"content":"import { NavigationService } from \u0027../../../services/navigation.service\u0027;"},{"lineNumber":17,"author":{"gitId":"-"},"content":"import { SimpleModalService } from \u0027../../../services/simple-modal.service\u0027;"},{"lineNumber":18,"author":{"gitId":"-"},"content":"import { StatusMessageService } from \u0027../../../services/status-message.service\u0027;"},{"lineNumber":19,"author":{"gitId":"-"},"content":"import { StudentService } from \u0027../../../services/student.service\u0027;"},{"lineNumber":20,"author":{"gitId":"-"},"content":"import { TimezoneService } from \u0027../../../services/timezone.service\u0027;"},{"lineNumber":21,"author":{"gitId":"-"},"content":"import {"},{"lineNumber":22,"author":{"gitId":"-"},"content":"  AuthInfo,"},{"lineNumber":23,"author":{"gitId":"-"},"content":"  FeedbackParticipantType,"},{"lineNumber":24,"author":{"gitId":"-"},"content":"  FeedbackQuestion,"},{"lineNumber":25,"author":{"gitId":"-"},"content":"  FeedbackQuestionRecipient,"},{"lineNumber":26,"author":{"gitId":"-"},"content":"  FeedbackQuestionRecipients,"},{"lineNumber":27,"author":{"gitId":"-"},"content":"  FeedbackResponse,"},{"lineNumber":28,"author":{"gitId":"-"},"content":"  FeedbackResponseComment,"},{"lineNumber":29,"author":{"gitId":"-"},"content":"  FeedbackResponses,"},{"lineNumber":30,"author":{"gitId":"-"},"content":"  FeedbackSession,"},{"lineNumber":31,"author":{"gitId":"-"},"content":"  FeedbackSessionLogType,"},{"lineNumber":32,"author":{"gitId":"-"},"content":"  FeedbackSessionSubmissionStatus,"},{"lineNumber":33,"author":{"gitId":"-"},"content":"  Instructor,"},{"lineNumber":34,"author":{"gitId":"-"},"content":"  NumberOfEntitiesToGiveFeedbackToSetting,"},{"lineNumber":35,"author":{"gitId":"-"},"content":"  RegkeyValidity,"},{"lineNumber":36,"author":{"gitId":"-"},"content":"  Student,"},{"lineNumber":37,"author":{"gitId":"-"},"content":"} from \u0027../../../types/api-output\u0027;"},{"lineNumber":38,"author":{"gitId":"-"},"content":"import { FeedbackResponseRequest, Intent } from \u0027../../../types/api-request\u0027;"},{"lineNumber":39,"author":{"gitId":"-"},"content":"import { DEFAULT_NUMBER_OF_RETRY_ATTEMPTS } from \u0027../../../types/default-retry-attempts\u0027;"},{"lineNumber":40,"author":{"gitId":"-"},"content":"import { CommentRowModel } from \u0027../../components/comment-box/comment-row/comment-row.component\u0027;"},{"lineNumber":41,"author":{"gitId":"-"},"content":"import { ErrorReportComponent } from \u0027../../components/error-report/error-report.component\u0027;"},{"lineNumber":42,"author":{"gitId":"-"},"content":"import {"},{"lineNumber":43,"author":{"gitId":"-"},"content":"  FeedbackResponseRecipient,"},{"lineNumber":44,"author":{"gitId":"-"},"content":"  FeedbackResponseRecipientSubmissionFormModel,"},{"lineNumber":45,"author":{"gitId":"-"},"content":"  QuestionSubmissionFormMode,"},{"lineNumber":46,"author":{"gitId":"-"},"content":"  QuestionSubmissionFormModel,"},{"lineNumber":47,"author":{"gitId":"-"},"content":"} from \u0027../../components/question-submission-form/question-submission-form-model\u0027;"},{"lineNumber":48,"author":{"gitId":"-"},"content":"import { SimpleModalType } from \u0027../../components/simple-modal/simple-modal-type\u0027;"},{"lineNumber":49,"author":{"gitId":"-"},"content":"import { ErrorMessageOutput } from \u0027../../error-message-output\u0027;"},{"lineNumber":50,"author":{"gitId":"-"},"content":"import { SavingCompleteModalComponent } from \u0027./saving-complete-modal/saving-complete-modal.component\u0027;"},{"lineNumber":51,"author":{"gitId":"-"},"content":""},{"lineNumber":52,"author":{"gitId":"-"},"content":"interface FeedbackQuestionsResponse {"},{"lineNumber":53,"author":{"gitId":"-"},"content":"  questions: FeedbackQuestion[];"},{"lineNumber":54,"author":{"gitId":"-"},"content":"}"},{"lineNumber":55,"author":{"gitId":"-"},"content":""},{"lineNumber":56,"author":{"gitId":"-"},"content":"/**"},{"lineNumber":57,"author":{"gitId":"-"},"content":" * A collection of feedback responses."},{"lineNumber":58,"author":{"gitId":"-"},"content":" */"},{"lineNumber":59,"author":{"gitId":"-"},"content":"export interface FeedbackResponsesResponse {"},{"lineNumber":60,"author":{"gitId":"-"},"content":"  responses: FeedbackResponse[];"},{"lineNumber":61,"author":{"gitId":"-"},"content":"}"},{"lineNumber":62,"author":{"gitId":"-"},"content":""},{"lineNumber":63,"author":{"gitId":"-"},"content":"/**"},{"lineNumber":64,"author":{"gitId":"-"},"content":" * Feedback session submission page."},{"lineNumber":65,"author":{"gitId":"-"},"content":" */"},{"lineNumber":66,"author":{"gitId":"-"},"content":"@Component({"},{"lineNumber":67,"author":{"gitId":"-"},"content":"  selector: \u0027tm-session-submission-page\u0027,"},{"lineNumber":68,"author":{"gitId":"-"},"content":"  templateUrl: \u0027./session-submission-page.component.html\u0027,"},{"lineNumber":69,"author":{"gitId":"-"},"content":"  styleUrls: [\u0027./session-submission-page.component.scss\u0027],"},{"lineNumber":70,"author":{"gitId":"-"},"content":"})"},{"lineNumber":71,"author":{"gitId":"-"},"content":"export class SessionSubmissionPageComponent implements OnInit, AfterViewInit {"},{"lineNumber":72,"author":{"gitId":"-"},"content":""},{"lineNumber":73,"author":{"gitId":"-"},"content":"  // enum"},{"lineNumber":74,"author":{"gitId":"-"},"content":"  FeedbackSessionSubmissionStatus: typeof FeedbackSessionSubmissionStatus \u003d FeedbackSessionSubmissionStatus;"},{"lineNumber":75,"author":{"gitId":"-"},"content":"  Intent: typeof Intent \u003d Intent;"},{"lineNumber":76,"author":{"gitId":"-"},"content":""},{"lineNumber":77,"author":{"gitId":"-"},"content":"  courseId: string \u003d \u0027\u0027;"},{"lineNumber":78,"author":{"gitId":"-"},"content":"  feedbackSessionName: string \u003d \u0027\u0027;"},{"lineNumber":79,"author":{"gitId":"-"},"content":"  regKey: string \u003d \u0027\u0027;"},{"lineNumber":80,"author":{"gitId":"-"},"content":"  entityType: string \u003d \u0027student\u0027;"},{"lineNumber":81,"author":{"gitId":"-"},"content":"  loggedInUser: string \u003d \u0027\u0027;"},{"lineNumber":82,"author":{"gitId":"-"},"content":""},{"lineNumber":83,"author":{"gitId":"-"},"content":"  moderatedPerson: string \u003d \u0027\u0027;"},{"lineNumber":84,"author":{"gitId":"-"},"content":"  previewAsPerson: string \u003d \u0027\u0027;"},{"lineNumber":85,"author":{"gitId":"-"},"content":"  // the name of the person involved"},{"lineNumber":86,"author":{"gitId":"-"},"content":"  // (e.g. the student name for unregistered student, the name of instructor being moderated)"},{"lineNumber":87,"author":{"gitId":"-"},"content":"  personName: string \u003d \u0027\u0027;"},{"lineNumber":88,"author":{"gitId":"-"},"content":"  personEmail: string \u003d \u0027\u0027;"},{"lineNumber":89,"author":{"gitId":"-"},"content":""},{"lineNumber":90,"author":{"gitId":"-"},"content":"  formattedSessionOpeningTime: string \u003d \u0027\u0027;"},{"lineNumber":91,"author":{"gitId":"-"},"content":"  formattedSessionClosingTime: string \u003d \u0027\u0027;"},{"lineNumber":92,"author":{"gitId":"-"},"content":"  feedbackSessionInstructions: string \u003d \u0027\u0027;"},{"lineNumber":93,"author":{"gitId":"-"},"content":"  feedbackSessionTimezone: string \u003d \u0027\u0027;"},{"lineNumber":94,"author":{"gitId":"-"},"content":"  feedbackSessionSubmissionStatus: FeedbackSessionSubmissionStatus \u003d FeedbackSessionSubmissionStatus.OPEN;"},{"lineNumber":95,"author":{"gitId":"-"},"content":""},{"lineNumber":96,"author":{"gitId":"-"},"content":"  intent: Intent \u003d Intent.STUDENT_SUBMISSION;"},{"lineNumber":97,"author":{"gitId":"-"},"content":""},{"lineNumber":98,"author":{"gitId":"-"},"content":"  questionSubmissionForms: QuestionSubmissionFormModel[] \u003d [];"},{"lineNumber":99,"author":{"gitId":"-"},"content":""},{"lineNumber":100,"author":{"gitId":"-"},"content":"  isSavingResponses: boolean \u003d false;"},{"lineNumber":101,"author":{"gitId":"-"},"content":"  isSubmissionFormsDisabled: boolean \u003d false;"},{"lineNumber":102,"author":{"gitId":"-"},"content":""},{"lineNumber":103,"author":{"gitId":"-"},"content":"  isModerationHintExpanded: boolean \u003d false;"},{"lineNumber":104,"author":{"gitId":"-"},"content":"  moderatedQuestionId: string \u003d \u0027\u0027;"},{"lineNumber":105,"author":{"gitId":"-"},"content":""},{"lineNumber":106,"author":{"gitId":"-"},"content":"  isFeedbackSessionLoading: boolean \u003d true;"},{"lineNumber":107,"author":{"gitId":"-"},"content":"  isFeedbackSessionQuestionsLoading: boolean \u003d true;"},{"lineNumber":108,"author":{"gitId":"-"},"content":"  hasFeedbackSessionQuestionsLoadingFailed: boolean \u003d false;"},{"lineNumber":109,"author":{"gitId":"-"},"content":"  isFeedbackSessionQuestionResponsesLoading: boolean \u003d true;"},{"lineNumber":110,"author":{"gitId":"-"},"content":"  retryAttempts: number \u003d DEFAULT_NUMBER_OF_RETRY_ATTEMPTS;"},{"lineNumber":111,"author":{"gitId":"-"},"content":""},{"lineNumber":112,"author":{"gitId":"-"},"content":"  private backendUrl: string \u003d environment.backendUrl;"},{"lineNumber":113,"author":{"gitId":"-"},"content":""},{"lineNumber":114,"author":{"gitId":"-"},"content":"  constructor(private route: ActivatedRoute,"},{"lineNumber":115,"author":{"gitId":"-"},"content":"              private router: Router,"},{"lineNumber":116,"author":{"gitId":"-"},"content":"              private statusMessageService: StatusMessageService,"},{"lineNumber":117,"author":{"gitId":"-"},"content":"              private timezoneService: TimezoneService,"},{"lineNumber":118,"author":{"gitId":"-"},"content":"              private feedbackQuestionsService: FeedbackQuestionsService,"},{"lineNumber":119,"author":{"gitId":"-"},"content":"              private feedbackResponsesService: FeedbackResponsesService,"},{"lineNumber":120,"author":{"gitId":"-"},"content":"              private feedbackSessionsService: FeedbackSessionsService,"},{"lineNumber":121,"author":{"gitId":"-"},"content":"              private studentService: StudentService,"},{"lineNumber":122,"author":{"gitId":"-"},"content":"              private instructorService: InstructorService,"},{"lineNumber":123,"author":{"gitId":"-"},"content":"              private ngbModal: NgbModal,"},{"lineNumber":124,"author":{"gitId":"-"},"content":"              private simpleModalService: SimpleModalService,"},{"lineNumber":125,"author":{"gitId":"-"},"content":"              private pageScrollService: PageScrollService,"},{"lineNumber":126,"author":{"gitId":"-"},"content":"              private authService: AuthService,"},{"lineNumber":127,"author":{"gitId":"-"},"content":"              private navigationService: NavigationService,"},{"lineNumber":128,"author":{"gitId":"-"},"content":"              private commentService: FeedbackResponseCommentService,"},{"lineNumber":129,"author":{"gitId":"-"},"content":"              private logService: LogService,"},{"lineNumber":130,"author":{"gitId":"-"},"content":"              @Inject(DOCUMENT) private document: any) {"},{"lineNumber":131,"author":{"gitId":"-"},"content":"    this.timezoneService.getTzVersion(); // import timezone service to load timezone data"},{"lineNumber":132,"author":{"gitId":"-"},"content":"  }"},{"lineNumber":133,"author":{"gitId":"-"},"content":""},{"lineNumber":134,"author":{"gitId":"-"},"content":"  ngOnInit(): void {"},{"lineNumber":135,"author":{"gitId":"-"},"content":"    this.route.data.pipe("},{"lineNumber":136,"author":{"gitId":"-"},"content":"        tap((data: any) \u003d\u003e {"},{"lineNumber":137,"author":{"gitId":"-"},"content":"          this.intent \u003d data.intent;"},{"lineNumber":138,"author":{"gitId":"-"},"content":"        }),"},{"lineNumber":139,"author":{"gitId":"-"},"content":"        switchMap(() \u003d\u003e this.route.queryParams),"},{"lineNumber":140,"author":{"gitId":"-"},"content":"    ).subscribe((queryParams: any) \u003d\u003e {"},{"lineNumber":141,"author":{"gitId":"-"},"content":"      this.courseId \u003d queryParams.courseid;"},{"lineNumber":142,"author":{"gitId":"-"},"content":"      this.feedbackSessionName \u003d queryParams.fsname;"},{"lineNumber":143,"author":{"gitId":"-"},"content":"      this.regKey \u003d queryParams.key ? queryParams.key : \u0027\u0027;"},{"lineNumber":144,"author":{"gitId":"-"},"content":"      this.moderatedPerson \u003d queryParams.moderatedperson ? queryParams.moderatedperson : \u0027\u0027;"},{"lineNumber":145,"author":{"gitId":"-"},"content":"      this.previewAsPerson \u003d queryParams.previewas ? queryParams.previewas : \u0027\u0027;"},{"lineNumber":146,"author":{"gitId":"-"},"content":"      if (queryParams.entitytype \u003d\u003d\u003d \u0027instructor\u0027) {"},{"lineNumber":147,"author":{"gitId":"-"},"content":"        this.entityType \u003d \u0027instructor\u0027;"},{"lineNumber":148,"author":{"gitId":"-"},"content":"        this.intent \u003d Intent.INSTRUCTOR_SUBMISSION;"},{"lineNumber":149,"author":{"gitId":"-"},"content":"      }"},{"lineNumber":150,"author":{"gitId":"-"},"content":"      this.moderatedQuestionId \u003d queryParams.moderatedquestionId ? queryParams.moderatedquestionId : \u0027\u0027;"},{"lineNumber":151,"author":{"gitId":"-"},"content":""},{"lineNumber":152,"author":{"gitId":"-"},"content":"      if (this.previewAsPerson) {"},{"lineNumber":153,"author":{"gitId":"-"},"content":"        // disable submission in the preview mode"},{"lineNumber":154,"author":{"gitId":"-"},"content":"        this.isSubmissionFormsDisabled \u003d true;"},{"lineNumber":155,"author":{"gitId":"-"},"content":"      }"},{"lineNumber":156,"author":{"gitId":"-"},"content":""},{"lineNumber":157,"author":{"gitId":"-"},"content":"      const nextUrl: string \u003d `${window.location.pathname}${window.location.search.replace(/\u0026/g, \u0027%26\u0027)}`;"},{"lineNumber":158,"author":{"gitId":"-"},"content":"      this.authService.getAuthUser(undefined, nextUrl).subscribe((auth: AuthInfo) \u003d\u003e {"},{"lineNumber":159,"author":{"gitId":"-"},"content":"        const isPreviewOrModeration: boolean \u003d !!(auth.user \u0026\u0026 (this.moderatedPerson || this.previewAsPerson));"},{"lineNumber":160,"author":{"gitId":"-"},"content":"        if (auth.user) {"},{"lineNumber":161,"author":{"gitId":"-"},"content":"          this.loggedInUser \u003d auth.user.id;"},{"lineNumber":162,"author":{"gitId":"-"},"content":"        }"},{"lineNumber":163,"author":{"gitId":"-"},"content":"        if (this.regKey \u0026\u0026 !isPreviewOrModeration) {"},{"lineNumber":164,"author":{"gitId":"-"},"content":"          this.authService.getAuthRegkeyValidity(this.regKey, this.intent).subscribe((resp: RegkeyValidity) \u003d\u003e {"},{"lineNumber":165,"author":{"gitId":"-"},"content":"            if (resp.isAllowedAccess) {"},{"lineNumber":166,"author":{"gitId":"-"},"content":"              if (resp.isUsed) {"},{"lineNumber":167,"author":{"gitId":"-"},"content":"                // The logged in user matches the registration key; redirect to the logged in URL"},{"lineNumber":168,"author":{"gitId":"-"},"content":""},{"lineNumber":169,"author":{"gitId":"-"},"content":"                this.navigationService.navigateByURLWithParamEncoding(this.router, `/web/${this.entityType}/sessions/submission`,"},{"lineNumber":170,"author":{"gitId":"-"},"content":"                    { courseid: this.courseId, fsname: this.feedbackSessionName });"},{"lineNumber":171,"author":{"gitId":"-"},"content":"              } else {"},{"lineNumber":172,"author":{"gitId":"-"},"content":"                // Valid, unused registration key; load information based on the key"},{"lineNumber":173,"author":{"gitId":"-"},"content":"                this.loadPersonName();"},{"lineNumber":174,"author":{"gitId":"-"},"content":"                this.loadFeedbackSession();"},{"lineNumber":175,"author":{"gitId":"-"},"content":"              }"},{"lineNumber":176,"author":{"gitId":"-"},"content":"            } else if (resp.isValid) {"},{"lineNumber":177,"author":{"gitId":"-"},"content":"              // At this point, registration key must already be used, otherwise access would be granted"},{"lineNumber":178,"author":{"gitId":"-"},"content":"              if (this.loggedInUser) {"},{"lineNumber":179,"author":{"gitId":"-"},"content":"                // Registration key belongs to another user who is not the logged in user"},{"lineNumber":180,"author":{"gitId":"-"},"content":"                this.navigationService.navigateWithErrorMessage(this.router, \u0027/web/front\u0027,"},{"lineNumber":181,"author":{"gitId":"-"},"content":"                    `You are trying to access TEAMMATES using the Google account ${this.loggedInUser}, which"},{"lineNumber":182,"author":{"gitId":"-"},"content":"                    is not linked to this TEAMMATES account. If you used a different Google account to"},{"lineNumber":183,"author":{"gitId":"-"},"content":"                    join/access TEAMMATES before, please use that Google account to access TEAMMATES. If you"},{"lineNumber":184,"author":{"gitId":"-"},"content":"                    cannot remember which Google account you used before, please email us at"},{"lineNumber":185,"author":{"gitId":"-"},"content":"                    ${environment.supportEmail} for help.`);"},{"lineNumber":186,"author":{"gitId":"-"},"content":"              } else {"},{"lineNumber":187,"author":{"gitId":"-"},"content":"                // There is no logged in user for a valid, used registration key, redirect to login page"},{"lineNumber":188,"author":{"gitId":"-"},"content":"                if (this.entityType \u003d\u003d\u003d \u0027student\u0027) {"},{"lineNumber":189,"author":{"gitId":"-"},"content":"                  window.location.href \u003d `${this.backendUrl}${auth.studentLoginUrl}`;"},{"lineNumber":190,"author":{"gitId":"-"},"content":"                } else if (this.entityType \u003d\u003d\u003d \u0027instructor\u0027) {"},{"lineNumber":191,"author":{"gitId":"-"},"content":"                  window.location.href \u003d `${this.backendUrl}${auth.instructorLoginUrl}`;"},{"lineNumber":192,"author":{"gitId":"-"},"content":"                }"},{"lineNumber":193,"author":{"gitId":"-"},"content":"              }"},{"lineNumber":194,"author":{"gitId":"-"},"content":"            } else {"},{"lineNumber":195,"author":{"gitId":"-"},"content":"              // The registration key is invalid"},{"lineNumber":196,"author":{"gitId":"-"},"content":"              this.navigationService.navigateWithErrorMessage(this.router, \u0027/web/front\u0027,"},{"lineNumber":197,"author":{"gitId":"-"},"content":"                  \u0027You are not authorized to view this page.\u0027);"},{"lineNumber":198,"author":{"gitId":"-"},"content":"            }"},{"lineNumber":199,"author":{"gitId":"-"},"content":"          }, () \u003d\u003e {"},{"lineNumber":200,"author":{"gitId":"-"},"content":"            this.navigationService.navigateWithErrorMessage(this.router, \u0027/web/front\u0027,"},{"lineNumber":201,"author":{"gitId":"-"},"content":"                \u0027You are not authorized to view this page.\u0027);"},{"lineNumber":202,"author":{"gitId":"-"},"content":"          });"},{"lineNumber":203,"author":{"gitId":"-"},"content":"        } else if (this.loggedInUser) {"},{"lineNumber":204,"author":{"gitId":"-"},"content":"          // Load information based on logged in user"},{"lineNumber":205,"author":{"gitId":"-"},"content":"          // This will also cover moderation/preview cases"},{"lineNumber":206,"author":{"gitId":"-"},"content":"          this.loadPersonName();"},{"lineNumber":207,"author":{"gitId":"-"},"content":"          this.loadFeedbackSession();"},{"lineNumber":208,"author":{"gitId":"-"},"content":"        } else {"},{"lineNumber":209,"author":{"gitId":"-"},"content":"          this.navigationService.navigateWithErrorMessage(this.router, \u0027/web/front\u0027,"},{"lineNumber":210,"author":{"gitId":"-"},"content":"              \u0027You are not authorized to view this page.\u0027);"},{"lineNumber":211,"author":{"gitId":"-"},"content":"        }"},{"lineNumber":212,"author":{"gitId":"-"},"content":"      }, () \u003d\u003e {"},{"lineNumber":213,"author":{"gitId":"-"},"content":"        this.navigationService.navigateWithErrorMessage(this.router, \u0027/web/front\u0027,"},{"lineNumber":214,"author":{"gitId":"-"},"content":"            \u0027You are not authorized to view this page.\u0027);"},{"lineNumber":215,"author":{"gitId":"-"},"content":"      });"},{"lineNumber":216,"author":{"gitId":"-"},"content":"    });"},{"lineNumber":217,"author":{"gitId":"-"},"content":"  }"},{"lineNumber":218,"author":{"gitId":"-"},"content":""},{"lineNumber":219,"author":{"gitId":"-"},"content":"  // Solution for checking partial element visibility adapted from"},{"lineNumber":220,"author":{"gitId":"-"},"content":"  // https://stackoverflow.com/questions/30943662/check-if-element-is-partially-in-viewport"},{"lineNumber":221,"author":{"gitId":"-"},"content":"  /**"},{"lineNumber":222,"author":{"gitId":"-"},"content":"   * Checks if a given element is in view."},{"lineNumber":223,"author":{"gitId":"-"},"content":"   *"},{"lineNumber":224,"author":{"gitId":"-"},"content":"   * @params e element to perform check for"},{"lineNumber":225,"author":{"gitId":"-"},"content":"   */"},{"lineNumber":226,"author":{"gitId":"-"},"content":"  isInViewport(e: HTMLElement): boolean {"},{"lineNumber":227,"author":{"gitId":"-"},"content":"    const rect: ClientRect \u003d e.getBoundingClientRect();"},{"lineNumber":228,"author":{"gitId":"-"},"content":"    const windowHeight: number \u003d (window.innerHeight || document.documentElement.clientHeight);"},{"lineNumber":229,"author":{"gitId":"-"},"content":""},{"lineNumber":230,"author":{"gitId":"-"},"content":"    return !("},{"lineNumber":231,"author":{"gitId":"-"},"content":"      Math.floor(100 - (((rect.top \u003e\u003d 0 ? 0 : rect.top) / +-rect.height) * 100)) \u003c 1 ||"},{"lineNumber":232,"author":{"gitId":"-"},"content":"      Math.floor(100 - ((rect.bottom - windowHeight) / rect.height) * 100) \u003c 1"},{"lineNumber":233,"author":{"gitId":"-"},"content":"    );"},{"lineNumber":234,"author":{"gitId":"-"},"content":"  }"},{"lineNumber":235,"author":{"gitId":"-"},"content":""},{"lineNumber":236,"author":{"gitId":"-"},"content":"  /**"},{"lineNumber":237,"author":{"gitId":"-"},"content":"   * Scrolls to the question based on its given question id."},{"lineNumber":238,"author":{"gitId":"-"},"content":"   */"},{"lineNumber":239,"author":{"gitId":"-"},"content":"  scrollToQuestion(): void {"},{"lineNumber":240,"author":{"gitId":"-"},"content":"    const div: HTMLElement | null \u003d document.getElementById(this.moderatedQuestionId);"},{"lineNumber":241,"author":{"gitId":"-"},"content":""},{"lineNumber":242,"author":{"gitId":"-"},"content":"    // continue scrolling as long as the element to scroll to is yet to be found or not in view"},{"lineNumber":243,"author":{"gitId":"-"},"content":"    if (div \u003d\u003d null || !(this.isInViewport(div))) {"},{"lineNumber":244,"author":{"gitId":"-"},"content":"      setTimeout(() \u003d\u003e {"},{"lineNumber":245,"author":{"gitId":"-"},"content":"        this.pageScrollService.scroll({"},{"lineNumber":246,"author":{"gitId":"-"},"content":"          document: this.document,"},{"lineNumber":247,"author":{"gitId":"-"},"content":"          scrollTarget: `#${this.moderatedQuestionId}`,"},{"lineNumber":248,"author":{"gitId":"-"},"content":"          scrollOffset: 70,"},{"lineNumber":249,"author":{"gitId":"-"},"content":"        });"},{"lineNumber":250,"author":{"gitId":"-"},"content":"        this.scrollToQuestion();"},{"lineNumber":251,"author":{"gitId":"-"},"content":"      }, 500);"},{"lineNumber":252,"author":{"gitId":"-"},"content":"    }"},{"lineNumber":253,"author":{"gitId":"-"},"content":"  }"},{"lineNumber":254,"author":{"gitId":"-"},"content":""},{"lineNumber":255,"author":{"gitId":"-"},"content":"  ngAfterViewInit(): void {"},{"lineNumber":256,"author":{"gitId":"-"},"content":"    if (!this.moderatedQuestionId) {"},{"lineNumber":257,"author":{"gitId":"-"},"content":"      return;"},{"lineNumber":258,"author":{"gitId":"-"},"content":"    }"},{"lineNumber":259,"author":{"gitId":"-"},"content":"    this.scrollToQuestion();"},{"lineNumber":260,"author":{"gitId":"-"},"content":"  }"},{"lineNumber":261,"author":{"gitId":"-"},"content":""},{"lineNumber":262,"author":{"gitId":"-"},"content":"  /**"},{"lineNumber":263,"author":{"gitId":"-"},"content":"   * Loads the name of the person involved in the submission."},{"lineNumber":264,"author":{"gitId":"-"},"content":"   */"},{"lineNumber":265,"author":{"gitId":"-"},"content":"  loadPersonName(): void {"},{"lineNumber":266,"author":{"gitId":"-"},"content":"    switch (this.intent) {"},{"lineNumber":267,"author":{"gitId":"-"},"content":"      case Intent.STUDENT_SUBMISSION:"},{"lineNumber":268,"author":{"gitId":"-"},"content":"        this.studentService.getStudent("},{"lineNumber":269,"author":{"gitId":"-"},"content":"            this.courseId,"},{"lineNumber":270,"author":{"gitId":"-"},"content":"            this.moderatedPerson || this.previewAsPerson,"},{"lineNumber":271,"author":{"gitId":"-"},"content":"            this.regKey,"},{"lineNumber":272,"author":{"gitId":"-"},"content":"        ).subscribe((student: Student) \u003d\u003e {"},{"lineNumber":273,"author":{"gitId":"-"},"content":"          this.personName \u003d student.name;"},{"lineNumber":274,"author":{"gitId":"-"},"content":"          this.personEmail \u003d student.email;"},{"lineNumber":275,"author":{"gitId":"-"},"content":""},{"lineNumber":276,"author":{"gitId":"-"},"content":"          this.logService.createFeedbackSessionLog({"},{"lineNumber":277,"author":{"gitId":"-"},"content":"            courseId: this.courseId,"},{"lineNumber":278,"author":{"gitId":"-"},"content":"            feedbackSessionName: this.feedbackSessionName,"},{"lineNumber":279,"author":{"gitId":"-"},"content":"            studentEmail: this.personEmail,"},{"lineNumber":280,"author":{"gitId":"-"},"content":"            logType: FeedbackSessionLogType.ACCESS,"},{"lineNumber":281,"author":{"gitId":"-"},"content":"          }).subscribe(() \u003d\u003e {"},{"lineNumber":282,"author":{"gitId":"-"},"content":""},{"lineNumber":283,"author":{"gitId":"-"},"content":"          }, () \u003d\u003e {"},{"lineNumber":284,"author":{"gitId":"-"},"content":"            this.statusMessageService.showWarningToast(\u0027Failed to log feedback session access\u0027);"},{"lineNumber":285,"author":{"gitId":"-"},"content":"          });"},{"lineNumber":286,"author":{"gitId":"-"},"content":""},{"lineNumber":287,"author":{"gitId":"-"},"content":"        });"},{"lineNumber":288,"author":{"gitId":"-"},"content":"        break;"},{"lineNumber":289,"author":{"gitId":"-"},"content":"      case Intent.INSTRUCTOR_SUBMISSION:"},{"lineNumber":290,"author":{"gitId":"-"},"content":"        this.instructorService.getInstructor({"},{"lineNumber":291,"author":{"gitId":"-"},"content":"          courseId: this.courseId,"},{"lineNumber":292,"author":{"gitId":"-"},"content":"          feedbackSessionName: this.feedbackSessionName,"},{"lineNumber":293,"author":{"gitId":"-"},"content":"          intent: this.intent,"},{"lineNumber":294,"author":{"gitId":"-"},"content":"          key: this.regKey,"},{"lineNumber":295,"author":{"gitId":"-"},"content":"          moderatedPerson: this.moderatedPerson,"},{"lineNumber":296,"author":{"gitId":"-"},"content":"          previewAs: this.previewAsPerson,"},{"lineNumber":297,"author":{"gitId":"-"},"content":"        }).subscribe((instructor: Instructor) \u003d\u003e {"},{"lineNumber":298,"author":{"gitId":"-"},"content":"          this.personName \u003d instructor.name;"},{"lineNumber":299,"author":{"gitId":"-"},"content":"          this.personEmail \u003d instructor.email;"},{"lineNumber":300,"author":{"gitId":"-"},"content":"        });"},{"lineNumber":301,"author":{"gitId":"-"},"content":"        break;"},{"lineNumber":302,"author":{"gitId":"-"},"content":"      default:"},{"lineNumber":303,"author":{"gitId":"-"},"content":"    }"},{"lineNumber":304,"author":{"gitId":"-"},"content":"  }"},{"lineNumber":305,"author":{"gitId":"-"},"content":""},{"lineNumber":306,"author":{"gitId":"-"},"content":"  /**"},{"lineNumber":307,"author":{"gitId":"-"},"content":"   * Redirects to join course link for unregistered student/instructor."},{"lineNumber":308,"author":{"gitId":"-"},"content":"   */"},{"lineNumber":309,"author":{"gitId":"-"},"content":"  joinCourseForUnregisteredEntity(): void {"},{"lineNumber":310,"author":{"gitId":"-"},"content":"    this.navigationService.navigateByURL(this.router, \u0027/web/join\u0027, { entitytype: this.entityType, key: this.regKey });"},{"lineNumber":311,"author":{"gitId":"-"},"content":"  }"},{"lineNumber":312,"author":{"gitId":"-"},"content":""},{"lineNumber":313,"author":{"gitId":"-"},"content":"  /**"},{"lineNumber":314,"author":{"gitId":"-"},"content":"   * Loads the feedback session information."},{"lineNumber":315,"author":{"gitId":"-"},"content":"   */"},{"lineNumber":316,"author":{"gitId":"-"},"content":"  loadFeedbackSession(): void {"},{"lineNumber":317,"author":{"gitId":"-"},"content":"    this.isFeedbackSessionLoading \u003d true;"},{"lineNumber":318,"author":{"gitId":"-"},"content":"    const TIME_FORMAT: string \u003d \u0027ddd, DD MMM, YYYY, hh:mm A zz\u0027;"},{"lineNumber":319,"author":{"gitId":"-"},"content":"    this.feedbackSessionsService.getFeedbackSession({"},{"lineNumber":320,"author":{"gitId":"-"},"content":"      courseId: this.courseId,"},{"lineNumber":321,"author":{"gitId":"-"},"content":"      feedbackSessionName: this.feedbackSessionName,"},{"lineNumber":322,"author":{"gitId":"-"},"content":"      intent: this.intent,"},{"lineNumber":323,"author":{"gitId":"-"},"content":"      key: this.regKey,"},{"lineNumber":324,"author":{"gitId":"-"},"content":"      moderatedPerson: this.moderatedPerson,"},{"lineNumber":325,"author":{"gitId":"-"},"content":"      previewAs: this.previewAsPerson,"},{"lineNumber":326,"author":{"gitId":"-"},"content":"    }).pipe(finalize(() \u003d\u003e this.isFeedbackSessionLoading \u003d false))"},{"lineNumber":327,"author":{"gitId":"-"},"content":"      .subscribe((feedbackSession: FeedbackSession) \u003d\u003e {"},{"lineNumber":328,"author":{"gitId":"-"},"content":"        this.feedbackSessionInstructions \u003d feedbackSession.instructions;"},{"lineNumber":329,"author":{"gitId":"-"},"content":"        this.formattedSessionOpeningTime \u003d this.timezoneService"},{"lineNumber":330,"author":{"gitId":"-"},"content":"          .formatToString(feedbackSession.submissionStartTimestamp, feedbackSession.timeZone, TIME_FORMAT);"},{"lineNumber":331,"author":{"gitId":"-"},"content":""},{"lineNumber":332,"author":{"gitId":"-"},"content":"        this.formattedSessionClosingTime \u003d this.timezoneService"},{"lineNumber":333,"author":{"gitId":"-"},"content":"          .formatToString(feedbackSession.submissionEndTimestamp, feedbackSession.timeZone, TIME_FORMAT);"},{"lineNumber":334,"author":{"gitId":"-"},"content":""},{"lineNumber":335,"author":{"gitId":"-"},"content":"        this.feedbackSessionSubmissionStatus \u003d feedbackSession.submissionStatus;"},{"lineNumber":336,"author":{"gitId":"-"},"content":"        this.feedbackSessionTimezone \u003d feedbackSession.timeZone;"},{"lineNumber":337,"author":{"gitId":"-"},"content":""},{"lineNumber":338,"author":{"gitId":"-"},"content":"        // don\u0027t show alert modal in moderation"},{"lineNumber":339,"author":{"gitId":"-"},"content":"        if (!this.moderatedPerson) {"},{"lineNumber":340,"author":{"gitId":"-"},"content":"          let modalContent: string;"},{"lineNumber":341,"author":{"gitId":"-"},"content":"          switch (feedbackSession.submissionStatus) {"},{"lineNumber":342,"author":{"gitId":"-"},"content":"            case FeedbackSessionSubmissionStatus.VISIBLE_NOT_OPEN:"},{"lineNumber":343,"author":{"gitId":"-"},"content":"              this.isSubmissionFormsDisabled \u003d true;"},{"lineNumber":344,"author":{"gitId":"-"},"content":"              modalContent \u003d `\u003cp\u003e\u003cstrong\u003eThe feedback session is currently not open for submissions.\u003c/strong\u003e\u003c/p\u003e"},{"lineNumber":345,"author":{"gitId":"-"},"content":"                \u003cp\u003eYou can view the questions and any submitted responses"},{"lineNumber":346,"author":{"gitId":"-"},"content":"                for this feedback session but cannot submit new responses.\u003c/p\u003e`;"},{"lineNumber":347,"author":{"gitId":"-"},"content":"              this.simpleModalService.openInformationModal("},{"lineNumber":348,"author":{"gitId":"-"},"content":"                \u0027Feedback Session Not Open\u0027, SimpleModalType.WARNING, modalContent);"},{"lineNumber":349,"author":{"gitId":"-"},"content":"              break;"},{"lineNumber":350,"author":{"gitId":"-"},"content":"            case FeedbackSessionSubmissionStatus.OPEN:"},{"lineNumber":351,"author":{"gitId":"-"},"content":"              // closing in 15 minutes"},{"lineNumber":352,"author":{"gitId":"-"},"content":"              if (feedbackSession.submissionEndTimestamp - Date.now() \u003c 15 * 60 * 1000) {"},{"lineNumber":353,"author":{"gitId":"-"},"content":"                modalContent \u003d \u0027Warning: you have less than 15 minutes before the submission deadline expires!\u0027;"},{"lineNumber":354,"author":{"gitId":"-"},"content":"                this.simpleModalService.openInformationModal("},{"lineNumber":355,"author":{"gitId":"-"},"content":"                  \u0027Feedback Session Will Be Closing Soon!\u0027, SimpleModalType.WARNING, modalContent);"},{"lineNumber":356,"author":{"gitId":"-"},"content":"              }"},{"lineNumber":357,"author":{"gitId":"-"},"content":"              break;"},{"lineNumber":358,"author":{"gitId":"-"},"content":"            case FeedbackSessionSubmissionStatus.CLOSED:"},{"lineNumber":359,"author":{"gitId":"-"},"content":"              this.isSubmissionFormsDisabled \u003d true;"},{"lineNumber":360,"author":{"gitId":"-"},"content":"              modalContent \u003d `\u003cp\u003e\u003cstrong\u003eFeedback Session is Closed\u003c/strong\u003e\u003c/p\u003e"},{"lineNumber":361,"author":{"gitId":"-"},"content":"                \u003cp\u003eYou can view the questions and any submitted responses"},{"lineNumber":362,"author":{"gitId":"-"},"content":"                for this feedback session but cannot submit new responses.\u003c/p\u003e`;"},{"lineNumber":363,"author":{"gitId":"-"},"content":"              this.simpleModalService.openInformationModal("},{"lineNumber":364,"author":{"gitId":"-"},"content":"                \u0027Feedback Session Closed\u0027, SimpleModalType.WARNING, modalContent);"},{"lineNumber":365,"author":{"gitId":"-"},"content":"              break;"},{"lineNumber":366,"author":{"gitId":"-"},"content":"            case FeedbackSessionSubmissionStatus.GRACE_PERIOD:"},{"lineNumber":367,"author":{"gitId":"-"},"content":"            default:"},{"lineNumber":368,"author":{"gitId":"-"},"content":"          }"},{"lineNumber":369,"author":{"gitId":"-"},"content":"        }"},{"lineNumber":370,"author":{"gitId":"-"},"content":""},{"lineNumber":371,"author":{"gitId":"-"},"content":"        this.loadFeedbackQuestions();"},{"lineNumber":372,"author":{"gitId":"-"},"content":""},{"lineNumber":373,"author":{"gitId":"-"},"content":"        // Display note on submission on mobile device"},{"lineNumber":374,"author":{"gitId":"-"},"content":"        const mobileDeviceWidth: number \u003d 768;"},{"lineNumber":375,"author":{"gitId":"-"},"content":"        if (this.feedbackSessionSubmissionStatus \u003d\u003d\u003d FeedbackSessionSubmissionStatus.OPEN"},{"lineNumber":376,"author":{"gitId":"-"},"content":"          \u0026\u0026 window.innerWidth \u003c mobileDeviceWidth) {"},{"lineNumber":377,"author":{"gitId":"-"},"content":"          const modalContent: string \u003d `Note that you can use the Submit button to save responses already entered, and continue to"},{"lineNumber":378,"author":{"gitId":"-"},"content":"answer remaining questions after that. You may also edit your submission any number of times before the closing time of"},{"lineNumber":379,"author":{"gitId":"-"},"content":"this session.`;"},{"lineNumber":380,"author":{"gitId":"-"},"content":"          this.simpleModalService.openInformationModal("},{"lineNumber":381,"author":{"gitId":"-"},"content":"              \u0027Note On Submission\u0027, SimpleModalType.INFO, modalContent);"},{"lineNumber":382,"author":{"gitId":"-"},"content":"        }"},{"lineNumber":383,"author":{"gitId":"-"},"content":"      }, (resp: ErrorMessageOutput) \u003d\u003e {"},{"lineNumber":384,"author":{"gitId":"-"},"content":"        if (resp.status \u003d\u003d\u003d 404) {"},{"lineNumber":385,"author":{"gitId":"-"},"content":"          this.simpleModalService.openInformationModal(\u0027Feedback Session Does Not Exist!\u0027, SimpleModalType.DANGER,"},{"lineNumber":386,"author":{"gitId":"-"},"content":"              \u0027The session does not exist (most likely deleted by the instructor after the submission link was sent).\u0027);"},{"lineNumber":387,"author":{"gitId":"-"},"content":"          this.navigationService.navigateByURL(this.router, `/web/${this.entityType}/home`);"},{"lineNumber":388,"author":{"gitId":"-"},"content":"        } else if (resp.status \u003d\u003d\u003d 403) {"},{"lineNumber":389,"author":{"gitId":"-"},"content":"          this.simpleModalService.openInformationModal(\u0027Not Authorised To Access!\u0027, SimpleModalType.DANGER,"},{"lineNumber":390,"author":{"gitId":"-"},"content":"              resp.error.message);"},{"lineNumber":391,"author":{"gitId":"-"},"content":"          this.navigationService.navigateByURL(this.router, `/web/${this.entityType}/home`);"},{"lineNumber":392,"author":{"gitId":"-"},"content":"        } else {"},{"lineNumber":393,"author":{"gitId":"-"},"content":"          this.navigationService.navigateWithErrorMessage("},{"lineNumber":394,"author":{"gitId":"-"},"content":"              this.router, `/web/${this.entityType}/home`, resp.error.message);"},{"lineNumber":395,"author":{"gitId":"-"},"content":"        }"},{"lineNumber":396,"author":{"gitId":"-"},"content":"      });"},{"lineNumber":397,"author":{"gitId":"-"},"content":"  }"},{"lineNumber":398,"author":{"gitId":"-"},"content":""},{"lineNumber":399,"author":{"gitId":"-"},"content":"  /**"},{"lineNumber":400,"author":{"gitId":"-"},"content":"   * Loads feedback questions to submit."},{"lineNumber":401,"author":{"gitId":"-"},"content":"   */"},{"lineNumber":402,"author":{"gitId":"-"},"content":"  loadFeedbackQuestions(): void {"},{"lineNumber":403,"author":{"gitId":"-"},"content":"    this.isFeedbackSessionQuestionsLoading \u003d true;"},{"lineNumber":404,"author":{"gitId":"-"},"content":"    this.questionSubmissionForms \u003d [];"},{"lineNumber":405,"author":{"gitId":"-"},"content":"    this.feedbackQuestionsService.getFeedbackQuestions({"},{"lineNumber":406,"author":{"gitId":"-"},"content":"      courseId: this.courseId,"},{"lineNumber":407,"author":{"gitId":"-"},"content":"      feedbackSessionName: this.feedbackSessionName,"},{"lineNumber":408,"author":{"gitId":"-"},"content":"      intent: this.intent,"},{"lineNumber":409,"author":{"gitId":"-"},"content":"      key: this.regKey,"},{"lineNumber":410,"author":{"gitId":"-"},"content":"      moderatedPerson: this.moderatedPerson,"},{"lineNumber":411,"author":{"gitId":"-"},"content":"      previewAs: this.previewAsPerson,"},{"lineNumber":412,"author":{"gitId":"-"},"content":"    }).pipe(finalize(() \u003d\u003e this.isFeedbackSessionQuestionsLoading \u003d false))"},{"lineNumber":413,"author":{"gitId":"-"},"content":"        .subscribe((response: FeedbackQuestionsResponse) \u003d\u003e {"},{"lineNumber":414,"author":{"gitId":"-"},"content":"          this.isFeedbackSessionQuestionResponsesLoading \u003d response.questions.length !\u003d\u003d 0;"},{"lineNumber":415,"author":{"gitId":"-"},"content":"          response.questions.forEach((feedbackQuestion: FeedbackQuestion) \u003d\u003e {"},{"lineNumber":416,"author":{"gitId":"-"},"content":"            const model: QuestionSubmissionFormModel \u003d {"},{"lineNumber":417,"author":{"gitId":"-"},"content":"              feedbackQuestionId: feedbackQuestion.feedbackQuestionId,"},{"lineNumber":418,"author":{"gitId":"-"},"content":""},{"lineNumber":419,"author":{"gitId":"-"},"content":"              questionNumber: feedbackQuestion.questionNumber,"},{"lineNumber":420,"author":{"gitId":"-"},"content":"              questionBrief: feedbackQuestion.questionBrief,"},{"lineNumber":421,"author":{"gitId":"-"},"content":"              questionDescription: feedbackQuestion.questionDescription,"},{"lineNumber":422,"author":{"gitId":"-"},"content":""},{"lineNumber":423,"author":{"gitId":"-"},"content":"              giverType: feedbackQuestion.giverType,"},{"lineNumber":424,"author":{"gitId":"-"},"content":"              recipientType: feedbackQuestion.recipientType,"},{"lineNumber":425,"author":{"gitId":"-"},"content":"              recipientList: [],"},{"lineNumber":426,"author":{"gitId":"-"},"content":"              recipientSubmissionForms: [],"},{"lineNumber":427,"author":{"gitId":"-"},"content":""},{"lineNumber":428,"author":{"gitId":"-"},"content":"              questionType: feedbackQuestion.questionType,"},{"lineNumber":429,"author":{"gitId":"-"},"content":"              questionDetails: feedbackQuestion.questionDetails,"},{"lineNumber":430,"author":{"gitId":"-"},"content":""},{"lineNumber":431,"author":{"gitId":"-"},"content":"              numberOfEntitiesToGiveFeedbackToSetting: feedbackQuestion.numberOfEntitiesToGiveFeedbackToSetting,"},{"lineNumber":432,"author":{"gitId":"-"},"content":"              customNumberOfEntitiesToGiveFeedbackTo: feedbackQuestion.customNumberOfEntitiesToGiveFeedbackTo"},{"lineNumber":433,"author":{"gitId":"-"},"content":"                      ? feedbackQuestion.customNumberOfEntitiesToGiveFeedbackTo : 0,"},{"lineNumber":434,"author":{"gitId":"-"},"content":""},{"lineNumber":435,"author":{"gitId":"-"},"content":"              showGiverNameTo: feedbackQuestion.showGiverNameTo,"},{"lineNumber":436,"author":{"gitId":"-"},"content":"              showRecipientNameTo: feedbackQuestion.showRecipientNameTo,"},{"lineNumber":437,"author":{"gitId":"-"},"content":"              showResponsesTo: feedbackQuestion.showResponsesTo,"},{"lineNumber":438,"author":{"gitId":"-"},"content":"            };"},{"lineNumber":439,"author":{"gitId":"-"},"content":"            this.questionSubmissionForms.push(model);"},{"lineNumber":440,"author":{"gitId":"-"},"content":"            this.loadFeedbackQuestionRecipientsForQuestion(model);"},{"lineNumber":441,"author":{"gitId":"-"},"content":"          });"},{"lineNumber":442,"author":{"gitId":"-"},"content":"        }, (resp: ErrorMessageOutput) \u003d\u003e {"},{"lineNumber":443,"author":{"gitId":"-"},"content":"          this.handleError(resp);"},{"lineNumber":444,"author":{"gitId":"-"},"content":"        });"},{"lineNumber":445,"author":{"gitId":"-"},"content":"  }"},{"lineNumber":446,"author":{"gitId":"-"},"content":""},{"lineNumber":447,"author":{"gitId":"-"},"content":"  /**"},{"lineNumber":448,"author":{"gitId":"-"},"content":"   * Tracks the question submission form by feedback question id."},{"lineNumber":449,"author":{"gitId":"-"},"content":"   *"},{"lineNumber":450,"author":{"gitId":"-"},"content":"   * @see https://angular.io/api/common/NgForOf#properties"},{"lineNumber":451,"author":{"gitId":"-"},"content":"   */"},{"lineNumber":452,"author":{"gitId":"-"},"content":"  trackQuestionSubmissionFormByFn(_: any, item: QuestionSubmissionFormModel): any {"},{"lineNumber":453,"author":{"gitId":"-"},"content":"    return item.feedbackQuestionId;"},{"lineNumber":454,"author":{"gitId":"-"},"content":"  }"},{"lineNumber":455,"author":{"gitId":"-"},"content":""},{"lineNumber":456,"author":{"gitId":"-"},"content":"  /**"},{"lineNumber":457,"author":{"gitId":"-"},"content":"   * Loads the feedback question recipients for the question."},{"lineNumber":458,"author":{"gitId":"-"},"content":"   */"},{"lineNumber":459,"author":{"gitId":"-"},"content":"  loadFeedbackQuestionRecipientsForQuestion(model: QuestionSubmissionFormModel): void {"},{"lineNumber":460,"author":{"gitId":"-"},"content":"    this.feedbackQuestionsService.loadFeedbackQuestionRecipients({"},{"lineNumber":461,"author":{"gitId":"-"},"content":"      questionId: model.feedbackQuestionId,"},{"lineNumber":462,"author":{"gitId":"-"},"content":"      intent: this.intent,"},{"lineNumber":463,"author":{"gitId":"-"},"content":"      key: this.regKey,"},{"lineNumber":464,"author":{"gitId":"-"},"content":"      moderatedPerson: this.moderatedPerson,"},{"lineNumber":465,"author":{"gitId":"-"},"content":"      previewAs: this.previewAsPerson,"},{"lineNumber":466,"author":{"gitId":"-"},"content":"    }).subscribe((response: FeedbackQuestionRecipients) \u003d\u003e {"},{"lineNumber":467,"author":{"gitId":"-"},"content":"      response.recipients.forEach((recipient: FeedbackQuestionRecipient) \u003d\u003e {"},{"lineNumber":468,"author":{"gitId":"-"},"content":"        model.recipientList.push({"},{"lineNumber":469,"author":{"gitId":"-"},"content":"          recipientIdentifier: recipient.identifier,"},{"lineNumber":470,"author":{"gitId":"-"},"content":"          recipientName: recipient.name,"},{"lineNumber":471,"author":{"gitId":"-"},"content":"        });"},{"lineNumber":472,"author":{"gitId":"-"},"content":"      });"},{"lineNumber":473,"author":{"gitId":"-"},"content":""},{"lineNumber":474,"author":{"gitId":"-"},"content":"      if (this.previewAsPerson) {"},{"lineNumber":475,"author":{"gitId":"-"},"content":"        // don\u0027t load responses in preview mode"},{"lineNumber":476,"author":{"gitId":"-"},"content":"        // generate a list of empty response box"},{"lineNumber":477,"author":{"gitId":"-"},"content":"        const formMode: QuestionSubmissionFormMode \u003d this.getQuestionSubmissionFormMode(model);"},{"lineNumber":478,"author":{"gitId":"-"},"content":"        model.recipientList.forEach((recipient: FeedbackResponseRecipient) \u003d\u003e {"},{"lineNumber":479,"author":{"gitId":"-"},"content":"          if (formMode \u003d\u003d\u003d QuestionSubmissionFormMode.FLEXIBLE_RECIPIENT \u0026\u0026"},{"lineNumber":480,"author":{"gitId":"-"},"content":"            model.recipientSubmissionForms.length \u003e\u003d"},{"lineNumber":481,"author":{"gitId":"-"},"content":"            model.customNumberOfEntitiesToGiveFeedbackTo) {"},{"lineNumber":482,"author":{"gitId":"-"},"content":"            return;"},{"lineNumber":483,"author":{"gitId":"-"},"content":"          }"},{"lineNumber":484,"author":{"gitId":"-"},"content":""},{"lineNumber":485,"author":{"gitId":"-"},"content":"          let recipientIdentifier: string \u003d \u0027\u0027;"},{"lineNumber":486,"author":{"gitId":"-"},"content":"          if (formMode !\u003d\u003d QuestionSubmissionFormMode.FLEXIBLE_RECIPIENT) {"},{"lineNumber":487,"author":{"gitId":"-"},"content":"            recipientIdentifier \u003d recipient.recipientIdentifier;"},{"lineNumber":488,"author":{"gitId":"-"},"content":"          }"},{"lineNumber":489,"author":{"gitId":"-"},"content":""},{"lineNumber":490,"author":{"gitId":"-"},"content":"          model.recipientSubmissionForms.push({"},{"lineNumber":491,"author":{"gitId":"-"},"content":"            recipientIdentifier,"},{"lineNumber":492,"author":{"gitId":"-"},"content":"            responseDetails: this.feedbackResponsesService.getDefaultFeedbackResponseDetails(model.questionType),"},{"lineNumber":493,"author":{"gitId":"-"},"content":"            responseId: \u0027\u0027,"},{"lineNumber":494,"author":{"gitId":"-"},"content":"            isValid: true,"},{"lineNumber":495,"author":{"gitId":"-"},"content":"          });"},{"lineNumber":496,"author":{"gitId":"-"},"content":"        });"},{"lineNumber":497,"author":{"gitId":"-"},"content":"        this.isFeedbackSessionQuestionResponsesLoading \u003d false;"},{"lineNumber":498,"author":{"gitId":"-"},"content":"      } else {"},{"lineNumber":499,"author":{"gitId":"-"},"content":"        this.loadFeedbackResponses(model);"},{"lineNumber":500,"author":{"gitId":"-"},"content":"      }"},{"lineNumber":501,"author":{"gitId":"-"},"content":"    }, (resp: ErrorMessageOutput) \u003d\u003e this.statusMessageService.showErrorToast(resp.error.message));"},{"lineNumber":502,"author":{"gitId":"-"},"content":"  }"},{"lineNumber":503,"author":{"gitId":"-"},"content":""},{"lineNumber":504,"author":{"gitId":"-"},"content":"  /**"},{"lineNumber":505,"author":{"gitId":"-"},"content":"   * Gets the form mode of the question submission form."},{"lineNumber":506,"author":{"gitId":"-"},"content":"   */"},{"lineNumber":507,"author":{"gitId":"-"},"content":"  getQuestionSubmissionFormMode(model: QuestionSubmissionFormModel): QuestionSubmissionFormMode {"},{"lineNumber":508,"author":{"gitId":"-"},"content":"    const isNumberOfEntitiesToGiveFeedbackToSettingLimited: boolean"},{"lineNumber":509,"author":{"gitId":"-"},"content":"        \u003d (model.recipientType \u003d\u003d\u003d FeedbackParticipantType.STUDENTS"},{"lineNumber":510,"author":{"gitId":"-"},"content":"        || model.recipientType \u003d\u003d\u003d FeedbackParticipantType.STUDENTS_IN_SAME_SECTION"},{"lineNumber":511,"author":{"gitId":"-"},"content":"        || model.recipientType \u003d\u003d\u003d FeedbackParticipantType.TEAMS"},{"lineNumber":512,"author":{"gitId":"-"},"content":"        || model.recipientType \u003d\u003d\u003d FeedbackParticipantType.TEAMS_IN_SAME_SECTION"},{"lineNumber":513,"author":{"gitId":"-"},"content":"        || model.recipientType \u003d\u003d\u003d FeedbackParticipantType.INSTRUCTORS)"},{"lineNumber":514,"author":{"gitId":"-"},"content":"        \u0026\u0026 model.numberOfEntitiesToGiveFeedbackToSetting \u003d\u003d\u003d NumberOfEntitiesToGiveFeedbackToSetting.CUSTOM"},{"lineNumber":515,"author":{"gitId":"-"},"content":"        \u0026\u0026 model.recipientList.length \u003e model.customNumberOfEntitiesToGiveFeedbackTo;"},{"lineNumber":516,"author":{"gitId":"-"},"content":""},{"lineNumber":517,"author":{"gitId":"-"},"content":"    return isNumberOfEntitiesToGiveFeedbackToSettingLimited"},{"lineNumber":518,"author":{"gitId":"-"},"content":"        ? QuestionSubmissionFormMode.FLEXIBLE_RECIPIENT : QuestionSubmissionFormMode.FIXED_RECIPIENT;"},{"lineNumber":519,"author":{"gitId":"-"},"content":"  }"},{"lineNumber":520,"author":{"gitId":"-"},"content":""},{"lineNumber":521,"author":{"gitId":"-"},"content":"  /**"},{"lineNumber":522,"author":{"gitId":"-"},"content":"   * Loads the responses of the feedback question to {@recipientSubmissionForms} in the model."},{"lineNumber":523,"author":{"gitId":"-"},"content":"   */"},{"lineNumber":524,"author":{"gitId":"-"},"content":"  loadFeedbackResponses(model: QuestionSubmissionFormModel): void {"},{"lineNumber":525,"author":{"gitId":"-"},"content":"    this.isFeedbackSessionQuestionResponsesLoading \u003d true;"},{"lineNumber":526,"author":{"gitId":"-"},"content":"    this.feedbackResponsesService.getFeedbackResponse({"},{"lineNumber":527,"author":{"gitId":"-"},"content":"      questionId: model.feedbackQuestionId,"},{"lineNumber":528,"author":{"gitId":"-"},"content":"      intent: this.intent,"},{"lineNumber":529,"author":{"gitId":"-"},"content":"      key: this.regKey,"},{"lineNumber":530,"author":{"gitId":"-"},"content":"      moderatedPerson: this.moderatedPerson,"},{"lineNumber":531,"author":{"gitId":"-"},"content":"    }).pipe(finalize(() \u003d\u003e this.isFeedbackSessionQuestionResponsesLoading \u003d false))"},{"lineNumber":532,"author":{"gitId":"-"},"content":"      .subscribe((existingResponses: FeedbackResponsesResponse) \u003d\u003e {"},{"lineNumber":533,"author":{"gitId":"-"},"content":"        if (this.getQuestionSubmissionFormMode(model) \u003d\u003d\u003d QuestionSubmissionFormMode.FIXED_RECIPIENT) {"},{"lineNumber":534,"author":{"gitId":"-"},"content":"          // need to generate a full list of submission forms"},{"lineNumber":535,"author":{"gitId":"-"},"content":"          model.recipientList.forEach((recipient: FeedbackResponseRecipient) \u003d\u003e {"},{"lineNumber":536,"author":{"gitId":"-"},"content":"            const matchedExistingResponse: FeedbackResponse | undefined \u003d"},{"lineNumber":537,"author":{"gitId":"-"},"content":"              existingResponses.responses.find("},{"lineNumber":538,"author":{"gitId":"-"},"content":"                  (response: FeedbackResponse) \u003d\u003e response.recipientIdentifier \u003d\u003d\u003d recipient.recipientIdentifier);"},{"lineNumber":539,"author":{"gitId":"-"},"content":"            const submissionForm: FeedbackResponseRecipientSubmissionFormModel \u003d {"},{"lineNumber":540,"author":{"gitId":"-"},"content":"              recipientIdentifier: recipient.recipientIdentifier,"},{"lineNumber":541,"author":{"gitId":"-"},"content":"              responseDetails: matchedExistingResponse"},{"lineNumber":542,"author":{"gitId":"-"},"content":"                ? matchedExistingResponse.responseDetails"},{"lineNumber":543,"author":{"gitId":"-"},"content":"                : this.feedbackResponsesService.getDefaultFeedbackResponseDetails(model.questionType),"},{"lineNumber":544,"author":{"gitId":"-"},"content":"              responseId: matchedExistingResponse ? matchedExistingResponse.feedbackResponseId : \u0027\u0027,"},{"lineNumber":545,"author":{"gitId":"-"},"content":"              isValid: true,"},{"lineNumber":546,"author":{"gitId":"-"},"content":"            };"},{"lineNumber":547,"author":{"gitId":"-"},"content":"            if (matchedExistingResponse \u0026\u0026 matchedExistingResponse.giverComment) {"},{"lineNumber":548,"author":{"gitId":"-"},"content":"              submissionForm.commentByGiver \u003d this.getCommentModel(matchedExistingResponse.giverComment);"},{"lineNumber":549,"author":{"gitId":"-"},"content":"            }"},{"lineNumber":550,"author":{"gitId":"-"},"content":"            model.recipientSubmissionForms.push(submissionForm);"},{"lineNumber":551,"author":{"gitId":"-"},"content":"          });"},{"lineNumber":552,"author":{"gitId":"-"},"content":"        }"},{"lineNumber":553,"author":{"gitId":"-"},"content":""},{"lineNumber":554,"author":{"gitId":"-"},"content":"        if (this.getQuestionSubmissionFormMode(model) \u003d\u003d\u003d QuestionSubmissionFormMode.FLEXIBLE_RECIPIENT) {"},{"lineNumber":555,"author":{"gitId":"-"},"content":"          // need to generate limited number of submission forms"},{"lineNumber":556,"author":{"gitId":"-"},"content":"          let numberOfRecipientSubmissionFormsNeeded: number \u003d"},{"lineNumber":557,"author":{"gitId":"-"},"content":"            model.customNumberOfEntitiesToGiveFeedbackTo - existingResponses.responses.length;"},{"lineNumber":558,"author":{"gitId":"-"},"content":""},{"lineNumber":559,"author":{"gitId":"-"},"content":"          existingResponses.responses.forEach((response: FeedbackResponse) \u003d\u003e {"},{"lineNumber":560,"author":{"gitId":"-"},"content":"            model.recipientSubmissionForms.push({"},{"lineNumber":561,"author":{"gitId":"-"},"content":"              recipientIdentifier: response.recipientIdentifier,"},{"lineNumber":562,"author":{"gitId":"-"},"content":"              responseDetails: response.responseDetails,"},{"lineNumber":563,"author":{"gitId":"-"},"content":"              responseId: response.feedbackResponseId,"},{"lineNumber":564,"author":{"gitId":"-"},"content":"              isValid: true,"},{"lineNumber":565,"author":{"gitId":"-"},"content":"            });"},{"lineNumber":566,"author":{"gitId":"-"},"content":"          });"},{"lineNumber":567,"author":{"gitId":"-"},"content":""},{"lineNumber":568,"author":{"gitId":"-"},"content":"          // generate empty submission forms"},{"lineNumber":569,"author":{"gitId":"-"},"content":"          while (numberOfRecipientSubmissionFormsNeeded \u003e 0) {"},{"lineNumber":570,"author":{"gitId":"-"},"content":"            model.recipientSubmissionForms.push({"},{"lineNumber":571,"author":{"gitId":"-"},"content":"              recipientIdentifier: \u0027\u0027,"},{"lineNumber":572,"author":{"gitId":"-"},"content":"              responseDetails: this.feedbackResponsesService.getDefaultFeedbackResponseDetails(model.questionType),"},{"lineNumber":573,"author":{"gitId":"-"},"content":"              responseId: \u0027\u0027,"},{"lineNumber":574,"author":{"gitId":"-"},"content":"              isValid: true,"},{"lineNumber":575,"author":{"gitId":"-"},"content":"            });"},{"lineNumber":576,"author":{"gitId":"-"},"content":"            numberOfRecipientSubmissionFormsNeeded -\u003d 1;"},{"lineNumber":577,"author":{"gitId":"-"},"content":"          }"},{"lineNumber":578,"author":{"gitId":"-"},"content":"        }"},{"lineNumber":579,"author":{"gitId":"-"},"content":"      }, (resp: ErrorMessageOutput) \u003d\u003e this.statusMessageService.showErrorToast(resp.error.message));"},{"lineNumber":580,"author":{"gitId":"-"},"content":"  }"},{"lineNumber":581,"author":{"gitId":"-"},"content":""},{"lineNumber":582,"author":{"gitId":"-"},"content":"  /**"},{"lineNumber":583,"author":{"gitId":"-"},"content":"   * Gets the comment model for a given comment."},{"lineNumber":584,"author":{"gitId":"-"},"content":"   */"},{"lineNumber":585,"author":{"gitId":"-"},"content":"  getCommentModel(comment: FeedbackResponseComment): CommentRowModel {"},{"lineNumber":586,"author":{"gitId":"-"},"content":"    return {"},{"lineNumber":587,"author":{"gitId":"-"},"content":"      originalComment: comment,"},{"lineNumber":588,"author":{"gitId":"-"},"content":"      commentEditFormModel: {"},{"lineNumber":589,"author":{"gitId":"-"},"content":"        commentText: comment.commentText,"},{"lineNumber":590,"author":{"gitId":"-"},"content":"        // the participant comment shall not use custom visibilities"},{"lineNumber":591,"author":{"gitId":"-"},"content":"        isUsingCustomVisibilities: false,"},{"lineNumber":592,"author":{"gitId":"-"},"content":"        showCommentTo: [],"},{"lineNumber":593,"author":{"gitId":"-"},"content":"        showGiverNameTo: [],"},{"lineNumber":594,"author":{"gitId":"-"},"content":"      },"},{"lineNumber":595,"author":{"gitId":"-"},"content":"      timezone: this.feedbackSessionTimezone,"},{"lineNumber":596,"author":{"gitId":"-"},"content":"      isEditing: false,"},{"lineNumber":597,"author":{"gitId":"-"},"content":"    };"},{"lineNumber":598,"author":{"gitId":"-"},"content":"  }"},{"lineNumber":599,"author":{"gitId":"-"},"content":""},{"lineNumber":600,"author":{"gitId":"-"},"content":"  /**"},{"lineNumber":601,"author":{"gitId":"-"},"content":"   * Checks whether there is any submission forms in the current page."},{"lineNumber":602,"author":{"gitId":"-"},"content":"   */"},{"lineNumber":603,"author":{"gitId":"-"},"content":"  get hasAnyResponseToSubmit(): boolean {"},{"lineNumber":604,"author":{"gitId":"-"},"content":"    return this.questionSubmissionForms"},{"lineNumber":605,"author":{"gitId":"-"},"content":"        .some((model: QuestionSubmissionFormModel) \u003d\u003e model.recipientSubmissionForms.length !\u003d\u003d 0);"},{"lineNumber":606,"author":{"gitId":"-"},"content":"  }"},{"lineNumber":607,"author":{"gitId":"-"},"content":""},{"lineNumber":608,"author":{"gitId":"-"},"content":"  /**"},{"lineNumber":609,"author":{"gitId":"-"},"content":"   * Saves all feedback response."},{"lineNumber":610,"author":{"gitId":"-"},"content":"   *"},{"lineNumber":611,"author":{"gitId":"-"},"content":"   * \u003cp\u003eAll empty feedback response will be deleted; For non-empty responses, update/create them if necessary."},{"lineNumber":612,"author":{"gitId":"-"},"content":"   */"},{"lineNumber":613,"author":{"gitId":"-"},"content":"  saveFeedbackResponses(): void {"},{"lineNumber":614,"author":{"gitId":"-"},"content":"    const notYetAnsweredQuestions: Set\u003cnumber\u003e \u003d new Set();"},{"lineNumber":615,"author":{"gitId":"-"},"content":"    const requestIds: Record\u003cstring, string\u003e \u003d {};"},{"lineNumber":616,"author":{"gitId":"-"},"content":"    const answers: Record\u003cstring, FeedbackResponse[]\u003e \u003d {};"},{"lineNumber":617,"author":{"gitId":"-"},"content":"    const failToSaveQuestions: Record\u003cnumber, string\u003e \u003d {}; // Map of question number to error message"},{"lineNumber":618,"author":{"gitId":"-"},"content":"    const savingRequests: Observable\u003cany\u003e[] \u003d [];"},{"lineNumber":619,"author":{"gitId":"-"},"content":""},{"lineNumber":620,"author":{"gitId":"-"},"content":"    this.logService.createFeedbackSessionLog({"},{"lineNumber":621,"author":{"gitId":"-"},"content":"      courseId: this.courseId,"},{"lineNumber":622,"author":{"gitId":"-"},"content":"      feedbackSessionName: this.feedbackSessionName,"},{"lineNumber":623,"author":{"gitId":"-"},"content":"      studentEmail: this.personEmail,"},{"lineNumber":624,"author":{"gitId":"-"},"content":"      logType: FeedbackSessionLogType.SUBMISSION,"},{"lineNumber":625,"author":{"gitId":"-"},"content":"    }).subscribe(() \u003d\u003e {"},{"lineNumber":626,"author":{"gitId":"-"},"content":""},{"lineNumber":627,"author":{"gitId":"-"},"content":"    }, () \u003d\u003e {"},{"lineNumber":628,"author":{"gitId":"-"},"content":"      this.statusMessageService.showWarningToast(\u0027Failed to log feedback session submission\u0027);"},{"lineNumber":629,"author":{"gitId":"-"},"content":"    });"},{"lineNumber":630,"author":{"gitId":"-"},"content":""},{"lineNumber":631,"author":{"gitId":"-"},"content":"    this.questionSubmissionForms.forEach((questionSubmissionFormModel: QuestionSubmissionFormModel) \u003d\u003e {"},{"lineNumber":632,"author":{"gitId":"-"},"content":"      let isQuestionFullyAnswered: boolean \u003d true;"},{"lineNumber":633,"author":{"gitId":"-"},"content":""},{"lineNumber":634,"author":{"gitId":"-"},"content":"      const responses: FeedbackResponseRequest[] \u003d [];"},{"lineNumber":635,"author":{"gitId":"-"},"content":""},{"lineNumber":636,"author":{"gitId":"-"},"content":"      questionSubmissionFormModel.recipientSubmissionForms"},{"lineNumber":637,"author":{"gitId":"-"},"content":"          .forEach((recipientSubmissionFormModel: FeedbackResponseRecipientSubmissionFormModel) \u003d\u003e {"},{"lineNumber":638,"author":{"gitId":"-"},"content":"            if (!recipientSubmissionFormModel.isValid) {"},{"lineNumber":639,"author":{"gitId":"-"},"content":"              failToSaveQuestions[questionSubmissionFormModel.questionNumber] \u003d"},{"lineNumber":640,"author":{"gitId":"-"},"content":"                  \u0027Invalid responses provided. Please check question constraints.\u0027;"},{"lineNumber":641,"author":{"gitId":"-"},"content":"              return;"},{"lineNumber":642,"author":{"gitId":"-"},"content":"            }"},{"lineNumber":643,"author":{"gitId":"-"},"content":"            const isFeedbackResponseDetailsEmpty: boolean \u003d"},{"lineNumber":644,"author":{"gitId":"-"},"content":"                this.feedbackResponsesService.isFeedbackResponseDetailsEmpty("},{"lineNumber":645,"author":{"gitId":"-"},"content":"                    questionSubmissionFormModel.questionType, recipientSubmissionFormModel.responseDetails);"},{"lineNumber":646,"author":{"gitId":"-"},"content":"            isQuestionFullyAnswered \u003d isQuestionFullyAnswered \u0026\u0026 !isFeedbackResponseDetailsEmpty;"},{"lineNumber":647,"author":{"gitId":"-"},"content":""},{"lineNumber":648,"author":{"gitId":"-"},"content":"            if (!isFeedbackResponseDetailsEmpty) {"},{"lineNumber":649,"author":{"gitId":"-"},"content":"              responses.push({"},{"lineNumber":650,"author":{"gitId":"-"},"content":"                recipient: recipientSubmissionFormModel.recipientIdentifier,"},{"lineNumber":651,"author":{"gitId":"-"},"content":"                responseDetails: recipientSubmissionFormModel.responseDetails,"},{"lineNumber":652,"author":{"gitId":"-"},"content":"              });"},{"lineNumber":653,"author":{"gitId":"-"},"content":"            }"},{"lineNumber":654,"author":{"gitId":"-"},"content":"          });"},{"lineNumber":655,"author":{"gitId":"-"},"content":""},{"lineNumber":656,"author":{"gitId":"zhaojj2209"},"content":"      if (!failToSaveQuestions[questionSubmissionFormModel.questionNumber]) {"},{"lineNumber":657,"author":{"gitId":"-"},"content":"        savingRequests.push("},{"lineNumber":658,"author":{"gitId":"-"},"content":"            this.feedbackResponsesService.submitFeedbackResponses(questionSubmissionFormModel.feedbackQuestionId, {"},{"lineNumber":659,"author":{"gitId":"-"},"content":"              intent: this.intent,"},{"lineNumber":660,"author":{"gitId":"-"},"content":"              key: this.regKey,"},{"lineNumber":661,"author":{"gitId":"-"},"content":"              moderatedperson: this.moderatedPerson,"},{"lineNumber":662,"author":{"gitId":"-"},"content":"            }, {"},{"lineNumber":663,"author":{"gitId":"-"},"content":"              responses,"},{"lineNumber":664,"author":{"gitId":"-"},"content":"            }).pipe("},{"lineNumber":665,"author":{"gitId":"-"},"content":"                tap((resp: FeedbackResponses) \u003d\u003e {"},{"lineNumber":666,"author":{"gitId":"-"},"content":"                  const responsesMap: Record\u003cstring, FeedbackResponse\u003e \u003d {};"},{"lineNumber":667,"author":{"gitId":"-"},"content":"                  resp.responses.forEach((response: FeedbackResponse) \u003d\u003e {"},{"lineNumber":668,"author":{"gitId":"-"},"content":"                    responsesMap[response.recipientIdentifier] \u003d response;"},{"lineNumber":669,"author":{"gitId":"-"},"content":"                    answers[questionSubmissionFormModel.feedbackQuestionId] \u003d"},{"lineNumber":670,"author":{"gitId":"-"},"content":"                        answers[questionSubmissionFormModel.feedbackQuestionId] || [];"},{"lineNumber":671,"author":{"gitId":"-"},"content":"                    answers[questionSubmissionFormModel.feedbackQuestionId].push(response);"},{"lineNumber":672,"author":{"gitId":"-"},"content":"                  });"},{"lineNumber":673,"author":{"gitId":"-"},"content":"                  requestIds[questionSubmissionFormModel.feedbackQuestionId] \u003d resp.requestId || \u0027\u0027;"},{"lineNumber":674,"author":{"gitId":"-"},"content":""},{"lineNumber":675,"author":{"gitId":"-"},"content":"                  questionSubmissionFormModel.recipientSubmissionForms"},{"lineNumber":676,"author":{"gitId":"-"},"content":"                      .forEach((recipientSubmissionFormModel: FeedbackResponseRecipientSubmissionFormModel) \u003d\u003e {"},{"lineNumber":677,"author":{"gitId":"-"},"content":"                        if (responsesMap[recipientSubmissionFormModel.recipientIdentifier]) {"},{"lineNumber":678,"author":{"gitId":"-"},"content":"                          const correspondingResp: FeedbackResponse \u003d"},{"lineNumber":679,"author":{"gitId":"-"},"content":"                              responsesMap[recipientSubmissionFormModel.recipientIdentifier];"},{"lineNumber":680,"author":{"gitId":"-"},"content":"                          recipientSubmissionFormModel.responseId \u003d correspondingResp.feedbackResponseId;"},{"lineNumber":681,"author":{"gitId":"-"},"content":"                          recipientSubmissionFormModel.responseDetails \u003d correspondingResp.responseDetails;"},{"lineNumber":682,"author":{"gitId":"-"},"content":"                          recipientSubmissionFormModel.recipientIdentifier \u003d correspondingResp.recipientIdentifier;"},{"lineNumber":683,"author":{"gitId":"-"},"content":"                        } else {"},{"lineNumber":684,"author":{"gitId":"-"},"content":"                          recipientSubmissionFormModel.responseId \u003d \u0027\u0027;"},{"lineNumber":685,"author":{"gitId":"-"},"content":"                          recipientSubmissionFormModel.commentByGiver \u003d undefined;"},{"lineNumber":686,"author":{"gitId":"-"},"content":"                        }"},{"lineNumber":687,"author":{"gitId":"-"},"content":"                      });"},{"lineNumber":688,"author":{"gitId":"-"},"content":"                }),"},{"lineNumber":689,"author":{"gitId":"-"},"content":"                switchMap(() \u003d\u003e"},{"lineNumber":690,"author":{"gitId":"-"},"content":"                    forkJoin(questionSubmissionFormModel.recipientSubmissionForms"},{"lineNumber":691,"author":{"gitId":"-"},"content":"                        .map((recipientSubmissionFormModel: FeedbackResponseRecipientSubmissionFormModel) \u003d\u003e"},{"lineNumber":692,"author":{"gitId":"-"},"content":"                            this.createCommentRequest(recipientSubmissionFormModel))),"},{"lineNumber":693,"author":{"gitId":"-"},"content":"                ),"},{"lineNumber":694,"author":{"gitId":"-"},"content":"                catchError((error: ErrorMessageOutput) \u003d\u003e {"},{"lineNumber":695,"author":{"gitId":"-"},"content":"                  failToSaveQuestions[questionSubmissionFormModel.questionNumber] \u003d error.error.message;"},{"lineNumber":696,"author":{"gitId":"-"},"content":"                  return of(error);"},{"lineNumber":697,"author":{"gitId":"-"},"content":"                }),"},{"lineNumber":698,"author":{"gitId":"-"},"content":"            ),"},{"lineNumber":699,"author":{"gitId":"-"},"content":"        );"},{"lineNumber":700,"author":{"gitId":"zhaojj2209"},"content":"      }"},{"lineNumber":701,"author":{"gitId":"-"},"content":""},{"lineNumber":702,"author":{"gitId":"-"},"content":"      if (!isQuestionFullyAnswered) {"},{"lineNumber":703,"author":{"gitId":"-"},"content":"        notYetAnsweredQuestions.add(questionSubmissionFormModel.questionNumber);"},{"lineNumber":704,"author":{"gitId":"-"},"content":"      }"},{"lineNumber":705,"author":{"gitId":"-"},"content":"    });"},{"lineNumber":706,"author":{"gitId":"-"},"content":""},{"lineNumber":707,"author":{"gitId":"-"},"content":"    this.isSavingResponses \u003d true;"},{"lineNumber":708,"author":{"gitId":"-"},"content":"    forkJoin(savingRequests).pipe("},{"lineNumber":709,"author":{"gitId":"-"},"content":"        finalize(() \u003d\u003e {"},{"lineNumber":710,"author":{"gitId":"-"},"content":"          this.isSavingResponses \u003d false;"},{"lineNumber":711,"author":{"gitId":"-"},"content":""},{"lineNumber":712,"author":{"gitId":"-"},"content":"          const modalRef: NgbModalRef \u003d this.ngbModal.open(SavingCompleteModalComponent);"},{"lineNumber":713,"author":{"gitId":"-"},"content":"          modalRef.componentInstance.requestIds \u003d requestIds;"},{"lineNumber":714,"author":{"gitId":"-"},"content":"          modalRef.componentInstance.courseId \u003d this.courseId;"},{"lineNumber":715,"author":{"gitId":"-"},"content":"          modalRef.componentInstance.feedbackSessionName \u003d this.feedbackSessionName;"},{"lineNumber":716,"author":{"gitId":"-"},"content":"          modalRef.componentInstance.feedbackSessionTimezone \u003d this.feedbackSessionTimezone;"},{"lineNumber":717,"author":{"gitId":"-"},"content":"          modalRef.componentInstance.personEmail \u003d this.personEmail;"},{"lineNumber":718,"author":{"gitId":"-"},"content":"          modalRef.componentInstance.personName \u003d this.personName;"},{"lineNumber":719,"author":{"gitId":"-"},"content":"          modalRef.componentInstance.questions \u003d this.questionSubmissionForms;"},{"lineNumber":720,"author":{"gitId":"-"},"content":"          modalRef.componentInstance.answers \u003d answers;"},{"lineNumber":721,"author":{"gitId":"-"},"content":"          modalRef.componentInstance.notYetAnsweredQuestions \u003d Array.from(notYetAnsweredQuestions.values());"},{"lineNumber":722,"author":{"gitId":"-"},"content":"          modalRef.componentInstance.failToSaveQuestions \u003d failToSaveQuestions;"},{"lineNumber":723,"author":{"gitId":"-"},"content":"        }),"},{"lineNumber":724,"author":{"gitId":"-"},"content":"    ).subscribe();"},{"lineNumber":725,"author":{"gitId":"-"},"content":"  }"},{"lineNumber":726,"author":{"gitId":"-"},"content":""},{"lineNumber":727,"author":{"gitId":"-"},"content":"  /**"},{"lineNumber":728,"author":{"gitId":"-"},"content":"   * Creates comment request."},{"lineNumber":729,"author":{"gitId":"-"},"content":"   */"},{"lineNumber":730,"author":{"gitId":"-"},"content":"  createCommentRequest(recipientSubmissionFormModel: FeedbackResponseRecipientSubmissionFormModel): Observable\u003cany\u003e {"},{"lineNumber":731,"author":{"gitId":"-"},"content":"    if (!recipientSubmissionFormModel.responseId) {"},{"lineNumber":732,"author":{"gitId":"-"},"content":"      // responseId not set, cannot set comment"},{"lineNumber":733,"author":{"gitId":"-"},"content":"      return of({});"},{"lineNumber":734,"author":{"gitId":"-"},"content":"    }"},{"lineNumber":735,"author":{"gitId":"-"},"content":"    if (!recipientSubmissionFormModel.commentByGiver) {"},{"lineNumber":736,"author":{"gitId":"-"},"content":"      // comment not given, do nothing"},{"lineNumber":737,"author":{"gitId":"-"},"content":"      return of({});"},{"lineNumber":738,"author":{"gitId":"-"},"content":"    }"},{"lineNumber":739,"author":{"gitId":"-"},"content":""},{"lineNumber":740,"author":{"gitId":"-"},"content":"    if (!recipientSubmissionFormModel.commentByGiver.originalComment) {"},{"lineNumber":741,"author":{"gitId":"-"},"content":"      // comment is new"},{"lineNumber":742,"author":{"gitId":"-"},"content":""},{"lineNumber":743,"author":{"gitId":"-"},"content":"      if (recipientSubmissionFormModel.commentByGiver.commentEditFormModel.commentText \u003d\u003d\u003d \u0027\u0027) {"},{"lineNumber":744,"author":{"gitId":"-"},"content":"        // new comment is empty"},{"lineNumber":745,"author":{"gitId":"-"},"content":"        recipientSubmissionFormModel.commentByGiver \u003d undefined;"},{"lineNumber":746,"author":{"gitId":"-"},"content":"        return of({});"},{"lineNumber":747,"author":{"gitId":"-"},"content":"      }"},{"lineNumber":748,"author":{"gitId":"-"},"content":""},{"lineNumber":749,"author":{"gitId":"-"},"content":"      // create new comment"},{"lineNumber":750,"author":{"gitId":"-"},"content":"      return this.commentService.createComment({"},{"lineNumber":751,"author":{"gitId":"-"},"content":"        commentText: recipientSubmissionFormModel.commentByGiver.commentEditFormModel.commentText,"},{"lineNumber":752,"author":{"gitId":"-"},"content":"        // we ignore the fields in comment edit model as participant comment"},{"lineNumber":753,"author":{"gitId":"-"},"content":"        // will follow visibilities from question by design"},{"lineNumber":754,"author":{"gitId":"-"},"content":"        showCommentTo: [],"},{"lineNumber":755,"author":{"gitId":"-"},"content":"        showGiverNameTo: [],"},{"lineNumber":756,"author":{"gitId":"-"},"content":"      }, recipientSubmissionFormModel.responseId, this.intent, {"},{"lineNumber":757,"author":{"gitId":"-"},"content":"        key: this.regKey,"},{"lineNumber":758,"author":{"gitId":"-"},"content":"        moderatedperson: this.moderatedPerson,"},{"lineNumber":759,"author":{"gitId":"-"},"content":"      }).pipe("},{"lineNumber":760,"author":{"gitId":"-"},"content":"          tap((comment: FeedbackResponseComment) \u003d\u003e {"},{"lineNumber":761,"author":{"gitId":"-"},"content":"            recipientSubmissionFormModel.commentByGiver \u003d this.getCommentModel(comment);"},{"lineNumber":762,"author":{"gitId":"-"},"content":"          }),"},{"lineNumber":763,"author":{"gitId":"-"},"content":"      );"},{"lineNumber":764,"author":{"gitId":"-"},"content":"    }"},{"lineNumber":765,"author":{"gitId":"-"},"content":""},{"lineNumber":766,"author":{"gitId":"-"},"content":"    // existing comment"},{"lineNumber":767,"author":{"gitId":"-"},"content":""},{"lineNumber":768,"author":{"gitId":"-"},"content":"    if (recipientSubmissionFormModel.commentByGiver.commentEditFormModel.commentText \u003d\u003d\u003d \u0027\u0027) {"},{"lineNumber":769,"author":{"gitId":"-"},"content":"      // comment is empty, create delete request"},{"lineNumber":770,"author":{"gitId":"-"},"content":"      return this.commentService.deleteComment("},{"lineNumber":771,"author":{"gitId":"-"},"content":"          recipientSubmissionFormModel.commentByGiver.originalComment.feedbackResponseCommentId, this.intent, {"},{"lineNumber":772,"author":{"gitId":"-"},"content":"            key: this.regKey,"},{"lineNumber":773,"author":{"gitId":"-"},"content":"            moderatedperson: this.moderatedPerson,"},{"lineNumber":774,"author":{"gitId":"-"},"content":"          })"},{"lineNumber":775,"author":{"gitId":"-"},"content":"          .pipe("},{"lineNumber":776,"author":{"gitId":"-"},"content":"              tap(() \u003d\u003e {"},{"lineNumber":777,"author":{"gitId":"-"},"content":"                recipientSubmissionFormModel.commentByGiver \u003d undefined;"},{"lineNumber":778,"author":{"gitId":"-"},"content":"              }));"},{"lineNumber":779,"author":{"gitId":"-"},"content":"    }"},{"lineNumber":780,"author":{"gitId":"-"},"content":""},{"lineNumber":781,"author":{"gitId":"-"},"content":"    // update comment"},{"lineNumber":782,"author":{"gitId":"-"},"content":"    return this.commentService.updateComment({"},{"lineNumber":783,"author":{"gitId":"-"},"content":"      commentText: recipientSubmissionFormModel.commentByGiver.commentEditFormModel.commentText,"},{"lineNumber":784,"author":{"gitId":"-"},"content":"      // we ignore the fields in comment edit model as participant comment"},{"lineNumber":785,"author":{"gitId":"-"},"content":"      // will follow visibilities from question by design"},{"lineNumber":786,"author":{"gitId":"-"},"content":"      showCommentTo: [],"},{"lineNumber":787,"author":{"gitId":"-"},"content":"      showGiverNameTo: [],"},{"lineNumber":788,"author":{"gitId":"-"},"content":"    }, recipientSubmissionFormModel.commentByGiver.originalComment.feedbackResponseCommentId, this.intent, {"},{"lineNumber":789,"author":{"gitId":"-"},"content":"      key: this.regKey,"},{"lineNumber":790,"author":{"gitId":"-"},"content":"      moderatedperson: this.moderatedPerson,"},{"lineNumber":791,"author":{"gitId":"-"},"content":"    }).pipe("},{"lineNumber":792,"author":{"gitId":"-"},"content":"        tap((comment: FeedbackResponseComment) \u003d\u003e {"},{"lineNumber":793,"author":{"gitId":"-"},"content":"          recipientSubmissionFormModel.commentByGiver \u003d this.getCommentModel(comment);"},{"lineNumber":794,"author":{"gitId":"-"},"content":"        }),"},{"lineNumber":795,"author":{"gitId":"-"},"content":"    );"},{"lineNumber":796,"author":{"gitId":"-"},"content":"  }"},{"lineNumber":797,"author":{"gitId":"-"},"content":""},{"lineNumber":798,"author":{"gitId":"-"},"content":"  /**"},{"lineNumber":799,"author":{"gitId":"-"},"content":"   * Deletes a comment by participants."},{"lineNumber":800,"author":{"gitId":"-"},"content":"   */"},{"lineNumber":801,"author":{"gitId":"-"},"content":"  deleteParticipantComment(questionIndex: number, responseIdx: number): void {"},{"lineNumber":802,"author":{"gitId":"-"},"content":"    const recipientSubmissionFormModel: FeedbackResponseRecipientSubmissionFormModel \u003d"},{"lineNumber":803,"author":{"gitId":"-"},"content":"        this.questionSubmissionForms[questionIndex].recipientSubmissionForms[responseIdx];"},{"lineNumber":804,"author":{"gitId":"-"},"content":""},{"lineNumber":805,"author":{"gitId":"-"},"content":"    if (!recipientSubmissionFormModel.commentByGiver || !recipientSubmissionFormModel.commentByGiver.originalComment) {"},{"lineNumber":806,"author":{"gitId":"-"},"content":"      return;"},{"lineNumber":807,"author":{"gitId":"-"},"content":"    }"},{"lineNumber":808,"author":{"gitId":"-"},"content":""},{"lineNumber":809,"author":{"gitId":"-"},"content":"    this.commentService.deleteComment("},{"lineNumber":810,"author":{"gitId":"-"},"content":"        recipientSubmissionFormModel.commentByGiver.originalComment.feedbackResponseCommentId, this.intent, {"},{"lineNumber":811,"author":{"gitId":"-"},"content":"          key: this.regKey,"},{"lineNumber":812,"author":{"gitId":"-"},"content":"          moderatedperson: this.moderatedPerson,"},{"lineNumber":813,"author":{"gitId":"-"},"content":"        }).subscribe(() \u003d\u003e {"},{"lineNumber":814,"author":{"gitId":"-"},"content":"          recipientSubmissionFormModel.commentByGiver \u003d undefined;"},{"lineNumber":815,"author":{"gitId":"-"},"content":"          this.statusMessageService.showSuccessToast(\u0027Your comment has been deleted!\u0027);"},{"lineNumber":816,"author":{"gitId":"-"},"content":"        }, (resp: ErrorMessageOutput) \u003d\u003e {"},{"lineNumber":817,"author":{"gitId":"-"},"content":"          this.statusMessageService.showErrorToast(resp.error.message);"},{"lineNumber":818,"author":{"gitId":"-"},"content":"        });"},{"lineNumber":819,"author":{"gitId":"-"},"content":"  }"},{"lineNumber":820,"author":{"gitId":"-"},"content":""},{"lineNumber":821,"author":{"gitId":"-"},"content":"  retryLoadingFeedbackSessionQuestions(): void {"},{"lineNumber":822,"author":{"gitId":"-"},"content":"    this.hasFeedbackSessionQuestionsLoadingFailed \u003d false;"},{"lineNumber":823,"author":{"gitId":"-"},"content":"    if (this.retryAttempts \u003e\u003d 0) {"},{"lineNumber":824,"author":{"gitId":"-"},"content":"      this.retryAttempts -\u003d 1;"},{"lineNumber":825,"author":{"gitId":"-"},"content":"    }"},{"lineNumber":826,"author":{"gitId":"-"},"content":"    this.loadFeedbackQuestions();"},{"lineNumber":827,"author":{"gitId":"-"},"content":"  }"},{"lineNumber":828,"author":{"gitId":"-"},"content":""},{"lineNumber":829,"author":{"gitId":"-"},"content":"  handleError(resp: ErrorMessageOutput): void {"},{"lineNumber":830,"author":{"gitId":"-"},"content":"    this.hasFeedbackSessionQuestionsLoadingFailed \u003d true;"},{"lineNumber":831,"author":{"gitId":"-"},"content":"    if (this.retryAttempts \u003c 0) {"},{"lineNumber":832,"author":{"gitId":"-"},"content":"      const report: NgbModalRef \u003d this.ngbModal.open(ErrorReportComponent);"},{"lineNumber":833,"author":{"gitId":"-"},"content":"      report.componentInstance.requestId \u003d resp.error.requestId;"},{"lineNumber":834,"author":{"gitId":"-"},"content":"      report.componentInstance.errorMessage \u003d resp.error.message;"},{"lineNumber":835,"author":{"gitId":"-"},"content":"    } else {"},{"lineNumber":836,"author":{"gitId":"-"},"content":"      this.statusMessageService.showErrorToast(resp.error.message);"},{"lineNumber":837,"author":{"gitId":"-"},"content":"    }"},{"lineNumber":838,"author":{"gitId":"-"},"content":"  }"},{"lineNumber":839,"author":{"gitId":"-"},"content":"}"}],"authorContributionMap":{"zhaojj2209":2,"-":837}}]
